import{B as ln,C as Vi,n as Sr,i as Ki,a as It}from"./pinia-e02b714a.js";import{_ as cn}from"./switch-0490ac5b.js";import{_ as hn,a as dt}from"./select-f80a805c.js";import{D as un}from"./DatabaseType-6e1dece4.js";import"./scrollbar-f9346d3c.js";import"./index-f03b1c2a.js";var Xi={exports:{}};(function(V,U){(function(J,se){V.exports=se()})(self,()=>(()=>{var J={4567:function($,c,y){var g=this&&this.__decorate||function(i,h,p,v){var w,m=arguments.length,b=m<3?h:v===null?v=Object.getOwnPropertyDescriptor(h,p):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,h,p,v);else for(var E=i.length-1;E>=0;E--)(w=i[E])&&(b=(m<3?w(b):m>3?w(h,p,b):w(h,p))||b);return m>3&&b&&Object.defineProperty(h,p,b),b},f=this&&this.__param||function(i,h){return function(p,v){h(p,v,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.AccessibilityManager=void 0;const u=y(9042),d=y(6114),C=y(9924),_=y(844),o=y(5596),t=y(4725),l=y(3656);let s=class extends _.Disposable{constructor(i,h){super(),this._terminal=i,this._renderService=h,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let p=0;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);if(this._topBoundaryFocusListener=p=>this._handleBoundaryFocus(p,0),this._bottomBoundaryFocusListener=p=>this._handleBoundaryFocus(p,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new C.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(p=>this._handleResize(p.rows))),this.register(this._terminal.onRender(p=>this._refreshRows(p.start,p.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(p=>this._handleChar(p))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(p=>this._handleTab(p))),this.register(this._terminal.onKey(p=>this._handleKey(p.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new o.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,l.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,_.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(i){for(let h=0;h<i;h++)this._handleChar(" ")}_handleChar(i){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==i&&(this._charsToAnnounce+=i):this._charsToAnnounce+=i,i===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=u.tooMuchOutput)),d.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,d.isMac&&this._liveRegion.remove()}_handleKey(i){this._clearLiveRegion(),/\p{Control}/u.test(i)||this._charsToConsume.push(i)}_refreshRows(i,h){this._liveRegionDebouncer.refresh(i,h,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(i,h){const p=i.target,v=this._rowElements[h===0?1:this._rowElements.length-2];if(p.getAttribute("aria-posinset")===(h===0?"1":`${this._terminal.buffer.lines.length}`)||i.relatedTarget!==v)return;let w,m;if(h===0?(w=p,m=this._rowElements.pop(),this._rowContainer.removeChild(m)):(w=this._rowElements.shift(),m=p,this._rowContainer.removeChild(w)),w.removeEventListener("focus",this._topBoundaryFocusListener),m.removeEventListener("focus",this._bottomBoundaryFocusListener),h===0){const b=this._createAccessibilityTreeNode();this._rowElements.unshift(b),this._rowContainer.insertAdjacentElement("afterbegin",b)}else{const b=this._createAccessibilityTreeNode();this._rowElements.push(b),this._rowContainer.appendChild(b)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(h===0?-1:1),this._rowElements[h===0?1:this._rowElements.length-2].focus(),i.preventDefault(),i.stopImmediatePropagation()}_handleResize(i){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let h=this._rowContainer.children.length;h<this._terminal.rows;h++)this._rowElements[h]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[h]);for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const i=document.createElement("div");return i.setAttribute("role","listitem"),i.tabIndex=-1,this._refreshRowDimensions(i),i}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let i=0;i<this._terminal.rows;i++)this._refreshRowDimensions(this._rowElements[i])}}_refreshRowDimensions(i){i.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s=g([f(1,t.IRenderService)],s),c.AccessibilityManager=s},3614:($,c)=>{function y(d){return d.replace(/\r?\n/g,"\r")}function g(d,C){return C?"\x1B[200~"+d+"\x1B[201~":d}function f(d,C,_){d=g(d=y(d),_.decPrivateModes.bracketedPasteMode),_.triggerDataEvent(d,!0),C.value=""}function u(d,C,_){const o=_.getBoundingClientRect(),t=d.clientX-o.left-10,l=d.clientY-o.top-10;C.style.width="20px",C.style.height="20px",C.style.left=`${t}px`,C.style.top=`${l}px`,C.style.zIndex="1000",C.focus()}Object.defineProperty(c,"__esModule",{value:!0}),c.rightClickHandler=c.moveTextAreaUnderMouseCursor=c.paste=c.handlePasteEvent=c.copyHandler=c.bracketTextForPaste=c.prepareTextForTerminal=void 0,c.prepareTextForTerminal=y,c.bracketTextForPaste=g,c.copyHandler=function(d,C){d.clipboardData&&d.clipboardData.setData("text/plain",C.selectionText),d.preventDefault()},c.handlePasteEvent=function(d,C,_){d.stopPropagation(),d.clipboardData&&f(d.clipboardData.getData("text/plain"),C,_)},c.paste=f,c.moveTextAreaUnderMouseCursor=u,c.rightClickHandler=function(d,C,_,o,t){u(d,C,_),t&&o.rightClickSelect(d),C.value=o.selectionText,C.select()}},7239:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorContrastCache=void 0;const g=y(1505);c.ColorContrastCache=class{constructor(){this._color=new g.TwoKeyMap,this._css=new g.TwoKeyMap}setCss(f,u,d){this._css.set(f,u,d)}getCss(f,u){return this._css.get(f,u)}setColor(f,u,d){this._color.set(f,u,d)}getColor(f,u){return this._color.get(f,u)}clear(){this._color.clear(),this._css.clear()}}},3656:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.addDisposableDomListener=void 0,c.addDisposableDomListener=function(y,g,f,u){y.addEventListener(g,f,u);let d=!1;return{dispose:()=>{d||(d=!0,y.removeEventListener(g,f,u))}}}},6465:function($,c,y){var g=this&&this.__decorate||function(t,l,s,i){var h,p=arguments.length,v=p<3?l:i===null?i=Object.getOwnPropertyDescriptor(l,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,l,s,i);else for(var w=t.length-1;w>=0;w--)(h=t[w])&&(v=(p<3?h(v):p>3?h(l,s,v):h(l,s))||v);return p>3&&v&&Object.defineProperty(l,s,v),v},f=this&&this.__param||function(t,l){return function(s,i){l(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Linkifier2=void 0;const u=y(2585),d=y(8460),C=y(844),_=y(3656);let o=class extends C.Disposable{constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,C.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,C.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const l=this._linkProviders.indexOf(t);l!==-1&&this._linkProviders.splice(l,1)}}}attachToDom(t,l,s){this._element=t,this._mouseService=l,this._renderService=s,this.register((0,_.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,_.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const l=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!l)return;this._isMouseOut=!1;const s=t.composedPath();for(let i=0;i<s.length;i++){const h=s[i];if(h.classList.contains("xterm"))break;if(h.classList.contains("xterm-hover"))return}this._lastBufferCell&&l.x===this._lastBufferCell.x&&l.y===this._lastBufferCell.y||(this._handleHover(l),this._lastBufferCell=l)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,l){var s,i;this._activeProviderReplies&&l||((s=this._activeProviderReplies)===null||s===void 0||s.forEach(p=>{p==null||p.forEach(v=>{v.link.dispose&&v.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let h=!1;for(const[p,v]of this._linkProviders.entries())l?!((i=this._activeProviderReplies)===null||i===void 0)&&i.get(p)&&(h=this._checkLinkProviderResult(p,t,h)):v.provideLinks(t.y,w=>{var m,b;if(this._isMouseOut)return;const E=w==null?void 0:w.map(A=>({link:A}));(m=this._activeProviderReplies)===null||m===void 0||m.set(p,E),h=this._checkLinkProviderResult(p,t,h),((b=this._activeProviderReplies)===null||b===void 0?void 0:b.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,l){const s=new Set;for(let i=0;i<l.size;i++){const h=l.get(i);if(h)for(let p=0;p<h.length;p++){const v=h[p],w=v.link.range.start.y<t?0:v.link.range.start.x,m=v.link.range.end.y>t?this._bufferService.cols:v.link.range.end.x;for(let b=w;b<=m;b++){if(s.has(b)){h.splice(p--,1);break}s.add(b)}}}}_checkLinkProviderResult(t,l,s){var i;if(!this._activeProviderReplies)return s;const h=this._activeProviderReplies.get(t);let p=!1;for(let v=0;v<t;v++)this._activeProviderReplies.has(v)&&!this._activeProviderReplies.get(v)||(p=!0);if(!p&&h){const v=h.find(w=>this._linkAtPosition(w.link,l));v&&(s=!0,this._handleNewLink(v))}if(this._activeProviderReplies.size===this._linkProviders.length&&!s)for(let v=0;v<this._activeProviderReplies.size;v++){const w=(i=this._activeProviderReplies.get(v))===null||i===void 0?void 0:i.find(m=>this._linkAtPosition(m.link,l));if(w){s=!0,this._handleNewLink(w);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const l=this._positionFromMouseEvent(t,this._element,this._mouseService);l&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,l)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,l){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!l||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=l)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,C.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const l=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);l&&this._linkAtPosition(t.link,l)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var s,i;return(i=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||i===void 0?void 0:i.decorations.pointerCursor},set:s=>{var i,h;!((i=this._currentLink)===null||i===void 0)&&i.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&((h=this._element)===null||h===void 0||h.classList.toggle("xterm-cursor-pointer",s)))}},underline:{get:()=>{var s,i;return(i=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||i===void 0?void 0:i.decorations.underline},set:s=>{var i,h,p;!((i=this._currentLink)===null||i===void 0)&&i.state&&((p=(h=this._currentLink)===null||h===void 0?void 0:h.state)===null||p===void 0?void 0:p.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,s))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const i=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,h=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=h&&(this._clearCurrentLink(i,h),this._lastMouseEvent&&this._element)){const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._askForLink(p,!1)}})))}_linkHover(t,l,s){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(l,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),l.hover&&l.hover(s,l.text)}_fireUnderlineEvent(t,l){const s=t.range,i=this._bufferService.buffer.ydisp,h=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-i-1,s.end.x,s.end.y-i-1,void 0);(l?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(h)}_linkLeave(t,l,s){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(l,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),l.leave&&l.leave(s,l.text)}_linkAtPosition(t,l){const s=t.range.start.y*this._bufferService.cols+t.range.start.x,i=t.range.end.y*this._bufferService.cols+t.range.end.x,h=l.y*this._bufferService.cols+l.x;return s<=h&&h<=i}_positionFromMouseEvent(t,l,s){const i=s.getCoords(t,l,this._bufferService.cols,this._bufferService.rows);if(i)return{x:i[0],y:i[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,l,s,i,h){return{x1:t,y1:l,x2:s,y2:i,cols:this._bufferService.cols,fg:h}}};o=g([f(0,u.IBufferService)],o),c.Linkifier2=o},9042:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tooMuchOutput=c.promptLabel=void 0,c.promptLabel="Terminal input",c.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function($,c,y){var g=this&&this.__decorate||function(o,t,l,s){var i,h=arguments.length,p=h<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,l):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,t,l,s);else for(var v=o.length-1;v>=0;v--)(i=o[v])&&(p=(h<3?i(p):h>3?i(t,l,p):i(t,l))||p);return h>3&&p&&Object.defineProperty(t,l,p),p},f=this&&this.__param||function(o,t){return function(l,s){t(l,s,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkProvider=void 0;const u=y(511),d=y(2585);let C=class{constructor(o,t,l){this._bufferService=o,this._optionsService=t,this._oscLinkService=l}provideLinks(o,t){var l;const s=this._bufferService.buffer.lines.get(o-1);if(!s)return void t(void 0);const i=[],h=this._optionsService.rawOptions.linkHandler,p=new u.CellData,v=s.getTrimmedLength();let w=-1,m=-1,b=!1;for(let E=0;E<v;E++)if(m!==-1||s.hasContent(E)){if(s.loadCell(E,p),p.hasExtendedAttrs()&&p.extended.urlId){if(m===-1){m=E,w=p.extended.urlId;continue}b=p.extended.urlId!==w}else m!==-1&&(b=!0);if(b||m!==-1&&E===v-1){const A=(l=this._oscLinkService.getLinkData(w))===null||l===void 0?void 0:l.uri;if(A){const T={start:{x:m+1,y:o},end:{x:E+(b||E!==v-1?0:1),y:o}};let B=!1;if(!(h!=null&&h.allowNonHttpProtocols))try{const F=new URL(A);["http:","https:"].includes(F.protocol)||(B=!0)}catch{B=!0}B||i.push({text:A,range:T,activate:(F,D)=>h?h.activate(F,D,T):_(0,D),hover:(F,D)=>{var H;return(H=h==null?void 0:h.hover)===null||H===void 0?void 0:H.call(h,F,D,T)},leave:(F,D)=>{var H;return(H=h==null?void 0:h.leave)===null||H===void 0?void 0:H.call(h,F,D,T)}})}b=!1,p.hasExtendedAttrs()&&p.extended.urlId?(m=E,w=p.extended.urlId):(m=-1,w=-1)}}t(i)}};function _(o,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const l=window.open();if(l){try{l.opener=null}catch{}l.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}C=g([f(0,d.IBufferService),f(1,d.IOptionsService),f(2,d.IOscLinkService)],C),c.OscLinkProvider=C},6193:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.RenderDebouncer=void 0,c.RenderDebouncer=class{constructor(y,g){this._parentWindow=y,this._renderCallback=g,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(y){return this._refreshCallbacks.push(y),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(y,g,f){this._rowCount=f,y=y!==void 0?y:0,g=g!==void 0?g:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,y):y,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,g):g,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const y=Math.max(this._rowStart,0),g=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(y,g),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const y of this._refreshCallbacks)y(0);this._refreshCallbacks=[]}}},5596:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ScreenDprMonitor=void 0;const g=y(844);class f extends g.Disposable{constructor(d){super(),this._parentWindow=d,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,g.toDisposable)(()=>{this.clearListener()}))}setListener(d){this._listener&&this.clearListener(),this._listener=d,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var d;this._outerListener&&((d=this._resolutionMediaMatchList)===null||d===void 0||d.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}c.ScreenDprMonitor=f},3236:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Terminal=void 0;const g=y(2950),f=y(1680),u=y(3614),d=y(2584),C=y(5435),_=y(9312),o=y(6114),t=y(3656),l=y(9042),s=y(4567),i=y(1296),h=y(7399),p=y(8460),v=y(8437),w=y(3230),m=y(4725),b=y(428),E=y(8934),A=y(6465),T=y(5114),B=y(8969),F=y(8055),D=y(4269),H=y(5941),L=y(3107),I=y(5744),O=y(9074),P=y(2585),Q=y(3730),z=y(844),X=y(6731),K=typeof window<"u"?window.document:null;class ie extends B.CoreTerminal{constructor(j={}){super(j),this.browser=o,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new p.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new p.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new p.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new p.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new p.EventEmitter),this._onBlur=this.register(new p.EventEmitter),this._onA11yCharEmitter=this.register(new p.EventEmitter),this._onA11yTabEmitter=this.register(new p.EventEmitter),this._onWillOpen=this.register(new p.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(A.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(Q.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((W,te)=>this.refresh(W,te))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(W=>this._reportWindowsOptions(W))),this.register(this._inputHandler.onColor(W=>this._handleColorEvent(W))),this.register((0,p.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,p.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,p.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,p.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(W=>this._afterResize(W.cols,W.rows))),this.register((0,z.toDisposable)(()=>{var W,te;this._customKeyEventHandler=void 0,(te=(W=this.element)===null||W===void 0?void 0:W.parentNode)===null||te===void 0||te.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(j){if(this._themeService)for(const W of j){let te,ne="";switch(W.index){case 256:te="foreground",ne="10";break;case 257:te="background",ne="11";break;case 258:te="cursor",ne="12";break;default:te="ansi",ne="4;"+W.index}switch(W.type){case 0:const be=F.color.toColorRGB(te==="ansi"?this._themeService.colors.ansi[W.index]:this._themeService.colors[te]);this.coreService.triggerDataEvent(`${d.C0.ESC}]${ne};${(0,H.toRgbString)(be)}${d.C1_ESCAPED.ST}`);break;case 1:if(te==="ansi")this._themeService.modifyColors(he=>he.ansi[W.index]=F.rgba.toColor(...W.color));else{const he=te;this._themeService.modifyColors(ke=>ke[he]=F.rgba.toColor(...W.color))}break;case 2:this._themeService.restoreColor(W.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(j){var W;j?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)):((W=this._accessibilityManager)===null||W===void 0||W.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(j){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(d.C0.ESC+"[I"),this.updateCursorStyle(j),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var j;return(j=this.textarea)===null||j===void 0?void 0:j.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(d.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const j=this.buffer.ybase+this.buffer.y,W=this.buffer.lines.get(j);if(!W)return;const te=Math.min(this.buffer.x,this.cols-1),ne=this._renderService.dimensions.css.cell.height,be=W.getWidth(te),he=this._renderService.dimensions.css.cell.width*be,ke=this.buffer.y*this._renderService.dimensions.css.cell.height,ee=te*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ee+"px",this.textarea.style.top=ke+"px",this.textarea.style.width=he+"px",this.textarea.style.height=ne+"px",this.textarea.style.lineHeight=ne+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,t.addDisposableDomListener)(this.element,"copy",W=>{this.hasSelection()&&(0,u.copyHandler)(W,this._selectionService)}));const j=W=>(0,u.handlePasteEvent)(W,this.textarea,this.coreService);this.register((0,t.addDisposableDomListener)(this.textarea,"paste",j)),this.register((0,t.addDisposableDomListener)(this.element,"paste",j)),o.isFirefox?this.register((0,t.addDisposableDomListener)(this.element,"mousedown",W=>{W.button===2&&(0,u.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,t.addDisposableDomListener)(this.element,"contextmenu",W=>{(0,u.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),o.isLinux&&this.register((0,t.addDisposableDomListener)(this.element,"auxclick",W=>{W.button===1&&(0,u.moveTextAreaUnderMouseCursor)(W,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,t.addDisposableDomListener)(this.textarea,"keyup",j=>this._keyUp(j),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"keydown",j=>this._keyDown(j),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"keypress",j=>this._keyPress(j),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionupdate",j=>this._compositionHelper.compositionupdate(j))),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,t.addDisposableDomListener)(this.textarea,"input",j=>this._inputEvent(j),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(j){var W;if(!j)throw new Error("Terminal requires a parent element.");j.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=j.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),j.appendChild(this.element);const te=K.createDocumentFragment();this._viewportElement=K.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),te.appendChild(this._viewportElement),this._viewportScrollArea=K.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=K.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=K.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),te.appendChild(this.screenElement),this.textarea=K.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",l.promptLabel),o.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(T.CoreBrowserService,this.textarea,(W=this._document.defaultView)!==null&&W!==void 0?W:window),this._instantiationService.setService(m.ICoreBrowserService,this._coreBrowserService),this.register((0,t.addDisposableDomListener)(this.textarea,"focus",ne=>this._handleTextAreaFocus(ne))),this.register((0,t.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(b.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(m.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(X.ThemeService),this._instantiationService.setService(m.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(D.CharacterJoinerService),this._instantiationService.setService(m.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(w.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(m.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(ne=>this._onRender.fire(ne))),this.onResize(ne=>this._renderService.resize(ne.cols,ne.rows)),this._compositionView=K.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(g.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(te);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(m.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(f.Viewport,ne=>this.scrollLines(ne,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(_.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(m.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(ne=>this.scrollLines(ne.amount,ne.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(ne=>this._renderService.handleSelectionChanged(ne.start,ne.end,ne.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(ne=>{this.textarea.value=ne,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(ne=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,t.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(L.BufferDecorationRenderer,this.screenElement)),this.register((0,t.addDisposableDomListener)(this.element,"mousedown",ne=>this._selectionService.handleMouseDown(ne))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",ne=>this._handleScreenReaderModeOptionChange(ne))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(I.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",ne=>{!this._overviewRulerRenderer&&ne&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(I.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const j=this,W=this.element;function te(he){const ke=j._mouseService.getMouseReportCoords(he,j.screenElement);if(!ke)return!1;let ee,Ee;switch(he.overrideType||he.type){case"mousemove":Ee=32,he.buttons===void 0?(ee=3,he.button!==void 0&&(ee=he.button<3?he.button:3)):ee=1&he.buttons?0:4&he.buttons?1:2&he.buttons?2:3;break;case"mouseup":Ee=0,ee=he.button<3?he.button:3;break;case"mousedown":Ee=1,ee=he.button<3?he.button:3;break;case"wheel":if(j.viewport.getLinesScrolled(he)===0)return!1;Ee=he.deltaY<0?0:1,ee=4;break;default:return!1}return!(Ee===void 0||ee===void 0||ee>4)&&j.coreMouseService.triggerMouseEvent({col:ke.col,row:ke.row,x:ke.x,y:ke.y,button:ee,action:Ee,ctrl:he.ctrlKey,alt:he.altKey,shift:he.shiftKey})}const ne={mouseup:null,wheel:null,mousedrag:null,mousemove:null},be={mouseup:he=>(te(he),he.buttons||(this._document.removeEventListener("mouseup",ne.mouseup),ne.mousedrag&&this._document.removeEventListener("mousemove",ne.mousedrag)),this.cancel(he)),wheel:he=>(te(he),this.cancel(he,!0)),mousedrag:he=>{he.buttons&&te(he)},mousemove:he=>{he.buttons||te(he)}};this.register(this.coreMouseService.onProtocolChange(he=>{he?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(he)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&he?ne.mousemove||(W.addEventListener("mousemove",be.mousemove),ne.mousemove=be.mousemove):(W.removeEventListener("mousemove",ne.mousemove),ne.mousemove=null),16&he?ne.wheel||(W.addEventListener("wheel",be.wheel,{passive:!1}),ne.wheel=be.wheel):(W.removeEventListener("wheel",ne.wheel),ne.wheel=null),2&he?ne.mouseup||(ne.mouseup=be.mouseup):(this._document.removeEventListener("mouseup",ne.mouseup),ne.mouseup=null),4&he?ne.mousedrag||(ne.mousedrag=be.mousedrag):(this._document.removeEventListener("mousemove",ne.mousedrag),ne.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,t.addDisposableDomListener)(W,"mousedown",he=>{if(he.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(he))return te(he),ne.mouseup&&this._document.addEventListener("mouseup",ne.mouseup),ne.mousedrag&&this._document.addEventListener("mousemove",ne.mousedrag),this.cancel(he)})),this.register((0,t.addDisposableDomListener)(W,"wheel",he=>{if(!ne.wheel){if(!this.buffer.hasScrollback){const ke=this.viewport.getLinesScrolled(he);if(ke===0)return;const ee=d.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(he.deltaY<0?"A":"B");let Ee="";for(let fe=0;fe<Math.abs(ke);fe++)Ee+=ee;return this.coreService.triggerDataEvent(Ee,!0),this.cancel(he,!0)}return this.viewport.handleWheel(he)?this.cancel(he):void 0}},{passive:!1})),this.register((0,t.addDisposableDomListener)(W,"touchstart",he=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(he),this.cancel(he)},{passive:!0})),this.register((0,t.addDisposableDomListener)(W,"touchmove",he=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(he)?void 0:this.cancel(he)},{passive:!1}))}refresh(j,W){var te;(te=this._renderService)===null||te===void 0||te.refreshRows(j,W)}updateCursorStyle(j){var W;!((W=this._selectionService)===null||W===void 0)&&W.shouldColumnSelect(j)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(j,W,te=0){super.scrollLines(j,W,te),this.refresh(0,this.rows-1)}paste(j){(0,u.paste)(j,this.textarea,this.coreService)}attachCustomKeyEventHandler(j){this._customKeyEventHandler=j}registerLinkProvider(j){return this.linkifier2.registerLinkProvider(j)}registerCharacterJoiner(j){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const W=this._characterJoinerService.register(j);return this.refresh(0,this.rows-1),W}deregisterCharacterJoiner(j){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(j)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(j){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+j)}registerDecoration(j){return this._decorationService.registerDecoration(j)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(j,W,te){this._selectionService.setSelection(j,W,te)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var j;(j=this._selectionService)===null||j===void 0||j.clearSelection()}selectAll(){var j;(j=this._selectionService)===null||j===void 0||j.selectAll()}selectLines(j,W){var te;(te=this._selectionService)===null||te===void 0||te.selectLines(j,W)}_keyDown(j){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(j)===!1)return!1;const W=this.browser.isMac&&this.options.macOptionIsMeta&&j.altKey;if(!W&&!this._compositionHelper.keydown(j))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;W||j.key!=="Dead"&&j.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const te=(0,h.evaluateKeyboardEvent)(j,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(j),te.type===3||te.type===2){const ne=this.rows-1;return this.scrollLines(te.type===2?-ne:ne),this.cancel(j,!0)}return te.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,j)||(te.cancel&&this.cancel(j,!0),!te.key||!!(j.key&&!j.ctrlKey&&!j.altKey&&!j.metaKey&&j.key.length===1&&j.key.charCodeAt(0)>=65&&j.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(te.key!==d.C0.ETX&&te.key!==d.C0.CR||(this.textarea.value=""),this._onKey.fire({key:te.key,domEvent:j}),this._showCursor(),this.coreService.triggerDataEvent(te.key,!0),!this.optionsService.rawOptions.screenReaderMode||j.altKey||j.ctrlKey?this.cancel(j,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(j,W){const te=j.isMac&&!this.options.macOptionIsMeta&&W.altKey&&!W.ctrlKey&&!W.metaKey||j.isWindows&&W.altKey&&W.ctrlKey&&!W.metaKey||j.isWindows&&W.getModifierState("AltGraph");return W.type==="keypress"?te:te&&(!W.keyCode||W.keyCode>47)}_keyUp(j){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(j)===!1||(function(W){return W.keyCode===16||W.keyCode===17||W.keyCode===18}(j)||this.focus(),this.updateCursorStyle(j),this._keyPressHandled=!1)}_keyPress(j){let W;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(j)===!1)return!1;if(this.cancel(j),j.charCode)W=j.charCode;else if(j.which===null||j.which===void 0)W=j.keyCode;else{if(j.which===0||j.charCode===0)return!1;W=j.which}return!(!W||(j.altKey||j.ctrlKey||j.metaKey)&&!this._isThirdLevelShift(this.browser,j)||(W=String.fromCharCode(W),this._onKey.fire({key:W,domEvent:j}),this._showCursor(),this.coreService.triggerDataEvent(W,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(j){if(j.data&&j.inputType==="insertText"&&(!j.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const W=j.data;return this.coreService.triggerDataEvent(W,!0),this.cancel(j),!0}return!1}resize(j,W){j!==this.cols||W!==this.rows?super.resize(j,W):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(j,W){var te,ne;(te=this._charSizeService)===null||te===void 0||te.measure(),(ne=this.viewport)===null||ne===void 0||ne.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let j=1;j<this.rows;j++)this.buffer.lines.push(this.buffer.getBlankLine(v.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var j,W;this.options.rows=this.rows,this.options.cols=this.cols;const te=this._customKeyEventHandler;this._setup(),super.reset(),(j=this._selectionService)===null||j===void 0||j.reset(),this._decorationService.reset(),this._customKeyEventHandler=te,this.refresh(0,this.rows-1),(W=this.viewport)===null||W===void 0||W.syncScrollArea()}clearTextureAtlas(){var j;(j=this._renderService)===null||j===void 0||j.clearTextureAtlas()}_reportFocus(){var j;!((j=this.element)===null||j===void 0)&&j.classList.contains("focus")?this.coreService.triggerDataEvent(d.C0.ESC+"[I"):this.coreService.triggerDataEvent(d.C0.ESC+"[O")}_reportWindowsOptions(j){if(this._renderService)switch(j){case C.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const W=this._renderService.dimensions.css.canvas.width.toFixed(0),te=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${d.C0.ESC}[4;${te};${W}t`);break;case C.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ne=this._renderService.dimensions.css.cell.width.toFixed(0),be=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${d.C0.ESC}[6;${be};${ne}t`)}}cancel(j,W){if(this.options.cancelEvents||W)return j.preventDefault(),j.stopPropagation(),!1}}c.Terminal=ie},9924:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TimeBasedDebouncer=void 0,c.TimeBasedDebouncer=class{constructor(y,g=1e3){this._renderCallback=y,this._debounceThresholdMS=g,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(y,g,f){this._rowCount=f,y=y!==void 0?y:0,g=g!==void 0?g:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,y):y,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,g):g;const u=Date.now();if(u-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=u,this._innerRefresh();else if(!this._additionalRefreshRequested){const d=u-this._lastRefreshMs,C=this._debounceThresholdMS-d;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},C)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const y=Math.max(this._rowStart,0),g=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(y,g)}}},1680:function($,c,y){var g=this&&this.__decorate||function(t,l,s,i){var h,p=arguments.length,v=p<3?l:i===null?i=Object.getOwnPropertyDescriptor(l,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,l,s,i);else for(var w=t.length-1;w>=0;w--)(h=t[w])&&(v=(p<3?h(v):p>3?h(l,s,v):h(l,s))||v);return p>3&&v&&Object.defineProperty(l,s,v),v},f=this&&this.__param||function(t,l){return function(s,i){l(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Viewport=void 0;const u=y(844),d=y(3656),C=y(4725),_=y(2585);let o=class extends u.Disposable{constructor(t,l,s,i,h,p,v,w,m){super(),this._scrollLines=t,this._viewportElement=l,this._scrollArea=s,this._bufferService=i,this._optionsService=h,this._charSizeService=p,this._renderService=v,this._coreBrowserService=w,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,d.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(b=>this._activeBuffer=b.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(b=>this._renderDimensions=b)),this._handleThemeChange(m.colors),this.register(m.onChangeColors(b=>this._handleThemeChange(b))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(t){this._viewportElement.style.backgroundColor=t.background.css}_refresh(t){if(t)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const l=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==l&&(this._lastRecordedBufferHeight=l,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null}syncScrollArea(t=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(t);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(t)}_handleScroll(t){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const l=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(l)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const t=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(t*(this._smoothScrollState.target-this._smoothScrollState.origin)),t<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(t,l){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(l<0&&this._viewportElement.scrollTop!==0||l>0&&s<this._lastRecordedBufferHeight)||(t.cancelable&&t.preventDefault(),!1)}handleWheel(t){const l=this._getPixelsScrolled(t);return l!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+l:this._smoothScrollState.target+=l,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=l,this._bubbleScroll(t,l))}_getPixelsScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let l=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_LINE?l*=this._currentRowHeight:t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._currentRowHeight*this._bufferService.rows),l}getBufferElements(t,l){var s;let i,h="";const p=[],v=l??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let m=t;m<v;m++){const b=w.get(m);if(!b)continue;const E=(s=w.get(m+1))===null||s===void 0?void 0:s.isWrapped;if(h+=b.translateToString(!E),!E||m===w.length-1){const A=document.createElement("div");A.textContent=h,p.push(A),h.length>0&&(i=A),h=""}}return{bufferElements:p,cursorElement:i}}getLinesScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let l=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(l/=this._currentRowHeight+0,this._wheelPartialScroll+=l,l=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._bufferService.rows),l}_applyScrollModifier(t,l){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&l.altKey||s==="ctrl"&&l.ctrlKey||s==="shift"&&l.shiftKey?t*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:t*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(t){this._lastTouchY=t.touches[0].pageY}handleTouchMove(t){const l=this._lastTouchY-t.touches[0].pageY;return this._lastTouchY=t.touches[0].pageY,l!==0&&(this._viewportElement.scrollTop+=l,this._bubbleScroll(t,l))}};o=g([f(3,_.IBufferService),f(4,_.IOptionsService),f(5,C.ICharSizeService),f(6,C.IRenderService),f(7,C.ICoreBrowserService),f(8,C.IThemeService)],o),c.Viewport=o},3107:function($,c,y){var g=this&&this.__decorate||function(t,l,s,i){var h,p=arguments.length,v=p<3?l:i===null?i=Object.getOwnPropertyDescriptor(l,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,l,s,i);else for(var w=t.length-1;w>=0;w--)(h=t[w])&&(v=(p<3?h(v):p>3?h(l,s,v):h(l,s))||v);return p>3&&v&&Object.defineProperty(l,s,v),v},f=this&&this.__param||function(t,l){return function(s,i){l(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferDecorationRenderer=void 0;const u=y(3656),d=y(4725),C=y(844),_=y(2585);let o=class extends C.Disposable{constructor(t,l,s,i){super(),this._screenElement=t,this._bufferService=l,this._decorationService=s,this._renderService=i,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,u.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(h=>this._removeDecoration(h))),this.register((0,C.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var l,s;const i=document.createElement("div");i.classList.add("xterm-decoration"),i.classList.toggle("xterm-decoration-top-layer",((l=t==null?void 0:t.options)===null||l===void 0?void 0:l.layer)==="top"),i.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",i.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const h=(s=t.options.x)!==null&&s!==void 0?s:0;return h&&h>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(t,i),i}_refreshStyle(t){const l=t.marker.line-this._bufferService.buffers.active.ydisp;if(l<0||l>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let s=this._decorationElements.get(t);s||(s=this._createElement(t),t.element=s,this._decorationElements.set(t,s),this._container.appendChild(s)),s.style.top=l*this._renderService.dimensions.css.cell.height+"px",s.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(s)}}_refreshXPosition(t,l=t.element){var s;if(!l)return;const i=(s=t.options.x)!==null&&s!==void 0?s:0;(t.options.anchor||"left")==="right"?l.style.right=i?i*this._renderService.dimensions.css.cell.width+"px":"":l.style.left=i?i*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var l;(l=this._decorationElements.get(t))===null||l===void 0||l.remove(),this._decorationElements.delete(t),t.dispose()}};o=g([f(1,_.IBufferService),f(2,_.IDecorationService),f(3,d.IRenderService)],o),c.BufferDecorationRenderer=o},5871:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorZoneStore=void 0,c.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(y){if(y.options.overviewRulerOptions){for(const g of this._zones)if(g.color===y.options.overviewRulerOptions.color&&g.position===y.options.overviewRulerOptions.position){if(this._lineIntersectsZone(g,y.marker.line))return;if(this._lineAdjacentToZone(g,y.marker.line,y.options.overviewRulerOptions.position))return void this._addLineToZone(g,y.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=y.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=y.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=y.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=y.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:y.options.overviewRulerOptions.color,position:y.options.overviewRulerOptions.position,startBufferLine:y.marker.line,endBufferLine:y.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(y){this._linePadding=y}_lineIntersectsZone(y,g){return g>=y.startBufferLine&&g<=y.endBufferLine}_lineAdjacentToZone(y,g,f){return g>=y.startBufferLine-this._linePadding[f||"full"]&&g<=y.endBufferLine+this._linePadding[f||"full"]}_addLineToZone(y,g){y.startBufferLine=Math.min(y.startBufferLine,g),y.endBufferLine=Math.max(y.endBufferLine,g)}}},5744:function($,c,y){var g=this&&this.__decorate||function(h,p,v,w){var m,b=arguments.length,E=b<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,v):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(h,p,v,w);else for(var A=h.length-1;A>=0;A--)(m=h[A])&&(E=(b<3?m(E):b>3?m(p,v,E):m(p,v))||E);return b>3&&E&&Object.defineProperty(p,v,E),E},f=this&&this.__param||function(h,p){return function(v,w){p(v,w,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OverviewRulerRenderer=void 0;const u=y(5871),d=y(3656),C=y(4725),_=y(844),o=y(2585),t={full:0,left:0,center:0,right:0},l={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0};let i=class extends _.Disposable{constructor(h,p,v,w,m,b,E){var A;super(),this._viewportElement=h,this._screenElement=p,this._bufferService=v,this._decorationService=w,this._renderService=m,this._optionsService=b,this._coreBrowseService=E,this._colorZoneStore=new u.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(A=this._viewportElement.parentElement)===null||A===void 0||A.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,_.toDisposable)(()=>{var B;(B=this._canvas)===null||B===void 0||B.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,d.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const h=Math.floor(this._canvas.width/3),p=Math.ceil(this._canvas.width/3);l.full=this._canvas.width,l.left=h,l.center=p,l.right=h,this._refreshDrawHeightConstants(),s.full=0,s.left=0,s.center=l.left,s.right=l.left+l.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const h=this._canvas.height/this._bufferService.buffer.lines.length,p=Math.round(Math.max(Math.min(h,12),6)*this._coreBrowseService.dpr);t.left=p,t.center=p,t.right=p}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const p of this._decorationService.decorations)this._colorZoneStore.addDecoration(p);this._ctx.lineWidth=1;const h=this._colorZoneStore.zones;for(const p of h)p.position!=="full"&&this._renderColorZone(p);for(const p of h)p.position==="full"&&this._renderColorZone(p);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(h){this._ctx.fillStyle=h.color,this._ctx.fillRect(s[h.position||"full"],Math.round((this._canvas.height-1)*(h.startBufferLine/this._bufferService.buffers.active.lines.length)-t[h.position||"full"]/2),l[h.position||"full"],Math.round((this._canvas.height-1)*((h.endBufferLine-h.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[h.position||"full"]))}_queueRefresh(h,p){this._shouldUpdateDimensions=h||this._shouldUpdateDimensions,this._shouldUpdateAnchor=p||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};i=g([f(2,o.IBufferService),f(3,o.IDecorationService),f(4,C.IRenderService),f(5,o.IOptionsService),f(6,C.ICoreBrowserService)],i),c.OverviewRulerRenderer=i},2950:function($,c,y){var g=this&&this.__decorate||function(o,t,l,s){var i,h=arguments.length,p=h<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,l):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,t,l,s);else for(var v=o.length-1;v>=0;v--)(i=o[v])&&(p=(h<3?i(p):h>3?i(t,l,p):i(t,l))||p);return h>3&&p&&Object.defineProperty(t,l,p),p},f=this&&this.__param||function(o,t){return function(l,s){t(l,s,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CompositionHelper=void 0;const u=y(4725),d=y(2585),C=y(2584);let _=class{constructor(o,t,l,s,i,h){this._textarea=o,this._compositionView=t,this._bufferService=l,this._optionsService=s,this._coreService=i,this._renderService=h,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(o){this._compositionView.textContent=o.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(o){if(this._isComposing||this._isSendingComposition){if(o.keyCode===229||o.keyCode===16||o.keyCode===17||o.keyCode===18)return!1;this._finalizeComposition(!1)}return o.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(o){if(this._compositionView.classList.remove("active"),this._isComposing=!1,o){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let l;if(this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,this._isComposing)l=this._textarea.value.substring(t.start,t.end);else{const s=this._textarea.value.length-t.start;l=this._textarea.value.substring(0,s)}l.length>0&&this._coreService.triggerDataEvent(l,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const o=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,l=t.replace(o,"");this._dataAlreadySent=l,t.length>o.length?this._coreService.triggerDataEvent(l,!0):t.length<o.length?this._coreService.triggerDataEvent(`${C.C0.DEL}`,!0):t.length===o.length&&t!==o&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(o){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),l=this._renderService.dimensions.css.cell.height,s=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,i=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=i+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=l+"px",this._compositionView.style.lineHeight=l+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const h=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(h.width,1)+"px",this._textarea.style.height=Math.max(h.height,1)+"px",this._textarea.style.lineHeight=h.height+"px"}o||setTimeout(()=>this.updateCompositionElements(!0),0)}}};_=g([f(2,d.IBufferService),f(3,d.IOptionsService),f(4,d.ICoreService),f(5,u.IRenderService)],_),c.CompositionHelper=_},9806:($,c)=>{function y(g,f,u){const d=u.getBoundingClientRect(),C=g.getComputedStyle(u),_=parseInt(C.getPropertyValue("padding-left")),o=parseInt(C.getPropertyValue("padding-top"));return[f.clientX-d.left-_,f.clientY-d.top-o]}Object.defineProperty(c,"__esModule",{value:!0}),c.getCoords=c.getCoordsRelativeToElement=void 0,c.getCoordsRelativeToElement=y,c.getCoords=function(g,f,u,d,C,_,o,t,l){if(!_)return;const s=y(g,f,u);return s?(s[0]=Math.ceil((s[0]+(l?o/2:0))/o),s[1]=Math.ceil(s[1]/t),s[0]=Math.min(Math.max(s[0],1),d+(l?1:0)),s[1]=Math.min(Math.max(s[1],1),C),s):void 0}},9504:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.moveToCellSequence=void 0;const g=y(2584);function f(t,l,s,i){const h=t-u(t,s),p=l-u(l,s),v=Math.abs(h-p)-function(w,m,b){let E=0;const A=w-u(w,b),T=m-u(m,b);for(let B=0;B<Math.abs(A-T);B++){const F=d(w,m)==="A"?-1:1,D=b.buffer.lines.get(A+F*B);D!=null&&D.isWrapped&&E++}return E}(t,l,s);return o(v,_(d(t,l),i))}function u(t,l){let s=0,i=l.buffer.lines.get(t),h=i==null?void 0:i.isWrapped;for(;h&&t>=0&&t<l.rows;)s++,i=l.buffer.lines.get(--t),h=i==null?void 0:i.isWrapped;return s}function d(t,l){return t>l?"A":"B"}function C(t,l,s,i,h,p){let v=t,w=l,m="";for(;v!==s||w!==i;)v+=h?1:-1,h&&v>p.cols-1?(m+=p.buffer.translateBufferLineToString(w,!1,t,v),v=0,t=0,w++):!h&&v<0&&(m+=p.buffer.translateBufferLineToString(w,!1,0,t+1),v=p.cols-1,t=v,w--);return m+p.buffer.translateBufferLineToString(w,!1,t,v)}function _(t,l){const s=l?"O":"[";return g.C0.ESC+s+t}function o(t,l){t=Math.floor(t);let s="";for(let i=0;i<t;i++)s+=l;return s}c.moveToCellSequence=function(t,l,s,i){const h=s.buffer.x,p=s.buffer.y;if(!s.buffer.hasScrollback)return function(m,b,E,A,T,B){return f(b,A,T,B).length===0?"":o(C(m,b,m,b-u(b,T),!1,T).length,_("D",B))}(h,p,0,l,s,i)+f(p,l,s,i)+function(m,b,E,A,T,B){let F;F=f(b,A,T,B).length>0?A-u(A,T):b;const D=A,H=function(L,I,O,P,Q,z){let X;return X=f(O,P,Q,z).length>0?P-u(P,Q):I,L<O&&X<=P||L>=O&&X<P?"C":"D"}(m,b,E,A,T,B);return o(C(m,F,E,D,H==="C",T).length,_(H,B))}(h,p,t,l,s,i);let v;if(p===l)return v=h>t?"D":"C",o(Math.abs(h-t),_(v,i));v=p>l?"D":"C";const w=Math.abs(p-l);return o(function(m,b){return b.cols-m}(p>l?t:h,s)+(w-1)*s.cols+1+((p>l?h:t)-1),_(v,i))}},1296:function($,c,y){var g=this&&this.__decorate||function(w,m,b,E){var A,T=arguments.length,B=T<3?m:E===null?E=Object.getOwnPropertyDescriptor(m,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(w,m,b,E);else for(var F=w.length-1;F>=0;F--)(A=w[F])&&(B=(T<3?A(B):T>3?A(m,b,B):A(m,b))||B);return T>3&&B&&Object.defineProperty(m,b,B),B},f=this&&this.__param||function(w,m){return function(b,E){m(b,E,w)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRenderer=void 0;const u=y(3787),d=y(2223),C=y(6171),_=y(4725),o=y(8055),t=y(8460),l=y(844),s=y(2585),i="xterm-dom-renderer-owner-",h="xterm-focus";let p=1,v=class extends l.Disposable{constructor(w,m,b,E,A,T,B,F,D,H){super(),this._element=w,this._screenElement=m,this._viewportElement=b,this._linkifier2=E,this._charSizeService=T,this._optionsService=B,this._bufferService=F,this._coreBrowserService=D,this._themeService=H,this._terminalClass=p++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new t.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,C.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(L=>this._injectCss(L))),this._injectCss(this._themeService.colors),this._rowFactory=A.createInstance(u.DomRendererRowFactory,document),this._element.classList.add(i+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(L=>this._handleLinkHover(L))),this.register(this._linkifier2.onHideLinkUnderline(L=>this._handleLinkLeave(L))),this.register((0,l.toDisposable)(()=>{this._element.classList.remove(i+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const w=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*w,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*w),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/w),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/w),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const b of this._rowElements)b.style.width=`${this.dimensions.css.canvas.width}px`,b.style.height=`${this.dimensions.css.cell.height}px`,b.style.lineHeight=`${this.dimensions.css.cell.height}px`,b.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const m=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=m,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(w){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let m=`${this._terminalSelector} .xterm-rows { color: ${w.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;m+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${o.color.multiplyOpacity(w.foreground,.5).css};}`,m+=`${this._terminalSelector} span:not(.${u.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${u.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${u.ITALIC_CLASS} { font-style: italic;}`,m+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",m+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${w.cursor.css};  color: ${w.cursorAccent.css}; } 50% {  background-color: ${w.cursorAccent.css};  color: ${w.cursor.css}; }}`,m+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${w.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_BLINK_CLASS}:not(.${u.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_BLINK_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${w.cursor.css}; color: ${w.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${w.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${w.cursor.css} inset;}`,m+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${w.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${w.selectionInactiveBackgroundOpaque.css};}`;for(const[b,E]of w.ansi.entries())m+=`${this._terminalSelector} .xterm-fg-${b} { color: ${E.css}; }${this._terminalSelector} .xterm-fg-${b}.${u.DIM_CLASS} { color: ${o.color.multiplyOpacity(E,.5).css}; }${this._terminalSelector} .xterm-bg-${b} { background-color: ${E.css}; }`;m+=`${this._terminalSelector} .xterm-fg-${d.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(w.background).css}; }${this._terminalSelector} .xterm-fg-${d.INVERTED_DEFAULT_COLOR}.${u.DIM_CLASS} { color: ${o.color.multiplyOpacity(o.color.opaque(w.background),.5).css}; }${this._terminalSelector} .xterm-bg-${d.INVERTED_DEFAULT_COLOR} { background-color: ${w.foreground.css}; }`,this._themeStyleElement.textContent=m}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(w,m){for(let b=this._rowElements.length;b<=m;b++){const E=document.createElement("div");this._rowContainer.appendChild(E),this._rowElements.push(E)}for(;this._rowElements.length>m;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(w,m){this._refreshRowElements(w,m),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(h)}handleFocus(){this._rowContainer.classList.add(h)}handleSelectionChanged(w,m,b){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(w,m,b),this.renderRows(0,this._bufferService.rows-1),!w||!m)return;const E=w[1]-this._bufferService.buffer.ydisp,A=m[1]-this._bufferService.buffer.ydisp,T=Math.max(E,0),B=Math.min(A,this._bufferService.rows-1);if(T>=this._bufferService.rows||B<0)return;const F=document.createDocumentFragment();if(b){const D=w[0]>m[0];F.appendChild(this._createSelectionElement(T,D?m[0]:w[0],D?w[0]:m[0],B-T+1))}else{const D=E===T?w[0]:0,H=T===A?m[0]:this._bufferService.cols;F.appendChild(this._createSelectionElement(T,D,H));const L=B-T-1;if(F.appendChild(this._createSelectionElement(T+1,0,this._bufferService.cols,L)),T!==B){const I=A===B?m[0]:this._bufferService.cols;F.appendChild(this._createSelectionElement(B,0,I))}}this._selectionContainer.appendChild(F)}_createSelectionElement(w,m,b,E=1){const A=document.createElement("div");return A.style.height=E*this.dimensions.css.cell.height+"px",A.style.top=w*this.dimensions.css.cell.height+"px",A.style.left=m*this.dimensions.css.cell.width+"px",A.style.width=this.dimensions.css.cell.width*(b-m)+"px",A}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const w of this._rowElements)w.replaceChildren()}renderRows(w,m){const b=this._bufferService.buffer.ybase+this._bufferService.buffer.y,E=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),A=this._optionsService.rawOptions.cursorBlink;for(let T=w;T<=m;T++){const B=this._rowElements[T],F=T+this._bufferService.buffer.ydisp,D=this._bufferService.buffer.lines.get(F),H=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[T]&&this._cellToRowElements[T].length===this._bufferService.cols||(this._cellToRowElements[T]=new Int16Array(this._bufferService.cols)),B.replaceChildren(this._rowFactory.createRow(D,F,F===b,H,E,A,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[T]))}}get _terminalSelector(){return`.${i}${this._terminalClass}`}_handleLinkHover(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!0)}_handleLinkLeave(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!1)}_setCellUnderline(w,m,b,E,A,T){if(w=this._cellToRowElements[b][w],m=this._cellToRowElements[E][m],w!==-1&&m!==-1)for(;w!==m||b!==E;){const B=this._rowElements[b];if(!B)return;const F=B.children[w];F&&(F.style.textDecoration=T?"underline":"none"),++w>=A&&(w=0,b++)}}};v=g([f(4,s.IInstantiationService),f(5,_.ICharSizeService),f(6,s.IOptionsService),f(7,s.IBufferService),f(8,_.ICoreBrowserService),f(9,_.IThemeService)],v),c.DomRenderer=v},3787:function($,c,y){var g=this&&this.__decorate||function(v,w,m,b){var E,A=arguments.length,T=A<3?w:b===null?b=Object.getOwnPropertyDescriptor(w,m):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(v,w,m,b);else for(var B=v.length-1;B>=0;B--)(E=v[B])&&(T=(A<3?E(T):A>3?E(w,m,T):E(w,m))||T);return A>3&&T&&Object.defineProperty(w,m,T),T},f=this&&this.__param||function(v,w){return function(m,b){w(m,b,v)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRendererRowFactory=c.CURSOR_STYLE_UNDERLINE_CLASS=c.CURSOR_STYLE_BAR_CLASS=c.CURSOR_STYLE_BLOCK_CLASS=c.CURSOR_BLINK_CLASS=c.CURSOR_CLASS=c.STRIKETHROUGH_CLASS=c.OVERLINE_CLASS=c.UNDERLINE_CLASS=c.ITALIC_CLASS=c.DIM_CLASS=c.BOLD_CLASS=void 0;const u=y(2223),d=y(643),C=y(511),_=y(2585),o=y(8055),t=y(4725),l=y(4269),s=y(6171),i=y(3734);c.BOLD_CLASS="xterm-bold",c.DIM_CLASS="xterm-dim",c.ITALIC_CLASS="xterm-italic",c.UNDERLINE_CLASS="xterm-underline",c.OVERLINE_CLASS="xterm-overline",c.STRIKETHROUGH_CLASS="xterm-strikethrough",c.CURSOR_CLASS="xterm-cursor",c.CURSOR_BLINK_CLASS="xterm-cursor-blink",c.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",c.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",c.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let h=class{constructor(v,w,m,b,E,A,T){this._document=v,this._characterJoinerService=w,this._optionsService=m,this._coreBrowserService=b,this._coreService=E,this._decorationService=A,this._themeService=T,this._workCell=new C.CellData,this._columnSelectMode=!1}handleSelectionChanged(v,w,m){this._selectionStart=v,this._selectionEnd=w,this._columnSelectMode=m}createRow(v,w,m,b,E,A,T,B,F){const D=this._document.createDocumentFragment(),H=this._characterJoinerService.getJoinedCharacters(w);let L=0;for(let Q=Math.min(v.length,B)-1;Q>=0;Q--)if(v.loadCell(Q,this._workCell).getCode()!==d.NULL_CELL_CODE||m&&Q===E){L=Q+1;break}const I=this._themeService.colors;let O=-1,P=0;for(;P<L;P++){v.loadCell(P,this._workCell);let Q=this._workCell.getWidth();if(Q===0){F[P]=O;continue}let z=!1,X=P,K=this._workCell;if(H.length>0&&P===H[0][0]){z=!0;const fe=H.shift();K=new l.JoinedCellData(this._workCell,v.translateToString(!0,fe[0],fe[1]),fe[1]-fe[0]),X=fe[1]-1,Q=K.getWidth()}const ie=this._document.createElement("span");if(Q>1&&(ie.style.width=T*Q+"px"),z&&(ie.style.display="inline",E>=P&&E<=X&&(E=P)),!this._coreService.isCursorHidden&&m&&P===E)switch(ie.classList.add(c.CURSOR_CLASS),A&&ie.classList.add(c.CURSOR_BLINK_CLASS),b){case"bar":ie.classList.add(c.CURSOR_STYLE_BAR_CLASS);break;case"underline":ie.classList.add(c.CURSOR_STYLE_UNDERLINE_CLASS);break;default:ie.classList.add(c.CURSOR_STYLE_BLOCK_CLASS)}if(K.isBold()&&ie.classList.add(c.BOLD_CLASS),K.isItalic()&&ie.classList.add(c.ITALIC_CLASS),K.isDim()&&ie.classList.add(c.DIM_CLASS),K.isInvisible()?ie.textContent=d.WHITESPACE_CELL_CHAR:ie.textContent=K.getChars()||d.WHITESPACE_CELL_CHAR,K.isUnderline()&&(ie.classList.add(`${c.UNDERLINE_CLASS}-${K.extended.underlineStyle}`),ie.textContent===" "&&(ie.textContent=""),!K.isUnderlineColorDefault()))if(K.isUnderlineColorRGB())ie.style.textDecorationColor=`rgb(${i.AttributeData.toColorRGB(K.getUnderlineColor()).join(",")})`;else{let fe=K.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&K.isBold()&&fe<8&&(fe+=8),ie.style.textDecorationColor=I.ansi[fe].css}K.isOverline()&&(ie.classList.add(c.OVERLINE_CLASS),ie.textContent===" "&&(ie.textContent="")),K.isStrikethrough()&&ie.classList.add(c.STRIKETHROUGH_CLASS);let G=K.getFgColor(),j=K.getFgColorMode(),W=K.getBgColor(),te=K.getBgColorMode();const ne=!!K.isInverse();if(ne){const fe=G;G=W,W=fe;const st=j;j=te,te=st}let be,he,ke=!1;this._decorationService.forEachDecorationAtCell(P,w,void 0,fe=>{fe.options.layer!=="top"&&ke||(fe.backgroundColorRGB&&(te=50331648,W=fe.backgroundColorRGB.rgba>>8&16777215,be=fe.backgroundColorRGB),fe.foregroundColorRGB&&(j=50331648,G=fe.foregroundColorRGB.rgba>>8&16777215,he=fe.foregroundColorRGB),ke=fe.options.layer==="top")});const ee=this._isCellInSelection(P,w);let Ee;switch(ke||I.selectionForeground&&ee&&(j=50331648,G=I.selectionForeground.rgba>>8&16777215,he=I.selectionForeground),ee&&(be=this._coreBrowserService.isFocused?I.selectionBackgroundOpaque:I.selectionInactiveBackgroundOpaque,ke=!0),ke&&ie.classList.add("xterm-decoration-top"),te){case 16777216:case 33554432:Ee=I.ansi[W],ie.classList.add(`xterm-bg-${W}`);break;case 50331648:Ee=o.rgba.toColor(W>>16,W>>8&255,255&W),this._addStyle(ie,`background-color:#${p((W>>>0).toString(16),"0",6)}`);break;default:ne?(Ee=I.foreground,ie.classList.add(`xterm-bg-${u.INVERTED_DEFAULT_COLOR}`)):Ee=I.background}switch(be||K.isDim()&&(be=o.color.multiplyOpacity(Ee,.5)),j){case 16777216:case 33554432:K.isBold()&&G<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(G+=8),this._applyMinimumContrast(ie,Ee,I.ansi[G],K,be,void 0)||ie.classList.add(`xterm-fg-${G}`);break;case 50331648:const fe=o.rgba.toColor(G>>16&255,G>>8&255,255&G);this._applyMinimumContrast(ie,Ee,fe,K,be,he)||this._addStyle(ie,`color:#${p(G.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(ie,Ee,I.foreground,K,be,void 0)||ne&&ie.classList.add(`xterm-fg-${u.INVERTED_DEFAULT_COLOR}`)}D.appendChild(ie),F[P]=++O,P=X}return P<B-1&&F.subarray(P).fill(++O),D}_applyMinimumContrast(v,w,m,b,E,A){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,s.excludeFromContrastRatioDemands)(b.getCode()))return!1;let T;return E||A||(T=this._themeService.colors.contrastCache.getColor(w.rgba,m.rgba)),T===void 0&&(T=o.color.ensureContrastRatio(E||w,A||m,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((E||w).rgba,(A||m).rgba,T??null)),!!T&&(this._addStyle(v,`color:${T.css}`),!0)}_addStyle(v,w){v.setAttribute("style",`${v.getAttribute("style")||""}${w};`)}_isCellInSelection(v,w){const m=this._selectionStart,b=this._selectionEnd;return!(!m||!b)&&(this._columnSelectMode?m[0]<=b[0]?v>=m[0]&&w>=m[1]&&v<b[0]&&w<=b[1]:v<m[0]&&w>=m[1]&&v>=b[0]&&w<=b[1]:w>m[1]&&w<b[1]||m[1]===b[1]&&w===m[1]&&v>=m[0]&&v<b[0]||m[1]<b[1]&&w===b[1]&&v<b[0]||m[1]<b[1]&&w===m[1]&&v>=m[0])}};function p(v,w,m){for(;v.length<m;)v=w+v;return v}h=g([f(1,t.ICharacterJoinerService),f(2,_.IOptionsService),f(3,t.ICoreBrowserService),f(4,_.ICoreService),f(5,_.IDecorationService),f(6,t.IThemeService)],h),c.DomRendererRowFactory=h},2223:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const g=y(6114);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=g.isFirefox||g.isLegacyEdge?"bottom":"ideographic"},6171:($,c)=>{function y(g){return 57508<=g&&g<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(g){if(!g)throw new Error("value must not be falsy");return g},c.isPowerlineGlyph=y,c.isRestrictedPowerlineGlyph=function(g){return 57520<=g&&g<=57527},c.excludeFromContrastRatioDemands=function(g){return y(g)||function(f){return 9472<=f&&f<=9631}(g)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionModel=void 0,c.SelectionModel=class{constructor(y){this._bufferService=y,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const y=this.selectionStart[0]+this.selectionStartLength;return y>this._bufferService.cols?y%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)-1]:[y%this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)]:[y,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const y=this.selectionStart[0]+this.selectionStartLength;return y>this._bufferService.cols?[y%this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)]:[Math.max(y,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const y=this.selectionStart,g=this.selectionEnd;return!(!y||!g)&&(y[1]>g[1]||y[1]===g[1]&&y[0]>g[0])}handleTrim(y){return this.selectionStart&&(this.selectionStart[1]-=y),this.selectionEnd&&(this.selectionEnd[1]-=y),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function($,c,y){var g=this&&this.__decorate||function(t,l,s,i){var h,p=arguments.length,v=p<3?l:i===null?i=Object.getOwnPropertyDescriptor(l,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,l,s,i);else for(var w=t.length-1;w>=0;w--)(h=t[w])&&(v=(p<3?h(v):p>3?h(l,s,v):h(l,s))||v);return p>3&&v&&Object.defineProperty(l,s,v),v},f=this&&this.__param||function(t,l){return function(s,i){l(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharSizeService=void 0;const u=y(2585),d=y(8460),C=y(844);let _=class extends C.Disposable{constructor(t,l,s){super(),this._optionsService=s,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new o(t,l,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};_=g([f(2,u.IOptionsService)],_),c.CharSizeService=_;class o{constructor(l,s,i){this._document=l,this._parentElement=s,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const l=this._measureElement.getBoundingClientRect();return l.width!==0&&l.height!==0&&(this._result.width=l.width,this._result.height=Math.ceil(l.height)),this._result}}},4269:function($,c,y){var g=this&&this.__decorate||function(l,s,i,h){var p,v=arguments.length,w=v<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,i):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(l,s,i,h);else for(var m=l.length-1;m>=0;m--)(p=l[m])&&(w=(v<3?p(w):v>3?p(s,i,w):p(s,i))||w);return v>3&&w&&Object.defineProperty(s,i,w),w},f=this&&this.__param||function(l,s){return function(i,h){s(i,h,l)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const u=y(3734),d=y(643),C=y(511),_=y(2585);class o extends u.AttributeData{constructor(s,i,h){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=i,this._width=h}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=o;let t=class Yi{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new C.CellData}register(s){const i={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(i),i.id}deregister(s){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===s)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(s);if(!i||i.length===0)return[];const h=[],p=i.translateToString(!0);let v=0,w=0,m=0,b=i.getFg(0),E=i.getBg(0);for(let A=0;A<i.getTrimmedLength();A++)if(i.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==E){if(A-v>1){const T=this._getJoinedRanges(p,m,w,i,v);for(let B=0;B<T.length;B++)h.push(T[B])}v=A,m=w,b=this._workCell.fg,E=this._workCell.bg}w+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-v>1){const A=this._getJoinedRanges(p,m,w,i,v);for(let T=0;T<A.length;T++)h.push(A[T])}return h}_getJoinedRanges(s,i,h,p,v){const w=s.substring(i,h);let m=[];try{m=this._characterJoiners[0].handler(w)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{const E=this._characterJoiners[b].handler(w);for(let A=0;A<E.length;A++)Yi._mergeRanges(m,E[A])}catch(E){console.error(E)}return this._stringRangesToCellRanges(m,p,v),m}_stringRangesToCellRanges(s,i,h){let p=0,v=!1,w=0,m=s[p];if(m){for(let b=h;b<this._bufferService.cols;b++){const E=i.getWidth(b),A=i.getString(b).length||d.WHITESPACE_CELL_CHAR.length;if(E!==0){if(!v&&m[0]<=w&&(m[0]=b,v=!0),m[1]<=w){if(m[1]=b,m=s[++p],!m)break;m[0]<=w?(m[0]=b,v=!0):v=!1}w+=A}}m&&(m[1]=this._bufferService.cols)}}static _mergeRanges(s,i){let h=!1;for(let p=0;p<s.length;p++){const v=s[p];if(h){if(i[1]<=v[0])return s[p-1][1]=i[1],s;if(i[1]<=v[1])return s[p-1][1]=Math.max(i[1],v[1]),s.splice(p,1),s;s.splice(p,1),p--}else{if(i[1]<=v[0])return s.splice(p,0,i),s;if(i[1]<=v[1])return v[0]=Math.min(i[0],v[0]),s;i[0]<v[1]&&(v[0]=Math.min(i[0],v[0]),h=!0)}}return h?s[s.length-1][1]=i[1]:s.push(i),s}};t=g([f(0,_.IBufferService)],t),c.CharacterJoinerService=t},5114:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreBrowserService=void 0,c.CoreBrowserService=class{constructor(y,g){this._textarea=y,this.window=g,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function($,c,y){var g=this&&this.__decorate||function(_,o,t,l){var s,i=arguments.length,h=i<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,t):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(_,o,t,l);else for(var p=_.length-1;p>=0;p--)(s=_[p])&&(h=(i<3?s(h):i>3?s(o,t,h):s(o,t))||h);return i>3&&h&&Object.defineProperty(o,t,h),h},f=this&&this.__param||function(_,o){return function(t,l){o(t,l,_)}};Object.defineProperty(c,"__esModule",{value:!0}),c.MouseService=void 0;const u=y(4725),d=y(9806);let C=class{constructor(_,o){this._renderService=_,this._charSizeService=o}getCoords(_,o,t,l,s){return(0,d.getCoords)(window,_,o,t,l,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(_,o){const t=(0,d.getCoordsRelativeToElement)(window,_,o);if(!(!this._charSizeService.hasValidSize||t[0]<0||t[1]<0||t[0]>=this._renderService.dimensions.css.canvas.width||t[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};C=g([f(0,u.IRenderService),f(1,u.ICharSizeService)],C),c.MouseService=C},3230:function($,c,y){var g=this&&this.__decorate||function(h,p,v,w){var m,b=arguments.length,E=b<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,v):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(h,p,v,w);else for(var A=h.length-1;A>=0;A--)(m=h[A])&&(E=(b<3?m(E):b>3?m(p,v,E):m(p,v))||E);return b>3&&E&&Object.defineProperty(p,v,E),E},f=this&&this.__param||function(h,p){return function(v,w){p(v,w,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.RenderService=void 0;const u=y(6193),d=y(8460),C=y(844),_=y(5596),o=y(3656),t=y(2585),l=y(4725),s=y(7226);let i=class extends C.Disposable{constructor(h,p,v,w,m,b,E,A){if(super(),this._rowCount=h,this._charSizeService=w,this._pausedResizeTask=new s.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new d.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new d.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new d.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new d.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var T;return(T=this._renderer)===null||T===void 0?void 0:T.dispose()}}),this._renderDebouncer=new u.RenderDebouncer(E.window,(T,B)=>this._renderRows(T,B)),this.register(this._renderDebouncer),this._screenDprMonitor=new _.ScreenDprMonitor(E.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(b.onResize(()=>this._fullRefresh())),this.register(b.buffers.onBufferActivate(()=>{var T;return(T=this._renderer)===null||T===void 0?void 0:T.clear()})),this.register(v.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(m.onDecorationRegistered(()=>this._fullRefresh())),this.register(m.onDecorationRemoved(()=>this._fullRefresh())),this.register(v.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(b.cols,b.rows),this._fullRefresh()})),this.register(v.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(b.buffer.y,b.buffer.y,!0))),this.register((0,o.addDisposableDomListener)(E.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(A.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in E.window){const T=new E.window.IntersectionObserver(B=>this._handleIntersectionChange(B[B.length-1]),{threshold:0});T.observe(p),this.register({dispose:()=>T.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(h){this._isPaused=h.isIntersecting===void 0?h.intersectionRatio===0:!h.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(h,p,v=!1){this._isPaused?this._needsFullRefresh=!0:(v||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(h,p,this._rowCount))}_renderRows(h,p){this._renderer&&(h=Math.min(h,this._rowCount-1),p=Math.min(p,this._rowCount-1),this._renderer.renderRows(h,p),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:h,end:p}),this._onRender.fire({start:h,end:p}),this._isNextRenderRedrawOnly=!0)}resize(h,p){this._rowCount=p,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(h){var p;(p=this._renderer)===null||p===void 0||p.dispose(),this._renderer=h,this._renderer.onRequestRedraw(v=>this.refreshRows(v.start,v.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(h){return this._renderDebouncer.addRefreshCallback(h)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var h,p;this._renderer&&((p=(h=this._renderer).clearTextureAtlas)===null||p===void 0||p.call(h),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(h,p){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(h,p)):this._renderer.handleResize(h,p),this._fullRefresh())}handleCharSizeChanged(){var h;(h=this._renderer)===null||h===void 0||h.handleCharSizeChanged()}handleBlur(){var h;(h=this._renderer)===null||h===void 0||h.handleBlur()}handleFocus(){var h;(h=this._renderer)===null||h===void 0||h.handleFocus()}handleSelectionChanged(h,p,v){var w;this._selectionState.start=h,this._selectionState.end=p,this._selectionState.columnSelectMode=v,(w=this._renderer)===null||w===void 0||w.handleSelectionChanged(h,p,v)}handleCursorMove(){var h;(h=this._renderer)===null||h===void 0||h.handleCursorMove()}clear(){var h;(h=this._renderer)===null||h===void 0||h.clear()}};i=g([f(2,t.IOptionsService),f(3,l.ICharSizeService),f(4,t.IDecorationService),f(5,t.IBufferService),f(6,l.ICoreBrowserService),f(7,l.IThemeService)],i),c.RenderService=i},9312:function($,c,y){var g=this&&this.__decorate||function(m,b,E,A){var T,B=arguments.length,F=B<3?b:A===null?A=Object.getOwnPropertyDescriptor(b,E):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(m,b,E,A);else for(var D=m.length-1;D>=0;D--)(T=m[D])&&(F=(B<3?T(F):B>3?T(b,E,F):T(b,E))||F);return B>3&&F&&Object.defineProperty(b,E,F),F},f=this&&this.__param||function(m,b){return function(E,A){b(E,A,m)}};Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionService=void 0;const u=y(6114),d=y(456),C=y(511),_=y(8460),o=y(4725),t=y(2585),l=y(9806),s=y(9504),i=y(844),h=y(4841),p=String.fromCharCode(160),v=new RegExp(p,"g");let w=class extends i.Disposable{constructor(m,b,E,A,T,B,F,D,H){super(),this._element=m,this._screenElement=b,this._linkifier=E,this._bufferService=A,this._coreService=T,this._mouseService=B,this._optionsService=F,this._renderService=D,this._coreBrowserService=H,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new C.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=L=>this._handleMouseMove(L),this._mouseUpListener=L=>this._handleMouseUp(L),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(L=>this._handleTrim(L)),this.register(this._bufferService.buffers.onBufferActivate(L=>this._handleBufferActivate(L))),this.enable(),this._model=new d.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const m=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;return!(!m||!b||m[0]===b[0]&&m[1]===b[1])}get selectionText(){const m=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;if(!m||!b)return"";const E=this._bufferService.buffer,A=[];if(this._activeSelectionMode===3){if(m[0]===b[0])return"";const T=m[0]<b[0]?m[0]:b[0],B=m[0]<b[0]?b[0]:m[0];for(let F=m[1];F<=b[1];F++){const D=E.translateBufferLineToString(F,!0,T,B);A.push(D)}}else{const T=m[1]===b[1]?b[0]:void 0;A.push(E.translateBufferLineToString(m[1],!0,m[0],T));for(let B=m[1]+1;B<=b[1]-1;B++){const F=E.lines.get(B),D=E.translateBufferLineToString(B,!0);F!=null&&F.isWrapped?A[A.length-1]+=D:A.push(D)}if(m[1]!==b[1]){const B=E.lines.get(b[1]),F=E.translateBufferLineToString(b[1],!0,0,b[0]);B&&B.isWrapped?A[A.length-1]+=F:A.push(F)}}return A.map(T=>T.replace(v," ")).join(u.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(m){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),u.isLinux&&m&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(m){const b=this._getMouseBufferCoords(m),E=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!!(E&&A&&b)&&this._areCoordsInSelection(b,E,A)}isCellInSelection(m,b){const E=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!(!E||!A)&&this._areCoordsInSelection([m,b],E,A)}_areCoordsInSelection(m,b,E){return m[1]>b[1]&&m[1]<E[1]||b[1]===E[1]&&m[1]===b[1]&&m[0]>=b[0]&&m[0]<E[0]||b[1]<E[1]&&m[1]===E[1]&&m[0]<E[0]||b[1]<E[1]&&m[1]===b[1]&&m[0]>=b[0]}_selectWordAtCursor(m,b){var E,A;const T=(A=(E=this._linkifier.currentLink)===null||E===void 0?void 0:E.link)===null||A===void 0?void 0:A.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,h.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(m);return!!B&&(this._selectWordAt(B,b),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(m,b){this._model.clearSelection(),m=Math.max(m,0),b=Math.min(b,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,m],this._model.selectionEnd=[this._bufferService.cols,b],this.refresh(),this._onSelectionChange.fire()}_handleTrim(m){this._model.handleTrim(m)&&this.refresh()}_getMouseBufferCoords(m){const b=this._mouseService.getCoords(m,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(b)return b[0]--,b[1]--,b[1]+=this._bufferService.buffer.ydisp,b}_getMouseEventScrollAmount(m){let b=(0,l.getCoordsRelativeToElement)(this._coreBrowserService.window,m,this._screenElement)[1];const E=this._renderService.dimensions.css.canvas.height;return b>=0&&b<=E?0:(b>E&&(b-=E),b=Math.min(Math.max(b,-50),50),b/=50,b/Math.abs(b)+Math.round(14*b))}shouldForceSelection(m){return u.isMac?m.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:m.shiftKey}handleMouseDown(m){if(this._mouseDownTimeStamp=m.timeStamp,(m.button!==2||!this.hasSelection)&&m.button===0){if(!this._enabled){if(!this.shouldForceSelection(m))return;m.stopPropagation()}m.preventDefault(),this._dragScrollAmount=0,this._enabled&&m.shiftKey?this._handleIncrementalClick(m):m.detail===1?this._handleSingleClick(m):m.detail===2?this._handleDoubleClick(m):m.detail===3&&this._handleTripleClick(m),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(m){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(m))}_handleSingleClick(m){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(m)?3:0,this._model.selectionStart=this._getMouseBufferCoords(m),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const b=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);b&&b.length!==this._model.selectionStart[0]&&b.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(m){this._selectWordAtCursor(m,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(m){const b=this._getMouseBufferCoords(m);b&&(this._activeSelectionMode=2,this._selectLineAt(b[1]))}shouldColumnSelect(m){return m.altKey&&!(u.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(m){if(m.stopImmediatePropagation(),!this._model.selectionStart)return;const b=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(m),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(m),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const E=this._bufferService.buffer;if(this._model.selectionEnd[1]<E.lines.length){const A=E.lines.get(this._model.selectionEnd[1]);A&&A.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}b&&b[0]===this._model.selectionEnd[0]&&b[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const m=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(m.ydisp+this._bufferService.rows,m.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=m.ydisp),this.refresh()}}_handleMouseUp(m){const b=m.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&b<500&&m.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const E=this._mouseService.getCoords(m,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(E&&E[0]!==void 0&&E[1]!==void 0){const A=(0,s.moveToCellSequence)(E[0]-1,E[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(A,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const m=this._model.finalSelectionStart,b=this._model.finalSelectionEnd,E=!(!m||!b||m[0]===b[0]&&m[1]===b[1]);E?m&&b&&(this._oldSelectionStart&&this._oldSelectionEnd&&m[0]===this._oldSelectionStart[0]&&m[1]===this._oldSelectionStart[1]&&b[0]===this._oldSelectionEnd[0]&&b[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(m,b,E)):this._oldHasSelection&&this._fireOnSelectionChange(m,b,E)}_fireOnSelectionChange(m,b,E){this._oldSelectionStart=m,this._oldSelectionEnd=b,this._oldHasSelection=E,this._onSelectionChange.fire()}_handleBufferActivate(m){this.clearSelection(),this._trimListener.dispose(),this._trimListener=m.activeBuffer.lines.onTrim(b=>this._handleTrim(b))}_convertViewportColToCharacterIndex(m,b){let E=b;for(let A=0;b>=A;A++){const T=m.loadCell(A,this._workCell).getChars().length;this._workCell.getWidth()===0?E--:T>1&&b!==A&&(E+=T-1)}return E}setSelection(m,b,E){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[m,b],this._model.selectionStartLength=E,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(m){this._isClickInSelection(m)||(this._selectWordAtCursor(m,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(m,b,E=!0,A=!0){if(m[0]>=this._bufferService.cols)return;const T=this._bufferService.buffer,B=T.lines.get(m[1]);if(!B)return;const F=T.translateBufferLineToString(m[1],!1);let D=this._convertViewportColToCharacterIndex(B,m[0]),H=D;const L=m[0]-D;let I=0,O=0,P=0,Q=0;if(F.charAt(D)===" "){for(;D>0&&F.charAt(D-1)===" ";)D--;for(;H<F.length&&F.charAt(H+1)===" ";)H++}else{let K=m[0],ie=m[0];B.getWidth(K)===0&&(I++,K--),B.getWidth(ie)===2&&(O++,ie++);const G=B.getString(ie).length;for(G>1&&(Q+=G-1,H+=G-1);K>0&&D>0&&!this._isCharWordSeparator(B.loadCell(K-1,this._workCell));){B.loadCell(K-1,this._workCell);const j=this._workCell.getChars().length;this._workCell.getWidth()===0?(I++,K--):j>1&&(P+=j-1,D-=j-1),D--,K--}for(;ie<B.length&&H+1<F.length&&!this._isCharWordSeparator(B.loadCell(ie+1,this._workCell));){B.loadCell(ie+1,this._workCell);const j=this._workCell.getChars().length;this._workCell.getWidth()===2?(O++,ie++):j>1&&(Q+=j-1,H+=j-1),H++,ie++}}H++;let z=D+L-I+P,X=Math.min(this._bufferService.cols,H-D+I+O-P-Q);if(b||F.slice(D,H).trim()!==""){if(E&&z===0&&B.getCodePoint(0)!==32){const K=T.lines.get(m[1]-1);if(K&&B.isWrapped&&K.getCodePoint(this._bufferService.cols-1)!==32){const ie=this._getWordAt([this._bufferService.cols-1,m[1]-1],!1,!0,!1);if(ie){const G=this._bufferService.cols-ie.start;z-=G,X+=G}}}if(A&&z+X===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const K=T.lines.get(m[1]+1);if(K!=null&&K.isWrapped&&K.getCodePoint(0)!==32){const ie=this._getWordAt([0,m[1]+1],!1,!1,!0);ie&&(X+=ie.length)}}return{start:z,length:X}}}_selectWordAt(m,b){const E=this._getWordAt(m,b);if(E){for(;E.start<0;)E.start+=this._bufferService.cols,m[1]--;this._model.selectionStart=[E.start,m[1]],this._model.selectionStartLength=E.length}}_selectToWordAt(m){const b=this._getWordAt(m,!0);if(b){let E=m[1];for(;b.start<0;)b.start+=this._bufferService.cols,E--;if(!this._model.areSelectionValuesReversed())for(;b.start+b.length>this._bufferService.cols;)b.length-=this._bufferService.cols,E++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?b.start:b.start+b.length,E]}}_isCharWordSeparator(m){return m.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(m.getChars())>=0}_selectLineAt(m){const b=this._bufferService.buffer.getWrappedRangeForLine(m),E={start:{x:0,y:b.first},end:{x:this._bufferService.cols-1,y:b.last}};this._model.selectionStart=[0,b.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,h.getRangeLength)(E,this._bufferService.cols)}};w=g([f(3,t.IBufferService),f(4,t.ICoreService),f(5,o.IMouseService),f(6,t.IOptionsService),f(7,o.IRenderService),f(8,o.ICoreBrowserService)],w),c.SelectionService=w},4725:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IThemeService=c.ICharacterJoinerService=c.ISelectionService=c.IRenderService=c.IMouseService=c.ICoreBrowserService=c.ICharSizeService=void 0;const g=y(8343);c.ICharSizeService=(0,g.createDecorator)("CharSizeService"),c.ICoreBrowserService=(0,g.createDecorator)("CoreBrowserService"),c.IMouseService=(0,g.createDecorator)("MouseService"),c.IRenderService=(0,g.createDecorator)("RenderService"),c.ISelectionService=(0,g.createDecorator)("SelectionService"),c.ICharacterJoinerService=(0,g.createDecorator)("CharacterJoinerService"),c.IThemeService=(0,g.createDecorator)("ThemeService")},6731:function($,c,y){var g=this&&this.__decorate||function(w,m,b,E){var A,T=arguments.length,B=T<3?m:E===null?E=Object.getOwnPropertyDescriptor(m,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(w,m,b,E);else for(var F=w.length-1;F>=0;F--)(A=w[F])&&(B=(T<3?A(B):T>3?A(m,b,B):A(m,b))||B);return T>3&&B&&Object.defineProperty(m,b,B),B},f=this&&this.__param||function(w,m){return function(b,E){m(b,E,w)}};Object.defineProperty(c,"__esModule",{value:!0}),c.ThemeService=c.DEFAULT_ANSI_COLORS=void 0;const u=y(7239),d=y(8055),C=y(8460),_=y(844),o=y(2585),t=d.css.toColor("#ffffff"),l=d.css.toColor("#000000"),s=d.css.toColor("#ffffff"),i=d.css.toColor("#000000"),h={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};c.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const w=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],m=[0,95,135,175,215,255];for(let b=0;b<216;b++){const E=m[b/36%6|0],A=m[b/6%6|0],T=m[b%6];w.push({css:d.channels.toCss(E,A,T),rgba:d.channels.toRgba(E,A,T)})}for(let b=0;b<24;b++){const E=8+10*b;w.push({css:d.channels.toCss(E,E,E),rgba:d.channels.toRgba(E,E,E)})}return w})());let p=class extends _.Disposable{constructor(w){super(),this._optionsService=w,this._onChangeColors=this.register(new C.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new u.ColorContrastCache,this._colors={foreground:t,background:l,cursor:s,cursorAccent:i,selectionForeground:void 0,selectionBackgroundTransparent:h,selectionBackgroundOpaque:d.color.blend(l,h),selectionInactiveBackgroundTransparent:h,selectionInactiveBackgroundOpaque:d.color.blend(l,h),ansi:c.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(w={}){const m=this._colors;if(m.foreground=v(w.foreground,t),m.background=v(w.background,l),m.cursor=v(w.cursor,s),m.cursorAccent=v(w.cursorAccent,i),m.selectionBackgroundTransparent=v(w.selectionBackground,h),m.selectionBackgroundOpaque=d.color.blend(m.background,m.selectionBackgroundTransparent),m.selectionInactiveBackgroundTransparent=v(w.selectionInactiveBackground,m.selectionBackgroundTransparent),m.selectionInactiveBackgroundOpaque=d.color.blend(m.background,m.selectionInactiveBackgroundTransparent),m.selectionForeground=w.selectionForeground?v(w.selectionForeground,d.NULL_COLOR):void 0,m.selectionForeground===d.NULL_COLOR&&(m.selectionForeground=void 0),d.color.isOpaque(m.selectionBackgroundTransparent)&&(m.selectionBackgroundTransparent=d.color.opacity(m.selectionBackgroundTransparent,.3)),d.color.isOpaque(m.selectionInactiveBackgroundTransparent)&&(m.selectionInactiveBackgroundTransparent=d.color.opacity(m.selectionInactiveBackgroundTransparent,.3)),m.ansi=c.DEFAULT_ANSI_COLORS.slice(),m.ansi[0]=v(w.black,c.DEFAULT_ANSI_COLORS[0]),m.ansi[1]=v(w.red,c.DEFAULT_ANSI_COLORS[1]),m.ansi[2]=v(w.green,c.DEFAULT_ANSI_COLORS[2]),m.ansi[3]=v(w.yellow,c.DEFAULT_ANSI_COLORS[3]),m.ansi[4]=v(w.blue,c.DEFAULT_ANSI_COLORS[4]),m.ansi[5]=v(w.magenta,c.DEFAULT_ANSI_COLORS[5]),m.ansi[6]=v(w.cyan,c.DEFAULT_ANSI_COLORS[6]),m.ansi[7]=v(w.white,c.DEFAULT_ANSI_COLORS[7]),m.ansi[8]=v(w.brightBlack,c.DEFAULT_ANSI_COLORS[8]),m.ansi[9]=v(w.brightRed,c.DEFAULT_ANSI_COLORS[9]),m.ansi[10]=v(w.brightGreen,c.DEFAULT_ANSI_COLORS[10]),m.ansi[11]=v(w.brightYellow,c.DEFAULT_ANSI_COLORS[11]),m.ansi[12]=v(w.brightBlue,c.DEFAULT_ANSI_COLORS[12]),m.ansi[13]=v(w.brightMagenta,c.DEFAULT_ANSI_COLORS[13]),m.ansi[14]=v(w.brightCyan,c.DEFAULT_ANSI_COLORS[14]),m.ansi[15]=v(w.brightWhite,c.DEFAULT_ANSI_COLORS[15]),w.extendedAnsi){const b=Math.min(m.ansi.length-16,w.extendedAnsi.length);for(let E=0;E<b;E++)m.ansi[E+16]=v(w.extendedAnsi[E],c.DEFAULT_ANSI_COLORS[E+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(w){this._restoreColor(w),this._onChangeColors.fire(this.colors)}_restoreColor(w){if(w!==void 0)switch(w){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[w]=this._restoreColors.ansi[w]}else for(let m=0;m<this._restoreColors.ansi.length;++m)this._colors.ansi[m]=this._restoreColors.ansi[m]}modifyColors(w){w(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function v(w,m){if(w!==void 0)try{return d.css.toColor(w)}catch{}return m}p=g([f(0,o.IOptionsService)],p),c.ThemeService=p},6349:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CircularList=void 0;const g=y(8460),f=y(844);class u extends f.Disposable{constructor(C){super(),this._maxLength=C,this.onDeleteEmitter=this.register(new g.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new g.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new g.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(C){if(this._maxLength===C)return;const _=new Array(C);for(let o=0;o<Math.min(C,this.length);o++)_[o]=this._array[this._getCyclicIndex(o)];this._array=_,this._maxLength=C,this._startIndex=0}get length(){return this._length}set length(C){if(C>this._length)for(let _=this._length;_<C;_++)this._array[_]=void 0;this._length=C}get(C){return this._array[this._getCyclicIndex(C)]}set(C,_){this._array[this._getCyclicIndex(C)]=_}push(C){this._array[this._getCyclicIndex(this._length)]=C,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(C,_,...o){if(_){for(let t=C;t<this._length-_;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+_)];this._length-=_,this.onDeleteEmitter.fire({index:C,amount:_})}for(let t=this._length-1;t>=C;t--)this._array[this._getCyclicIndex(t+o.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<o.length;t++)this._array[this._getCyclicIndex(C+t)]=o[t];if(o.length&&this.onInsertEmitter.fire({index:C,amount:o.length}),this._length+o.length>this._maxLength){const t=this._length+o.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=o.length}trimStart(C){C>this._length&&(C=this._length),this._startIndex+=C,this._length-=C,this.onTrimEmitter.fire(C)}shiftElements(C,_,o){if(!(_<=0)){if(C<0||C>=this._length)throw new Error("start argument out of range");if(C+o<0)throw new Error("Cannot shift elements in list beyond index 0");if(o>0){for(let l=_-1;l>=0;l--)this.set(C+l+o,this.get(C+l));const t=C+_+o-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<_;t++)this.set(C+t+o,this.get(C+t))}}_getCyclicIndex(C){return(this._startIndex+C)%this._maxLength}}c.CircularList=u},1439:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.clone=void 0,c.clone=function y(g,f=5){if(typeof g!="object")return g;const u=Array.isArray(g)?[]:{};for(const d in g)u[d]=f<=1?g[d]:g[d]&&y(g[d],f-1);return u}},8055:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const g=y(6114);let f=0,u=0,d=0,C=0;var _,o,t;function l(i){const h=i.toString(16);return h.length<2?"0"+h:h}function s(i,h){return i<h?(h+.05)/(i+.05):(i+.05)/(h+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(i){i.toCss=function(h,p,v,w){return w!==void 0?`#${l(h)}${l(p)}${l(v)}${l(w)}`:`#${l(h)}${l(p)}${l(v)}`},i.toRgba=function(h,p,v,w=255){return(h<<24|p<<16|v<<8|w)>>>0}}(_=c.channels||(c.channels={})),function(i){function h(p,v){return C=Math.round(255*v),[f,u,d]=t.toChannels(p.rgba),{css:_.toCss(f,u,d,C),rgba:_.toRgba(f,u,d,C)}}i.blend=function(p,v){if(C=(255&v.rgba)/255,C===1)return{css:v.css,rgba:v.rgba};const w=v.rgba>>24&255,m=v.rgba>>16&255,b=v.rgba>>8&255,E=p.rgba>>24&255,A=p.rgba>>16&255,T=p.rgba>>8&255;return f=E+Math.round((w-E)*C),u=A+Math.round((m-A)*C),d=T+Math.round((b-T)*C),{css:_.toCss(f,u,d),rgba:_.toRgba(f,u,d)}},i.isOpaque=function(p){return(255&p.rgba)==255},i.ensureContrastRatio=function(p,v,w){const m=t.ensureContrastRatio(p.rgba,v.rgba,w);if(m)return t.toColor(m>>24&255,m>>16&255,m>>8&255)},i.opaque=function(p){const v=(255|p.rgba)>>>0;return[f,u,d]=t.toChannels(v),{css:_.toCss(f,u,d),rgba:v}},i.opacity=h,i.multiplyOpacity=function(p,v){return C=255&p.rgba,h(p,C*v/255)},i.toColorRGB=function(p){return[p.rgba>>24&255,p.rgba>>16&255,p.rgba>>8&255]}}(c.color||(c.color={})),function(i){let h,p;if(!g.isNode){const v=document.createElement("canvas");v.width=1,v.height=1;const w=v.getContext("2d",{willReadFrequently:!0});w&&(h=w,h.globalCompositeOperation="copy",p=h.createLinearGradient(0,0,1,1))}i.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return f=parseInt(v.slice(1,2).repeat(2),16),u=parseInt(v.slice(2,3).repeat(2),16),d=parseInt(v.slice(3,4).repeat(2),16),t.toColor(f,u,d);case 5:return f=parseInt(v.slice(1,2).repeat(2),16),u=parseInt(v.slice(2,3).repeat(2),16),d=parseInt(v.slice(3,4).repeat(2),16),C=parseInt(v.slice(4,5).repeat(2),16),t.toColor(f,u,d,C);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}const w=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return f=parseInt(w[1]),u=parseInt(w[2]),d=parseInt(w[3]),C=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),t.toColor(f,u,d,C);if(!h||!p)throw new Error("css.toColor: Unsupported css format");if(h.fillStyle=p,h.fillStyle=v,typeof h.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(h.fillRect(0,0,1,1),[f,u,d,C]=h.getImageData(0,0,1,1).data,C!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:_.toRgba(f,u,d,C),css:v}}}(c.css||(c.css={})),function(i){function h(p,v,w){const m=p/255,b=v/255,E=w/255;return .2126*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.7152*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.0722*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))}i.relativeLuminance=function(p){return h(p>>16&255,p>>8&255,255&p)},i.relativeLuminance2=h}(o=c.rgb||(c.rgb={})),function(i){function h(v,w,m){const b=v>>24&255,E=v>>16&255,A=v>>8&255;let T=w>>24&255,B=w>>16&255,F=w>>8&255,D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));for(;D<m&&(T>0||B>0||F>0);)T-=Math.max(0,Math.ceil(.1*T)),B-=Math.max(0,Math.ceil(.1*B)),F-=Math.max(0,Math.ceil(.1*F)),D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));return(T<<24|B<<16|F<<8|255)>>>0}function p(v,w,m){const b=v>>24&255,E=v>>16&255,A=v>>8&255;let T=w>>24&255,B=w>>16&255,F=w>>8&255,D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));for(;D<m&&(T<255||B<255||F<255);)T=Math.min(255,T+Math.ceil(.1*(255-T))),B=Math.min(255,B+Math.ceil(.1*(255-B))),F=Math.min(255,F+Math.ceil(.1*(255-F))),D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));return(T<<24|B<<16|F<<8|255)>>>0}i.ensureContrastRatio=function(v,w,m){const b=o.relativeLuminance(v>>8),E=o.relativeLuminance(w>>8);if(s(b,E)<m){if(E<b){const B=h(v,w,m),F=s(b,o.relativeLuminance(B>>8));if(F<m){const D=p(v,w,m);return F>s(b,o.relativeLuminance(D>>8))?B:D}return B}const A=p(v,w,m),T=s(b,o.relativeLuminance(A>>8));if(T<m){const B=h(v,w,m);return T>s(b,o.relativeLuminance(B>>8))?A:B}return A}},i.reduceLuminance=h,i.increaseLuminance=p,i.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},i.toColor=function(v,w,m,b){return{css:_.toCss(v,w,m,b),rgba:_.toRgba(v,w,m,b)}}}(t=c.rgba||(c.rgba={})),c.toPaddedHex=l,c.contrastRatio=s},8969:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreTerminal=void 0;const g=y(844),f=y(2585),u=y(4348),d=y(7866),C=y(744),_=y(7302),o=y(6975),t=y(8460),l=y(1753),s=y(1480),i=y(7994),h=y(9282),p=y(5435),v=y(5981),w=y(2660);let m=!1;class b extends g.Disposable{constructor(A){super(),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new u.InstantiationService,this.optionsService=this.register(new _.OptionsService(A)),this._instantiationService.setService(f.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(C.BufferService)),this._instantiationService.setService(f.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(f.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(o.CoreService)),this._instantiationService.setService(f.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(l.CoreMouseService)),this._instantiationService.setService(f.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(s.UnicodeService)),this._instantiationService.setService(f.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(i.CharsetService),this._instantiationService.setService(f.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(w.OscLinkService),this._instantiationService.setService(f.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new p.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",T=>this._handleWindowsModeOptionChange(T))),this.register(this._bufferService.onScroll(T=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(T=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new v.WriteBuffer((T,B)=>this._inputHandler.parse(T,B))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,g.toDisposable)(()=>{var T;(T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(A=>{var T;(T=this._onScrollApi)===null||T===void 0||T.fire(A.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(A){for(const T in A)this.optionsService.options[T]=A[T]}write(A,T){this._writeBuffer.write(A,T)}writeSync(A,T){this._logService.logLevel<=f.LogLevelEnum.WARN&&!m&&(this._logService.warn("writeSync is unreliable and will be removed soon."),m=!0),this._writeBuffer.writeSync(A,T)}resize(A,T){isNaN(A)||isNaN(T)||(A=Math.max(A,C.MINIMUM_COLS),T=Math.max(T,C.MINIMUM_ROWS),this._bufferService.resize(A,T))}scroll(A,T=!1){this._bufferService.scroll(A,T)}scrollLines(A,T,B){this._bufferService.scrollLines(A,T,B)}scrollPages(A){this._bufferService.scrollPages(A)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(A){this._bufferService.scrollToLine(A)}registerEscHandler(A,T){return this._inputHandler.registerEscHandler(A,T)}registerDcsHandler(A,T){return this._inputHandler.registerDcsHandler(A,T)}registerCsiHandler(A,T){return this._inputHandler.registerCsiHandler(A,T)}registerOscHandler(A,T){return this._inputHandler.registerOscHandler(A,T)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(A){var T;A?this._enableWindowsMode():((T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const A=[];A.push(this.onLineFeed(h.updateWindowsModeWrappedState.bind(null,this._bufferService))),A.push(this.registerCsiHandler({final:"H"},()=>((0,h.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(const T of A)T.dispose()}}}}}c.CoreTerminal=b},8460:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=y=>(this._listeners.push(y),{dispose:()=>{if(!this._disposed){for(let g=0;g<this._listeners.length;g++)if(this._listeners[g]===y)return void this._listeners.splice(g,1)}}})),this._event}fire(y,g){const f=[];for(let u=0;u<this._listeners.length;u++)f.push(this._listeners[u]);for(let u=0;u<f.length;u++)f[u].call(void 0,y,g)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(y,g){return y(f=>g.fire(f))}},5435:function($,c,y){var g=this&&this.__decorate||function(H,L,I,O){var P,Q=arguments.length,z=Q<3?L:O===null?O=Object.getOwnPropertyDescriptor(L,I):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")z=Reflect.decorate(H,L,I,O);else for(var X=H.length-1;X>=0;X--)(P=H[X])&&(z=(Q<3?P(z):Q>3?P(L,I,z):P(L,I))||z);return Q>3&&z&&Object.defineProperty(L,I,z),z},f=this&&this.__param||function(H,L){return function(I,O){L(I,O,H)}};Object.defineProperty(c,"__esModule",{value:!0}),c.InputHandler=c.WindowsOptionsReportType=void 0;const u=y(2584),d=y(7116),C=y(2015),_=y(844),o=y(482),t=y(8437),l=y(8460),s=y(643),i=y(511),h=y(3734),p=y(2585),v=y(6242),w=y(6351),m=y(5941),b={"(":0,")":1,"*":2,"+":3,"-":1,".":2},E=131072;function A(H,L){if(H>24)return L.setWinLines||!1;switch(H){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var T;(function(H){H[H.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",H[H.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(T=c.WindowsOptionsReportType||(c.WindowsOptionsReportType={}));let B=0;class F extends _.Disposable{constructor(L,I,O,P,Q,z,X,K,ie=new C.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=I,this._coreService=O,this._logService=P,this._optionsService=Q,this._oscLinkService=z,this._coreMouseService=X,this._unicodeService=K,this._parser=ie,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new o.StringToUtf32,this._utf8Decoder=new o.Utf8ToUtf32,this._workCell=new i.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new l.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new l.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new l.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new l.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new l.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new l.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new l.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new l.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new l.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new l.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new l.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new l.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new l.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new D(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(G=>this._activeBuffer=G.activeBuffer)),this._parser.setCsiHandlerFallback((G,j)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(G),params:j.toArray()})}),this._parser.setEscHandlerFallback(G=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(G)})}),this._parser.setExecuteHandlerFallback(G=>{this._logService.debug("Unknown EXECUTE code: ",{code:G})}),this._parser.setOscHandlerFallback((G,j,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:G,action:j,data:W})}),this._parser.setDcsHandlerFallback((G,j,W)=>{j==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(G),action:j,payload:W})}),this._parser.setPrintHandler((G,j,W)=>this.print(G,j,W)),this._parser.registerCsiHandler({final:"@"},G=>this.insertChars(G)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},G=>this.scrollLeft(G)),this._parser.registerCsiHandler({final:"A"},G=>this.cursorUp(G)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},G=>this.scrollRight(G)),this._parser.registerCsiHandler({final:"B"},G=>this.cursorDown(G)),this._parser.registerCsiHandler({final:"C"},G=>this.cursorForward(G)),this._parser.registerCsiHandler({final:"D"},G=>this.cursorBackward(G)),this._parser.registerCsiHandler({final:"E"},G=>this.cursorNextLine(G)),this._parser.registerCsiHandler({final:"F"},G=>this.cursorPrecedingLine(G)),this._parser.registerCsiHandler({final:"G"},G=>this.cursorCharAbsolute(G)),this._parser.registerCsiHandler({final:"H"},G=>this.cursorPosition(G)),this._parser.registerCsiHandler({final:"I"},G=>this.cursorForwardTab(G)),this._parser.registerCsiHandler({final:"J"},G=>this.eraseInDisplay(G,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},G=>this.eraseInDisplay(G,!0)),this._parser.registerCsiHandler({final:"K"},G=>this.eraseInLine(G,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},G=>this.eraseInLine(G,!0)),this._parser.registerCsiHandler({final:"L"},G=>this.insertLines(G)),this._parser.registerCsiHandler({final:"M"},G=>this.deleteLines(G)),this._parser.registerCsiHandler({final:"P"},G=>this.deleteChars(G)),this._parser.registerCsiHandler({final:"S"},G=>this.scrollUp(G)),this._parser.registerCsiHandler({final:"T"},G=>this.scrollDown(G)),this._parser.registerCsiHandler({final:"X"},G=>this.eraseChars(G)),this._parser.registerCsiHandler({final:"Z"},G=>this.cursorBackwardTab(G)),this._parser.registerCsiHandler({final:"`"},G=>this.charPosAbsolute(G)),this._parser.registerCsiHandler({final:"a"},G=>this.hPositionRelative(G)),this._parser.registerCsiHandler({final:"b"},G=>this.repeatPrecedingCharacter(G)),this._parser.registerCsiHandler({final:"c"},G=>this.sendDeviceAttributesPrimary(G)),this._parser.registerCsiHandler({prefix:">",final:"c"},G=>this.sendDeviceAttributesSecondary(G)),this._parser.registerCsiHandler({final:"d"},G=>this.linePosAbsolute(G)),this._parser.registerCsiHandler({final:"e"},G=>this.vPositionRelative(G)),this._parser.registerCsiHandler({final:"f"},G=>this.hVPosition(G)),this._parser.registerCsiHandler({final:"g"},G=>this.tabClear(G)),this._parser.registerCsiHandler({final:"h"},G=>this.setMode(G)),this._parser.registerCsiHandler({prefix:"?",final:"h"},G=>this.setModePrivate(G)),this._parser.registerCsiHandler({final:"l"},G=>this.resetMode(G)),this._parser.registerCsiHandler({prefix:"?",final:"l"},G=>this.resetModePrivate(G)),this._parser.registerCsiHandler({final:"m"},G=>this.charAttributes(G)),this._parser.registerCsiHandler({final:"n"},G=>this.deviceStatus(G)),this._parser.registerCsiHandler({prefix:"?",final:"n"},G=>this.deviceStatusPrivate(G)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},G=>this.softReset(G)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},G=>this.setCursorStyle(G)),this._parser.registerCsiHandler({final:"r"},G=>this.setScrollRegion(G)),this._parser.registerCsiHandler({final:"s"},G=>this.saveCursor(G)),this._parser.registerCsiHandler({final:"t"},G=>this.windowOptions(G)),this._parser.registerCsiHandler({final:"u"},G=>this.restoreCursor(G)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},G=>this.insertColumns(G)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},G=>this.deleteColumns(G)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},G=>this.selectProtected(G)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},G=>this.requestMode(G,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},G=>this.requestMode(G,!1)),this._parser.setExecuteHandler(u.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(u.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(u.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(u.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(u.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(u.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(u.C1.IND,()=>this.index()),this._parser.setExecuteHandler(u.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(u.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new v.OscHandler(G=>(this.setTitle(G),this.setIconName(G),!0))),this._parser.registerOscHandler(1,new v.OscHandler(G=>this.setIconName(G))),this._parser.registerOscHandler(2,new v.OscHandler(G=>this.setTitle(G))),this._parser.registerOscHandler(4,new v.OscHandler(G=>this.setOrReportIndexedColor(G))),this._parser.registerOscHandler(8,new v.OscHandler(G=>this.setHyperlink(G))),this._parser.registerOscHandler(10,new v.OscHandler(G=>this.setOrReportFgColor(G))),this._parser.registerOscHandler(11,new v.OscHandler(G=>this.setOrReportBgColor(G))),this._parser.registerOscHandler(12,new v.OscHandler(G=>this.setOrReportCursorColor(G))),this._parser.registerOscHandler(104,new v.OscHandler(G=>this.restoreIndexedColor(G))),this._parser.registerOscHandler(110,new v.OscHandler(G=>this.restoreFgColor(G))),this._parser.registerOscHandler(111,new v.OscHandler(G=>this.restoreBgColor(G))),this._parser.registerOscHandler(112,new v.OscHandler(G=>this.restoreCursorColor(G))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const G in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:G},()=>this.selectCharset("("+G)),this._parser.registerEscHandler({intermediates:")",final:G},()=>this.selectCharset(")"+G)),this._parser.registerEscHandler({intermediates:"*",final:G},()=>this.selectCharset("*"+G)),this._parser.registerEscHandler({intermediates:"+",final:G},()=>this.selectCharset("+"+G)),this._parser.registerEscHandler({intermediates:"-",final:G},()=>this.selectCharset("-"+G)),this._parser.registerEscHandler({intermediates:".",final:G},()=>this.selectCharset("."+G)),this._parser.registerEscHandler({intermediates:"/",final:G},()=>this.selectCharset("/"+G));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(G=>(this._logService.error("Parsing error: ",G),G)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new w.DcsHandler((G,j)=>this.requestStatusString(G,j)))}getAttrData(){return this._curAttrData}_preserveStack(L,I,O,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=I,this._parseStack.decodedLength=O,this._parseStack.position=P}_logSlowResolvingAsync(L){this._logService.logLevel<=p.LogLevelEnum.WARN&&Promise.race([L,new Promise((I,O)=>setTimeout(()=>O("#SLOW_TIMEOUT"),5e3))]).catch(I=>{if(I!=="#SLOW_TIMEOUT")throw I;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,I){let O,P=this._activeBuffer.x,Q=this._activeBuffer.y,z=0;const X=this._parseStack.paused;if(X){if(O=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,I))return this._logSlowResolvingAsync(O),O;P=this._parseStack.cursorStartX,Q=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>E&&(z=this._parseStack.position+E)}if(this._logService.logLevel<=p.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,K=>String.fromCharCode(K)).join("")}"`),typeof L=="string"?L.split("").map(K=>K.charCodeAt(0)):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<E&&(this._parseBuffer=new Uint32Array(Math.min(L.length,E))),X||this._dirtyRowTracker.clearRange(),L.length>E)for(let K=z;K<L.length;K+=E){const ie=K+E<L.length?K+E:L.length,G=typeof L=="string"?this._stringDecoder.decode(L.substring(K,ie),this._parseBuffer):this._utf8Decoder.decode(L.subarray(K,ie),this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,G))return this._preserveStack(P,Q,G,K),this._logSlowResolvingAsync(O),O}else if(!X){const K=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,K))return this._preserveStack(P,Q,K,0),this._logSlowResolvingAsync(O),O}this._activeBuffer.x===P&&this._activeBuffer.y===Q||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(L,I,O){let P,Q;const z=this._charsetService.charset,X=this._optionsService.rawOptions.screenReaderMode,K=this._bufferService.cols,ie=this._coreService.decPrivateModes.wraparound,G=this._coreService.modes.insertMode,j=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&O-I>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodePoint(this._activeBuffer.x-1,0,1,j.fg,j.bg,j.extended);for(let te=I;te<O;++te){if(P=L[te],Q=this._unicodeService.wcwidth(P),P<127&&z){const ne=z[String.fromCharCode(P)];ne&&(P=ne.charCodeAt(0))}if(X&&this._onA11yChar.fire((0,o.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),Q||!this._activeBuffer.x){if(this._activeBuffer.x+Q-1>=K){if(ie){for(;this._activeBuffer.x<K;)W.setCellFromCodePoint(this._activeBuffer.x++,0,1,j.fg,j.bg,j.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=K-1,Q===2)continue}if(G&&(W.insertCells(this._activeBuffer.x,Q,this._activeBuffer.getNullCell(j),j),W.getWidth(K-1)===2&&W.setCellFromCodePoint(K-1,s.NULL_CELL_CODE,s.NULL_CELL_WIDTH,j.fg,j.bg,j.extended)),W.setCellFromCodePoint(this._activeBuffer.x++,P,Q,j.fg,j.bg,j.extended),Q>0)for(;--Q;)W.setCellFromCodePoint(this._activeBuffer.x++,0,0,j.fg,j.bg,j.extended)}else W.getWidth(this._activeBuffer.x-1)?W.addCodepointToCell(this._activeBuffer.x-1,P):W.addCodepointToCell(this._activeBuffer.x-2,P)}O-I>0&&(W.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<K&&O-I>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodePoint(this._activeBuffer.x,0,1,j.fg,j.bg,j.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,I){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,I):this._parser.registerCsiHandler(L,O=>!A(O.params[0],this._optionsService.rawOptions.windowOptions)||I(O))}registerDcsHandler(L,I){return this._parser.registerDcsHandler(L,new w.DcsHandler(I))}registerEscHandler(L,I){return this._parser.registerEscHandler(L,I)}registerOscHandler(L,I){return this._parser.registerOscHandler(L,new v.OscHandler(I))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var L;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||L===void 0)&&L.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);I.hasWidth(this._activeBuffer.x)&&!I.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,I){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+I):(this._activeBuffer.x=L,this._activeBuffer.y=I),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,I){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+I)}cursorUp(L){const I=this._activeBuffer.y-this._activeBuffer.scrollTop;return I>=0?this._moveCursor(0,-Math.min(I,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const I=this._activeBuffer.scrollBottom-this._activeBuffer.y;return I>=0?this._moveCursor(0,Math.min(I,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const I=L.params[0];return I===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:I===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=L.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=L.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const I=L.params[0];return I===1&&(this._curAttrData.bg|=536870912),I!==2&&I!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,I,O,P=!1,Q=!1){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);z.replaceCells(I,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),Q),P&&(z.isWrapped=!1)}_resetBufferLine(L,I=!1){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);O.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),I),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),O.isWrapped=!1}eraseInDisplay(L,I=!1){let O;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);O<this._bufferService.rows;O++)this._resetBufferLine(O,I);this._dirtyRowTracker.markDirty(O);break;case 1:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O,0,this._activeBuffer.x+1,!0,I),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(O+1).isWrapped=!1);O--;)this._resetBufferLine(O,I);this._dirtyRowTracker.markDirty(0);break;case 2:for(O=this._bufferService.rows,this._dirtyRowTracker.markDirty(O-1);O--;)this._resetBufferLine(O,I);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(L,I=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,I);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,I)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let I=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,Q=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;I--;)this._activeBuffer.lines.splice(Q-1,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let I=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;I--;)this._activeBuffer.lines.splice(O,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let I=L.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let I=L.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){if(!this._parser.precedingCodepoint)return!0;const I=L.params[0]||1,O=new Uint32Array(I);for(let P=0;P<I;++P)O[P]=this._parser.precedingCodepoint;return this.print(O,0,O.length),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(u.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(u.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(u.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(u.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(u.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let I=0;I<L.length;I++)switch(L.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[I]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,I){const O=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:Q}=this._coreMouseService,z=this._coreService,{buffers:X,cols:K}=this._bufferService,{active:ie,alt:G}=X,j=this._optionsService.rawOptions,W=he=>he?1:2,te=L.params[0];return ne=te,be=I?te===2?4:te===4?W(z.modes.insertMode):te===12?3:te===20?W(j.convertEol):0:te===1?W(O.applicationCursorKeys):te===3?j.windowOptions.setWinLines?K===80?2:K===132?1:0:0:te===6?W(O.origin):te===7?W(O.wraparound):te===8?3:te===9?W(P==="X10"):te===12?W(j.cursorBlink):te===25?W(!z.isCursorHidden):te===45?W(O.reverseWraparound):te===66?W(O.applicationKeypad):te===67?4:te===1e3?W(P==="VT200"):te===1002?W(P==="DRAG"):te===1003?W(P==="ANY"):te===1004?W(O.sendFocus):te===1005?4:te===1006?W(Q==="SGR"):te===1015?4:te===1016?W(Q==="SGR_PIXELS"):te===1048?1:te===47||te===1047||te===1049?W(ie===G):te===2004?W(O.bracketedPasteMode):0,z.triggerDataEvent(`${u.C0.ESC}[${I?"":"?"}${ne};${be}$y`),!0;var ne,be}_updateAttrColor(L,I,O,P,Q){return I===2?(L|=50331648,L&=-16777216,L|=h.AttributeData.fromColorRGB([O,P,Q])):I===5&&(L&=-50331904,L|=33554432|255&O),L}_extractColor(L,I,O){const P=[0,0,-1,0,0,0];let Q=0,z=0;do{if(P[z+Q]=L.params[I+z],L.hasSubParams(I+z)){const X=L.getSubParams(I+z);let K=0;do P[1]===5&&(Q=1),P[z+K+1+Q]=X[K];while(++K<X.length&&K+z+1+Q<P.length);break}if(P[1]===5&&z+Q>=2||P[1]===2&&z+Q>=5)break;P[1]&&(Q=1)}while(++z+I<L.length&&z+Q<P.length);for(let X=2;X<P.length;++X)P[X]===-1&&(P[X]=0);switch(P[0]){case 38:O.fg=this._updateAttrColor(O.fg,P[1],P[3],P[4],P[5]);break;case 48:O.bg=this._updateAttrColor(O.bg,P[1],P[3],P[4],P[5]);break;case 58:O.extended=O.extended.clone(),O.extended.underlineColor=this._updateAttrColor(O.extended.underlineColor,P[1],P[3],P[4],P[5])}return z}_processUnderline(L,I){I.extended=I.extended.clone(),(!~L||L>5)&&(L=1),I.extended.underlineStyle=L,I.fg|=268435456,L===0&&(I.fg&=-268435457),I.updateExtended()}_processSGR0(L){L.fg=t.DEFAULT_ATTR_DATA.fg,L.bg=t.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const I=L.length;let O;const P=this._curAttrData;for(let Q=0;Q<I;Q++)O=L.params[Q],O>=30&&O<=37?(P.fg&=-50331904,P.fg|=16777216|O-30):O>=40&&O<=47?(P.bg&=-50331904,P.bg|=16777216|O-40):O>=90&&O<=97?(P.fg&=-50331904,P.fg|=16777224|O-90):O>=100&&O<=107?(P.bg&=-50331904,P.bg|=16777224|O-100):O===0?this._processSGR0(P):O===1?P.fg|=134217728:O===3?P.bg|=67108864:O===4?(P.fg|=268435456,this._processUnderline(L.hasSubParams(Q)?L.getSubParams(Q)[0]:1,P)):O===5?P.fg|=536870912:O===7?P.fg|=67108864:O===8?P.fg|=1073741824:O===9?P.fg|=2147483648:O===2?P.bg|=134217728:O===21?this._processUnderline(2,P):O===22?(P.fg&=-134217729,P.bg&=-134217729):O===23?P.bg&=-67108865:O===24?(P.fg&=-268435457,this._processUnderline(0,P)):O===25?P.fg&=-536870913:O===27?P.fg&=-67108865:O===28?P.fg&=-1073741825:O===29?P.fg&=2147483647:O===39?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):O===49?(P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):O===38||O===48||O===58?Q+=this._extractColor(L,Q,P):O===53?P.bg|=1073741824:O===55?P.bg&=-1073741825:O===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):O===100?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",O);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${u.C0.ESC}[0n`);break;case 6:const I=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[${I};${O}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const I=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[?${I};${O}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const I=L.params[0]||1;switch(I){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const O=I%2==1;return this._optionsService.options.cursorBlink=O,!0}setScrollRegion(L){const I=L.params[0]||1;let O;return(L.length<2||(O=L.params[1])>this._bufferService.rows||O===0)&&(O=this._bufferService.rows),O>I&&(this._activeBuffer.scrollTop=I-1,this._activeBuffer.scrollBottom=O-1,this._setCursor(0,0)),!0}windowOptions(L){if(!A(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const I=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:I!==2&&this._onRequestWindowsOptionsReport.fire(T.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(T.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${u.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:I!==0&&I!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),I!==0&&I!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:I!==0&&I!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),I!==0&&I!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const I=[],O=L.split(";");for(;O.length>1;){const P=O.shift(),Q=O.shift();if(/^\d+$/.exec(P)){const z=parseInt(P);if(0<=z&&z<256)if(Q==="?")I.push({type:0,index:z});else{const X=(0,m.parseColor)(Q);X&&I.push({type:1,index:z,color:X})}}}return I.length&&this._onColor.fire(I),!0}setHyperlink(L){const I=L.split(";");return!(I.length<2)&&(I[1]?this._createHyperlink(I[0],I[1]):!I[0]&&this._finishHyperlink())}_createHyperlink(L,I){this._getCurrentLinkId()&&this._finishHyperlink();const O=L.split(":");let P;const Q=O.findIndex(z=>z.startsWith("id="));return Q!==-1&&(P=O[Q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:I}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,I){const O=L.split(";");for(let P=0;P<O.length&&!(I>=this._specialColors.length);++P,++I)if(O[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[I]}]);else{const Q=(0,m.parseColor)(O[P]);Q&&this._onColor.fire([{type:1,index:this._specialColors[I],color:Q}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const I=[],O=L.split(";");for(let P=0;P<O.length;++P)if(/^\d+$/.exec(O[P])){const Q=parseInt(O[P]);0<=Q&&Q<256&&I.push({type:2,index:Q})}return I.length&&this._onColor.fire(I),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(b[L[0]],d.CHARSETS[L[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new i.CellData;L.content=4194304|"E".charCodeAt(0),L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let I=0;I<this._bufferService.rows;++I){const O=this._activeBuffer.ybase+this._activeBuffer.y+I,P=this._activeBuffer.lines.get(O);P&&(P.fill(L),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,I){const O=this._bufferService.buffer,P=this._optionsService.rawOptions;return(Q=>(this._coreService.triggerDataEvent(`${u.C0.ESC}${Q}${u.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${O.scrollTop+1};${O.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,I){this._dirtyRowTracker.markRangeDirty(L,I)}}c.InputHandler=F;let D=class{constructor(H){this._bufferService=H,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(H){H<this.start?this.start=H:H>this.end&&(this.end=H)}markRangeDirty(H,L){H>L&&(B=H,H=L,L=B),H<this.start&&(this.start=H),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};D=g([f(0,p.IBufferService)],D)},844:($,c)=>{function y(g){for(const f of g)f.dispose();g.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const g of this._disposables)g.dispose();this._disposables.length=0}register(g){return this._disposables.push(g),g}unregister(g){const f=this._disposables.indexOf(g);f!==-1&&this._disposables.splice(f,1)}},c.toDisposable=function(g){return{dispose:g}},c.disposeArray=y,c.getDisposeArrayDisposable=function(g){return{dispose:()=>y(g)}}},1505:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class y{constructor(){this._data={}}set(f,u,d){this._data[f]||(this._data[f]={}),this._data[f][u]=d}get(f,u){return this._data[f]?this._data[f][u]:void 0}clear(){this._data={}}}c.TwoKeyMap=y,c.FourKeyMap=class{constructor(){this._data=new y}set(g,f,u,d,C){this._data.get(g,f)||this._data.set(g,f,new y),this._data.get(g,f).set(u,d,C)}get(g,f,u,d){var C;return(C=this._data.get(g,f))===null||C===void 0?void 0:C.get(u,d)}clear(){this._data.clear()}}},6114:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const y=c.isNode?"node":navigator.userAgent,g=c.isNode?"node":navigator.platform;c.isFirefox=y.includes("Firefox"),c.isLegacyEdge=y.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(y),c.getSafariVersion=function(){if(!c.isSafari)return 0;const f=y.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(g),c.isIpad=g==="iPad",c.isIphone=g==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(g),c.isLinux=g.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(y)},6106:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SortedList=void 0;let y=0;c.SortedList=class{constructor(g){this._getKey=g,this._array=[]}clear(){this._array.length=0}insert(g){this._array.length!==0?(y=this._search(this._getKey(g),0,this._array.length-1),this._array.splice(y,0,g)):this._array.push(g)}delete(g){if(this._array.length===0)return!1;const f=this._getKey(g);if(f===void 0||(y=this._search(f,0,this._array.length-1),y===-1)||this._getKey(this._array[y])!==f)return!1;do if(this._array[y]===g)return this._array.splice(y,1),!0;while(++y<this._array.length&&this._getKey(this._array[y])===f);return!1}*getKeyIterator(g){if(this._array.length!==0&&(y=this._search(g,0,this._array.length-1),!(y<0||y>=this._array.length)&&this._getKey(this._array[y])===g))do yield this._array[y];while(++y<this._array.length&&this._getKey(this._array[y])===g)}forEachByKey(g,f){if(this._array.length!==0&&(y=this._search(g,0,this._array.length-1),!(y<0||y>=this._array.length)&&this._getKey(this._array[y])===g))do f(this._array[y]);while(++y<this._array.length&&this._getKey(this._array[y])===g)}values(){return this._array.values()}_search(g,f,u){if(u<f)return f;let d=Math.floor((f+u)/2);const C=this._getKey(this._array[d]);if(C>g)return this._search(g,f,d-1);if(C<g)return this._search(g,d+1,u);for(;d>0&&this._getKey(this._array[d-1])===g;)d--;return d}}},7226:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const g=y(6114);class f{constructor(){this._tasks=[],this._i=0}enqueue(C){this._tasks.push(C),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(C){this._idleCallback=void 0;let _=0,o=0,t=C.timeRemaining(),l=0;for(;this._i<this._tasks.length;){if(_=Date.now(),this._tasks[this._i]()||this._i++,_=Math.max(1,Date.now()-_),o=Math.max(_,o),l=C.timeRemaining(),1.5*o>l)return t-_<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-_))}ms`),void this._start();t=l}this.clear()}}class u extends f{_requestCallback(C){return setTimeout(()=>C(this._createDeadline(16)))}_cancelCallback(C){clearTimeout(C)}_createDeadline(C){const _=Date.now()+C;return{timeRemaining:()=>Math.max(0,_-Date.now())}}}c.PriorityTaskQueue=u,c.IdleTaskQueue=!g.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:u,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.updateWindowsModeWrappedState=void 0;const g=y(643);c.updateWindowsModeWrappedState=function(f){const u=f.buffer.lines.get(f.buffer.ybase+f.buffer.y-1),d=u==null?void 0:u.get(f.cols-1),C=f.buffer.lines.get(f.buffer.ybase+f.buffer.y);C&&d&&(C.isWrapped=d[g.CHAR_DATA_CODE_INDEX]!==g.NULL_CELL_CODE&&d[g.CHAR_DATA_CODE_INDEX]!==g.WHITESPACE_CELL_CODE)}},3734:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class y{constructor(){this.fg=0,this.bg=0,this.extended=new g}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new y;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=y;class g{constructor(u=0,d=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=d}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}clone(){return new g(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=g},9092:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Buffer=c.MAX_BUFFER_SIZE=void 0;const g=y(6349),f=y(8437),u=y(511),d=y(643),C=y(4634),_=y(4863),o=y(7116),t=y(3734),l=y(7226);c.MAX_BUFFER_SIZE=4294967295,c.Buffer=class{constructor(s,i,h){this._hasScrollback=s,this._optionsService=i,this._bufferService=h,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=f.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=u.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]),this._whitespaceCell=u.CellData.fromCharData([0,d.WHITESPACE_CELL_CHAR,d.WHITESPACE_CELL_WIDTH,d.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new l.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new g.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(s){return s?(this._nullCell.fg=s.fg,this._nullCell.bg=s.bg,this._nullCell.extended=s.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new t.ExtendedAttrs),this._nullCell}getWhitespaceCell(s){return s?(this._whitespaceCell.fg=s.fg,this._whitespaceCell.bg=s.bg,this._whitespaceCell.extended=s.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new t.ExtendedAttrs),this._whitespaceCell}getBlankLine(s,i){return new f.BufferLine(this._bufferService.cols,this.getNullCell(s),i)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const s=this.ybase+this.y-this.ydisp;return s>=0&&s<this._rows}_getCorrectBufferLength(s){if(!this._hasScrollback)return s;const i=s+this._optionsService.rawOptions.scrollback;return i>c.MAX_BUFFER_SIZE?c.MAX_BUFFER_SIZE:i}fillViewportRows(s){if(this.lines.length===0){s===void 0&&(s=f.DEFAULT_ATTR_DATA);let i=this._rows;for(;i--;)this.lines.push(this.getBlankLine(s))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new g.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(s,i){const h=this.getNullCell(f.DEFAULT_ATTR_DATA);let p=0;const v=this._getCorrectBufferLength(i);if(v>this.lines.maxLength&&(this.lines.maxLength=v),this.lines.length>0){if(this._cols<s)for(let m=0;m<this.lines.length;m++)p+=+this.lines.get(m).resize(s,h);let w=0;if(this._rows<i)for(let m=this._rows;m<i;m++)this.lines.length<i+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new f.BufferLine(s,h)):this.ybase>0&&this.lines.length<=this.ybase+this.y+w+1?(this.ybase--,w++,this.ydisp>0&&this.ydisp--):this.lines.push(new f.BufferLine(s,h)));else for(let m=this._rows;m>i;m--)this.lines.length>i+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(v<this.lines.maxLength){const m=this.lines.length-v;m>0&&(this.lines.trimStart(m),this.ybase=Math.max(this.ybase-m,0),this.ydisp=Math.max(this.ydisp-m,0),this.savedY=Math.max(this.savedY-m,0)),this.lines.maxLength=v}this.x=Math.min(this.x,s-1),this.y=Math.min(this.y,i-1),w&&(this.y+=w),this.savedX=Math.min(this.savedX,s-1),this.scrollTop=0}if(this.scrollBottom=i-1,this._isReflowEnabled&&(this._reflow(s,i),this._cols>s))for(let w=0;w<this.lines.length;w++)p+=+this.lines.get(w).resize(s,h);this._cols=s,this._rows=i,this._memoryCleanupQueue.clear(),p>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let s=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,s=!1);let i=0;for(;this._memoryCleanupPosition<this.lines.length;)if(i+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),i>100)return!0;return s}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(s,i){this._cols!==s&&(s>this._cols?this._reflowLarger(s,i):this._reflowSmaller(s,i))}_reflowLarger(s,i){const h=(0,C.reflowLargerGetLinesToRemove)(this.lines,this._cols,s,this.ybase+this.y,this.getNullCell(f.DEFAULT_ATTR_DATA));if(h.length>0){const p=(0,C.reflowLargerCreateNewLayout)(this.lines,h);(0,C.reflowLargerApplyNewLayout)(this.lines,p.layout),this._reflowLargerAdjustViewport(s,i,p.countRemoved)}}_reflowLargerAdjustViewport(s,i,h){const p=this.getNullCell(f.DEFAULT_ATTR_DATA);let v=h;for(;v-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<i&&this.lines.push(new f.BufferLine(s,p))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-h,0)}_reflowSmaller(s,i){const h=this.getNullCell(f.DEFAULT_ATTR_DATA),p=[];let v=0;for(let w=this.lines.length-1;w>=0;w--){let m=this.lines.get(w);if(!m||!m.isWrapped&&m.getTrimmedLength()<=s)continue;const b=[m];for(;m.isWrapped&&w>0;)m=this.lines.get(--w),b.unshift(m);const E=this.ybase+this.y;if(E>=w&&E<w+b.length)continue;const A=b[b.length-1].getTrimmedLength(),T=(0,C.reflowSmallerGetNewLineLengths)(b,this._cols,s),B=T.length-b.length;let F;F=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const D=[];for(let Q=0;Q<B;Q++){const z=this.getBlankLine(f.DEFAULT_ATTR_DATA,!0);D.push(z)}D.length>0&&(p.push({start:w+b.length+v,newLines:D}),v+=D.length),b.push(...D);let H=T.length-1,L=T[H];L===0&&(H--,L=T[H]);let I=b.length-B-1,O=A;for(;I>=0;){const Q=Math.min(O,L);if(b[H]===void 0)break;if(b[H].copyCellsFrom(b[I],O-Q,L-Q,Q,!0),L-=Q,L===0&&(H--,L=T[H]),O-=Q,O===0){I--;const z=Math.max(I,0);O=(0,C.getWrappedLineTrimmedLength)(b,z,this._cols)}}for(let Q=0;Q<b.length;Q++)T[Q]<s&&b[Q].setCell(T[Q],h);let P=B-F;for(;P-- >0;)this.ybase===0?this.y<i-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+v)-i&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+i-1)}if(p.length>0){const w=[],m=[];for(let H=0;H<this.lines.length;H++)m.push(this.lines.get(H));const b=this.lines.length;let E=b-1,A=0,T=p[A];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+v);let B=0;for(let H=Math.min(this.lines.maxLength-1,b+v-1);H>=0;H--)if(T&&T.start>E+B){for(let L=T.newLines.length-1;L>=0;L--)this.lines.set(H--,T.newLines[L]);H++,w.push({index:E+1,amount:T.newLines.length}),B+=T.newLines.length,T=p[++A]}else this.lines.set(H,m[E--]);let F=0;for(let H=w.length-1;H>=0;H--)w[H].index+=F,this.lines.onInsertEmitter.fire(w[H]),F+=w[H].amount;const D=Math.max(0,b+v-this.lines.maxLength);D>0&&this.lines.onTrimEmitter.fire(D)}}translateBufferLineToString(s,i,h=0,p){const v=this.lines.get(s);return v?v.translateToString(i,h,p):""}getWrappedRangeForLine(s){let i=s,h=s;for(;i>0&&this.lines.get(i).isWrapped;)i--;for(;h+1<this.lines.length&&this.lines.get(h+1).isWrapped;)h++;return{first:i,last:h}}setupTabStops(s){for(s!=null?this.tabs[s]||(s=this.prevStop(s)):(this.tabs={},s=0);s<this._cols;s+=this._optionsService.rawOptions.tabStopWidth)this.tabs[s]=!0}prevStop(s){for(s==null&&(s=this.x);!this.tabs[--s]&&s>0;);return s>=this._cols?this._cols-1:s<0?0:s}nextStop(s){for(s==null&&(s=this.x);!this.tabs[++s]&&s<this._cols;);return s>=this._cols?this._cols-1:s<0?0:s}clearMarkers(s){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].line===s&&(this.markers[i].dispose(),this.markers.splice(i--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].dispose(),this.markers.splice(s--,1);this._isClearing=!1}addMarker(s){const i=new _.Marker(s);return this.markers.push(i),i.register(this.lines.onTrim(h=>{i.line-=h,i.line<0&&i.dispose()})),i.register(this.lines.onInsert(h=>{i.line>=h.index&&(i.line+=h.amount)})),i.register(this.lines.onDelete(h=>{i.line>=h.index&&i.line<h.index+h.amount&&i.dispose(),i.line>h.index&&(i.line-=h.amount)})),i.register(i.onDispose(()=>this._removeMarker(i))),i}_removeMarker(s){this._isClearing||this.markers.splice(this.markers.indexOf(s),1)}}},8437:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLine=c.DEFAULT_ATTR_DATA=void 0;const g=y(482),f=y(643),u=y(511),d=y(3734);c.DEFAULT_ATTR_DATA=Object.freeze(new d.AttributeData);let C=0;class _{constructor(t,l,s=!1){this.isWrapped=s,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const i=l||u.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]);for(let h=0;h<t;++h)this.setCell(h,i);this.length=t}get(t){const l=this._data[3*t+0],s=2097151&l;return[this._data[3*t+1],2097152&l?this._combined[t]:s?(0,g.stringFromCodePoint)(s):"",l>>22,2097152&l?this._combined[t].charCodeAt(this._combined[t].length-1):s]}set(t,l){this._data[3*t+1]=l[f.CHAR_DATA_ATTR_INDEX],l[f.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=l[1],this._data[3*t+0]=2097152|t|l[f.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=l[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|l[f.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const l=this._data[3*t+0];return 2097152&l?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&l}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const l=this._data[3*t+0];return 2097152&l?this._combined[t]:2097151&l?(0,g.stringFromCodePoint)(2097151&l):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,l){return C=3*t,l.content=this._data[C+0],l.fg=this._data[C+1],l.bg=this._data[C+2],2097152&l.content&&(l.combinedData=this._combined[t]),268435456&l.bg&&(l.extended=this._extendedAttrs[t]),l}setCell(t,l){2097152&l.content&&(this._combined[t]=l.combinedData),268435456&l.bg&&(this._extendedAttrs[t]=l.extended),this._data[3*t+0]=l.content,this._data[3*t+1]=l.fg,this._data[3*t+2]=l.bg}setCellFromCodePoint(t,l,s,i,h,p){268435456&h&&(this._extendedAttrs[t]=p),this._data[3*t+0]=l|s<<22,this._data[3*t+1]=i,this._data[3*t+2]=h}addCodepointToCell(t,l){let s=this._data[3*t+0];2097152&s?this._combined[t]+=(0,g.stringFromCodePoint)(l):(2097151&s?(this._combined[t]=(0,g.stringFromCodePoint)(2097151&s)+(0,g.stringFromCodePoint)(l),s&=-2097152,s|=2097152):s=l|4194304,this._data[3*t+0]=s)}insertCells(t,l,s,i){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs),l<this.length-t){const h=new u.CellData;for(let p=this.length-t-l-1;p>=0;--p)this.setCell(t+l+p,this.loadCell(t+p,h));for(let p=0;p<l;++p)this.setCell(t+p,s)}else for(let h=t;h<this.length;++h)this.setCell(h,s);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs)}deleteCells(t,l,s,i){if(t%=this.length,l<this.length-t){const h=new u.CellData;for(let p=0;p<this.length-t-l;++p)this.setCell(t+p,this.loadCell(t+l+p,h));for(let p=this.length-l;p<this.length;++p)this.setCell(p,s)}else for(let h=t;h<this.length;++h)this.setCell(h,s);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs)}replaceCells(t,l,s,i,h=!1){if(h)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs),l<this.length&&this.getWidth(l-1)===2&&!this.isProtected(l)&&this.setCellFromCodePoint(l,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs);t<l&&t<this.length;)this.isProtected(t)||this.setCell(t,s),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs),l<this.length&&this.getWidth(l-1)===2&&this.setCellFromCodePoint(l,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new d.ExtendedAttrs);t<l&&t<this.length;)this.setCell(t++,s)}resize(t,l){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const s=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*s)this._data=new Uint32Array(this._data.buffer,0,s);else{const i=new Uint32Array(s);i.set(this._data),this._data=i}for(let i=this.length;i<t;++i)this.setCell(i,l)}else{this._data=this._data.subarray(0,s);const i=Object.keys(this._combined);for(let p=0;p<i.length;p++){const v=parseInt(i[p],10);v>=t&&delete this._combined[v]}const h=Object.keys(this._extendedAttrs);for(let p=0;p<h.length;p++){const v=parseInt(h[p],10);v>=t&&delete this._extendedAttrs[v]}}return this.length=t,4*s*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,l=!1){if(l)for(let s=0;s<this.length;++s)this.isProtected(s)||this.setCell(s,t);else{this._combined={},this._extendedAttrs={};for(let s=0;s<this.length;++s)this.setCell(s,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const l in t._combined)this._combined[l]=t._combined[l];this._extendedAttrs={};for(const l in t._extendedAttrs)this._extendedAttrs[l]=t._extendedAttrs[l];this.isWrapped=t.isWrapped}clone(){const t=new _(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const l in this._combined)t._combined[l]=this._combined[l];for(const l in this._extendedAttrs)t._extendedAttrs[l]=this._extendedAttrs[l];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,l,s,i,h){const p=t._data;if(h)for(let w=i-1;w>=0;w--){for(let m=0;m<3;m++)this._data[3*(s+w)+m]=p[3*(l+w)+m];268435456&p[3*(l+w)+2]&&(this._extendedAttrs[s+w]=t._extendedAttrs[l+w])}else for(let w=0;w<i;w++){for(let m=0;m<3;m++)this._data[3*(s+w)+m]=p[3*(l+w)+m];268435456&p[3*(l+w)+2]&&(this._extendedAttrs[s+w]=t._extendedAttrs[l+w])}const v=Object.keys(t._combined);for(let w=0;w<v.length;w++){const m=parseInt(v[w],10);m>=l&&(this._combined[m-l+s]=t._combined[m])}}translateToString(t=!1,l=0,s=this.length){t&&(s=Math.min(s,this.getTrimmedLength()));let i="";for(;l<s;){const h=this._data[3*l+0],p=2097151&h;i+=2097152&h?this._combined[l]:p?(0,g.stringFromCodePoint)(p):f.WHITESPACE_CELL_CHAR,l+=h>>22||1}return i}}c.BufferLine=_},4841:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getRangeLength=void 0,c.getRangeLength=function(y,g){if(y.start.y>y.end.y)throw new Error(`Buffer range end (${y.end.x}, ${y.end.y}) cannot be before start (${y.start.x}, ${y.start.y})`);return g*(y.end.y-y.start.y)+(y.end.x-y.start.x+1)}},4634:($,c)=>{function y(g,f,u){if(f===g.length-1)return g[f].getTrimmedLength();const d=!g[f].hasContent(u-1)&&g[f].getWidth(u-1)===1,C=g[f+1].getWidth(0)===2;return d&&C?u-1:u}Object.defineProperty(c,"__esModule",{value:!0}),c.getWrappedLineTrimmedLength=c.reflowSmallerGetNewLineLengths=c.reflowLargerApplyNewLayout=c.reflowLargerCreateNewLayout=c.reflowLargerGetLinesToRemove=void 0,c.reflowLargerGetLinesToRemove=function(g,f,u,d,C){const _=[];for(let o=0;o<g.length-1;o++){let t=o,l=g.get(++t);if(!l.isWrapped)continue;const s=[g.get(o)];for(;t<g.length&&l.isWrapped;)s.push(l),l=g.get(++t);if(d>=o&&d<t){o+=s.length-1;continue}let i=0,h=y(s,i,f),p=1,v=0;for(;p<s.length;){const m=y(s,p,f),b=m-v,E=u-h,A=Math.min(b,E);s[i].copyCellsFrom(s[p],v,h,A,!1),h+=A,h===u&&(i++,h=0),v+=A,v===m&&(p++,v=0),h===0&&i!==0&&s[i-1].getWidth(u-1)===2&&(s[i].copyCellsFrom(s[i-1],u-1,h++,1,!1),s[i-1].setCell(u-1,C))}s[i].replaceCells(h,u,C);let w=0;for(let m=s.length-1;m>0&&(m>i||s[m].getTrimmedLength()===0);m--)w++;w>0&&(_.push(o+s.length-w),_.push(w)),o+=s.length-1}return _},c.reflowLargerCreateNewLayout=function(g,f){const u=[];let d=0,C=f[d],_=0;for(let o=0;o<g.length;o++)if(C===o){const t=f[++d];g.onDeleteEmitter.fire({index:o-_,amount:t}),o+=t-1,_+=t,C=f[++d]}else u.push(o);return{layout:u,countRemoved:_}},c.reflowLargerApplyNewLayout=function(g,f){const u=[];for(let d=0;d<f.length;d++)u.push(g.get(f[d]));for(let d=0;d<u.length;d++)g.set(d,u[d]);g.length=f.length},c.reflowSmallerGetNewLineLengths=function(g,f,u){const d=[],C=g.map((l,s)=>y(g,s,f)).reduce((l,s)=>l+s);let _=0,o=0,t=0;for(;t<C;){if(C-t<u){d.push(C-t);break}_+=u;const l=y(g,o,f);_>l&&(_-=l,o++);const s=g[o].getWidth(_-1)===2;s&&_--;const i=s?u-1:u;d.push(i),t+=i}return d},c.getWrappedLineTrimmedLength=y},5295:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferSet=void 0;const g=y(9092),f=y(8460),u=y(844);class d extends u.Disposable{constructor(_,o){super(),this._optionsService=_,this._bufferService=o,this._onBufferActivate=this.register(new f.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new g.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new g.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(_){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(_),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(_,o){this._normal.resize(_,o),this._alt.resize(_,o),this.setupTabStops(_)}setupTabStops(_){this._normal.setupTabStops(_),this._alt.setupTabStops(_)}}c.BufferSet=d},511:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const g=y(482),f=y(643),u=y(3734);class d extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(_){const o=new d;return o.setFromCharData(_),o}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,g.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(_){this.fg=_[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let o=!1;if(_[f.CHAR_DATA_CHAR_INDEX].length>2)o=!0;else if(_[f.CHAR_DATA_CHAR_INDEX].length===2){const t=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const l=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=l&&l<=57343?this.content=1024*(t-55296)+l-56320+65536|_[f.CHAR_DATA_WIDTH_INDEX]<<22:o=!0}else o=!0}else this.content=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|_[f.CHAR_DATA_WIDTH_INDEX]<<22;o&&(this.combinedData=_[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|_[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=d},643:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},4863:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Marker=void 0;const g=y(8460),f=y(844);class u{constructor(C){this.line=C,this.isDisposed=!1,this._disposables=[],this._id=u._nextId++,this._onDispose=this.register(new g.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,f.disposeArray)(this._disposables),this._disposables.length=0)}register(C){return this._disposables.push(C),C}}c.Marker=u,u._nextId=1},7116:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_CHARSET=c.CHARSETS=void 0,c.CHARSETS={},c.DEFAULT_CHARSET=c.CHARSETS.B,c.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},c.CHARSETS.A={"#":""},c.CHARSETS.B=void 0,c.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},c.CHARSETS.C=c.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.E=c.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},c.CHARSETS.H=c.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:($,c)=>{var y,g;Object.defineProperty(c,"__esModule",{value:!0}),c.C1_ESCAPED=c.C1=c.C0=void 0,function(f){f.NUL="\0",f.SOH="",f.STX="",f.ETX="",f.EOT="",f.ENQ="",f.ACK="",f.BEL="\x07",f.BS="\b",f.HT="	",f.LF=`
`,f.VT="\v",f.FF="\f",f.CR="\r",f.SO="",f.SI="",f.DLE="",f.DC1="",f.DC2="",f.DC3="",f.DC4="",f.NAK="",f.SYN="",f.ETB="",f.CAN="",f.EM="",f.SUB="",f.ESC="\x1B",f.FS="",f.GS="",f.RS="",f.US="",f.SP=" ",f.DEL=""}(y=c.C0||(c.C0={})),(g=c.C1||(c.C1={})).PAD="",g.HOP="",g.BPH="",g.NBH="",g.IND="",g.NEL="",g.SSA="",g.ESA="",g.HTS="",g.HTJ="",g.VTS="",g.PLD="",g.PLU="",g.RI="",g.SS2="",g.SS3="",g.DCS="",g.PU1="",g.PU2="",g.STS="",g.CCH="",g.MW="",g.SPA="",g.EPA="",g.SOS="",g.SGCI="",g.SCI="",g.CSI="",g.ST="",g.OSC="",g.PM="",g.APC="",(c.C1_ESCAPED||(c.C1_ESCAPED={})).ST=`${y.ESC}\\`},7399:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.evaluateKeyboardEvent=void 0;const g=y(2584),f={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};c.evaluateKeyboardEvent=function(u,d,C,_){const o={type:0,cancel:!1,key:void 0},t=(u.shiftKey?1:0)|(u.altKey?2:0)|(u.ctrlKey?4:0)|(u.metaKey?8:0);switch(u.keyCode){case 0:u.key==="UIKeyInputUpArrow"?o.key=d?g.C0.ESC+"OA":g.C0.ESC+"[A":u.key==="UIKeyInputLeftArrow"?o.key=d?g.C0.ESC+"OD":g.C0.ESC+"[D":u.key==="UIKeyInputRightArrow"?o.key=d?g.C0.ESC+"OC":g.C0.ESC+"[C":u.key==="UIKeyInputDownArrow"&&(o.key=d?g.C0.ESC+"OB":g.C0.ESC+"[B");break;case 8:if(u.altKey){o.key=g.C0.ESC+g.C0.DEL;break}o.key=g.C0.DEL;break;case 9:if(u.shiftKey){o.key=g.C0.ESC+"[Z";break}o.key=g.C0.HT,o.cancel=!0;break;case 13:o.key=u.altKey?g.C0.ESC+g.C0.CR:g.C0.CR,o.cancel=!0;break;case 27:o.key=g.C0.ESC,u.altKey&&(o.key=g.C0.ESC+g.C0.ESC),o.cancel=!0;break;case 37:if(u.metaKey)break;t?(o.key=g.C0.ESC+"[1;"+(t+1)+"D",o.key===g.C0.ESC+"[1;3D"&&(o.key=g.C0.ESC+(C?"b":"[1;5D"))):o.key=d?g.C0.ESC+"OD":g.C0.ESC+"[D";break;case 39:if(u.metaKey)break;t?(o.key=g.C0.ESC+"[1;"+(t+1)+"C",o.key===g.C0.ESC+"[1;3C"&&(o.key=g.C0.ESC+(C?"f":"[1;5C"))):o.key=d?g.C0.ESC+"OC":g.C0.ESC+"[C";break;case 38:if(u.metaKey)break;t?(o.key=g.C0.ESC+"[1;"+(t+1)+"A",C||o.key!==g.C0.ESC+"[1;3A"||(o.key=g.C0.ESC+"[1;5A")):o.key=d?g.C0.ESC+"OA":g.C0.ESC+"[A";break;case 40:if(u.metaKey)break;t?(o.key=g.C0.ESC+"[1;"+(t+1)+"B",C||o.key!==g.C0.ESC+"[1;3B"||(o.key=g.C0.ESC+"[1;5B")):o.key=d?g.C0.ESC+"OB":g.C0.ESC+"[B";break;case 45:u.shiftKey||u.ctrlKey||(o.key=g.C0.ESC+"[2~");break;case 46:o.key=t?g.C0.ESC+"[3;"+(t+1)+"~":g.C0.ESC+"[3~";break;case 36:o.key=t?g.C0.ESC+"[1;"+(t+1)+"H":d?g.C0.ESC+"OH":g.C0.ESC+"[H";break;case 35:o.key=t?g.C0.ESC+"[1;"+(t+1)+"F":d?g.C0.ESC+"OF":g.C0.ESC+"[F";break;case 33:u.shiftKey?o.type=2:u.ctrlKey?o.key=g.C0.ESC+"[5;"+(t+1)+"~":o.key=g.C0.ESC+"[5~";break;case 34:u.shiftKey?o.type=3:u.ctrlKey?o.key=g.C0.ESC+"[6;"+(t+1)+"~":o.key=g.C0.ESC+"[6~";break;case 112:o.key=t?g.C0.ESC+"[1;"+(t+1)+"P":g.C0.ESC+"OP";break;case 113:o.key=t?g.C0.ESC+"[1;"+(t+1)+"Q":g.C0.ESC+"OQ";break;case 114:o.key=t?g.C0.ESC+"[1;"+(t+1)+"R":g.C0.ESC+"OR";break;case 115:o.key=t?g.C0.ESC+"[1;"+(t+1)+"S":g.C0.ESC+"OS";break;case 116:o.key=t?g.C0.ESC+"[15;"+(t+1)+"~":g.C0.ESC+"[15~";break;case 117:o.key=t?g.C0.ESC+"[17;"+(t+1)+"~":g.C0.ESC+"[17~";break;case 118:o.key=t?g.C0.ESC+"[18;"+(t+1)+"~":g.C0.ESC+"[18~";break;case 119:o.key=t?g.C0.ESC+"[19;"+(t+1)+"~":g.C0.ESC+"[19~";break;case 120:o.key=t?g.C0.ESC+"[20;"+(t+1)+"~":g.C0.ESC+"[20~";break;case 121:o.key=t?g.C0.ESC+"[21;"+(t+1)+"~":g.C0.ESC+"[21~";break;case 122:o.key=t?g.C0.ESC+"[23;"+(t+1)+"~":g.C0.ESC+"[23~";break;case 123:o.key=t?g.C0.ESC+"[24;"+(t+1)+"~":g.C0.ESC+"[24~";break;default:if(!u.ctrlKey||u.shiftKey||u.altKey||u.metaKey)if(C&&!_||!u.altKey||u.metaKey)!C||u.altKey||u.ctrlKey||u.shiftKey||!u.metaKey?u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.keyCode>=48&&u.key.length===1?o.key=u.key:u.key&&u.ctrlKey&&(u.key==="_"&&(o.key=g.C0.US),u.key==="@"&&(o.key=g.C0.NUL)):u.keyCode===65&&(o.type=1);else{const l=f[u.keyCode],s=l==null?void 0:l[u.shiftKey?1:0];if(s)o.key=g.C0.ESC+s;else if(u.keyCode>=65&&u.keyCode<=90){const i=u.ctrlKey?u.keyCode-64:u.keyCode+32;let h=String.fromCharCode(i);u.shiftKey&&(h=h.toUpperCase()),o.key=g.C0.ESC+h}else if(u.keyCode===32)o.key=g.C0.ESC+(u.ctrlKey?g.C0.NUL:" ");else if(u.key==="Dead"&&u.code.startsWith("Key")){let i=u.code.slice(3,4);u.shiftKey||(i=i.toLowerCase()),o.key=g.C0.ESC+i,o.cancel=!0}}else u.keyCode>=65&&u.keyCode<=90?o.key=String.fromCharCode(u.keyCode-64):u.keyCode===32?o.key=g.C0.NUL:u.keyCode>=51&&u.keyCode<=55?o.key=String.fromCharCode(u.keyCode-51+27):u.keyCode===56?o.key=g.C0.DEL:u.keyCode===219?o.key=g.C0.ESC:u.keyCode===220?o.key=g.C0.FS:u.keyCode===221&&(o.key=g.C0.GS)}return o}},482:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(y){return y>65535?(y-=65536,String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):String.fromCharCode(y)},c.utf32ToString=function(y,g=0,f=y.length){let u="";for(let d=g;d<f;++d){let C=y[d];C>65535?(C-=65536,u+=String.fromCharCode(55296+(C>>10))+String.fromCharCode(C%1024+56320)):u+=String.fromCharCode(C)}return u},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(y,g){const f=y.length;if(!f)return 0;let u=0,d=0;if(this._interim){const C=y.charCodeAt(d++);56320<=C&&C<=57343?g[u++]=1024*(this._interim-55296)+C-56320+65536:(g[u++]=this._interim,g[u++]=C),this._interim=0}for(let C=d;C<f;++C){const _=y.charCodeAt(C);if(55296<=_&&_<=56319){if(++C>=f)return this._interim=_,u;const o=y.charCodeAt(C);56320<=o&&o<=57343?g[u++]=1024*(_-55296)+o-56320+65536:(g[u++]=_,g[u++]=o)}else _!==65279&&(g[u++]=_)}return u}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(y,g){const f=y.length;if(!f)return 0;let u,d,C,_,o=0,t=0,l=0;if(this.interim[0]){let h=!1,p=this.interim[0];p&=(224&p)==192?31:(240&p)==224?15:7;let v,w=0;for(;(v=63&this.interim[++w])&&w<4;)p<<=6,p|=v;const m=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,b=m-w;for(;l<b;){if(l>=f)return 0;if(v=y[l++],(192&v)!=128){l--,h=!0;break}this.interim[w++]=v,p<<=6,p|=63&v}h||(m===2?p<128?l--:g[o++]=p:m===3?p<2048||p>=55296&&p<=57343||p===65279||(g[o++]=p):p<65536||p>1114111||(g[o++]=p)),this.interim.fill(0)}const s=f-4;let i=l;for(;i<f;){for(;!(!(i<s)||128&(u=y[i])||128&(d=y[i+1])||128&(C=y[i+2])||128&(_=y[i+3]));)g[o++]=u,g[o++]=d,g[o++]=C,g[o++]=_,i+=4;if(u=y[i++],u<128)g[o++]=u;else if((224&u)==192){if(i>=f)return this.interim[0]=u,o;if(d=y[i++],(192&d)!=128){i--;continue}if(t=(31&u)<<6|63&d,t<128){i--;continue}g[o++]=t}else if((240&u)==224){if(i>=f)return this.interim[0]=u,o;if(d=y[i++],(192&d)!=128){i--;continue}if(i>=f)return this.interim[0]=u,this.interim[1]=d,o;if(C=y[i++],(192&C)!=128){i--;continue}if(t=(15&u)<<12|(63&d)<<6|63&C,t<2048||t>=55296&&t<=57343||t===65279)continue;g[o++]=t}else if((248&u)==240){if(i>=f)return this.interim[0]=u,o;if(d=y[i++],(192&d)!=128){i--;continue}if(i>=f)return this.interim[0]=u,this.interim[1]=d,o;if(C=y[i++],(192&C)!=128){i--;continue}if(i>=f)return this.interim[0]=u,this.interim[1]=d,this.interim[2]=C,o;if(_=y[i++],(192&_)!=128){i--;continue}if(t=(7&u)<<18|(63&d)<<12|(63&C)<<6|63&_,t<65536||t>1114111)continue;g[o++]=t}}return o}}},225:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeV6=void 0;const y=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],g=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let f;c.UnicodeV6=class{constructor(){if(this.version="6",!f){f=new Uint8Array(65536),f.fill(1),f[0]=0,f.fill(0,1,32),f.fill(0,127,160),f.fill(2,4352,4448),f[9001]=2,f[9002]=2,f.fill(2,11904,42192),f[12351]=1,f.fill(2,44032,55204),f.fill(2,63744,64256),f.fill(2,65040,65050),f.fill(2,65072,65136),f.fill(2,65280,65377),f.fill(2,65504,65511);for(let u=0;u<y.length;++u)f.fill(0,y[u][0],y[u][1]+1)}}wcwidth(u){return u<32?0:u<127?1:u<65536?f[u]:function(d,C){let _,o=0,t=C.length-1;if(d<C[0][0]||d>C[t][1])return!1;for(;t>=o;)if(_=o+t>>1,d>C[_][1])o=_+1;else{if(!(d<C[_][0]))return!0;t=_-1}return!1}(u,g)?0:u>=131072&&u<=196605||u>=196608&&u<=262141?2:1}}},5981:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WriteBuffer=void 0;const g=y(8460),f=y(844);class u extends f.Disposable{constructor(C){super(),this._action=C,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new g.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(C,_){if(_!==void 0&&this._syncCalls>_)return void(this._syncCalls=0);if(this._pendingData+=C.length,this._writeBuffer.push(C),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let o;for(this._isSyncWriting=!0;o=this._writeBuffer.shift();){this._action(o);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(C,_){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=C.length,this._writeBuffer.push(C),this._callbacks.push(_),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=C.length,this._writeBuffer.push(C),this._callbacks.push(_)}_innerWrite(C=0,_=!0){const o=C||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],l=this._action(t,_);if(l){const i=h=>Date.now()-o>=12?setTimeout(()=>this._innerWrite(0,h)):this._innerWrite(o,h);return void l.catch(h=>(queueMicrotask(()=>{throw h}),Promise.resolve(!1))).then(i)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-o>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}c.WriteBuffer=u},5941:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.toRgbString=c.parseColor=void 0;const y=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,g=/^[\da-f]+$/;function f(u,d){const C=u.toString(16),_=C.length<2?"0"+C:C;switch(d){case 4:return C[0];case 8:return _;case 12:return(_+_).slice(0,3);default:return _+_}}c.parseColor=function(u){if(!u)return;let d=u.toLowerCase();if(d.indexOf("rgb:")===0){d=d.slice(4);const C=y.exec(d);if(C){const _=C[1]?15:C[4]?255:C[7]?4095:65535;return[Math.round(parseInt(C[1]||C[4]||C[7]||C[10],16)/_*255),Math.round(parseInt(C[2]||C[5]||C[8]||C[11],16)/_*255),Math.round(parseInt(C[3]||C[6]||C[9]||C[12],16)/_*255)]}}else if(d.indexOf("#")===0&&(d=d.slice(1),g.exec(d)&&[3,6,9,12].includes(d.length))){const C=d.length/3,_=[0,0,0];for(let o=0;o<3;++o){const t=parseInt(d.slice(C*o,C*o+C),16);_[o]=C===1?t<<4:C===2?t:C===3?t>>4:t>>8}return _}},c.toRgbString=function(u,d=16){const[C,_,o]=u;return`rgb:${f(C,d)}/${f(_,d)}/${f(o,d)}`}},5770:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PAYLOAD_LIMIT=void 0,c.PAYLOAD_LIMIT=1e7},6351:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DcsHandler=c.DcsParser=void 0;const g=y(482),f=y(8742),u=y(5770),d=[];c.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(_,o){this._handlers[_]===void 0&&(this._handlers[_]=[]);const t=this._handlers[_];return t.push(o),{dispose:()=>{const l=t.indexOf(o);l!==-1&&t.splice(l,1)}}}clearHandler(_){this._handlers[_]&&delete this._handlers[_]}setHandlerFallback(_){this._handlerFb=_}reset(){if(this._active.length)for(let _=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;_>=0;--_)this._active[_].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(_,o){if(this.reset(),this._ident=_,this._active=this._handlers[_]||d,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(o);else this._handlerFb(this._ident,"HOOK",o)}put(_,o,t){if(this._active.length)for(let l=this._active.length-1;l>=0;l--)this._active[l].put(_,o,t);else this._handlerFb(this._ident,"PUT",(0,g.utf32ToString)(_,o,t))}unhook(_,o=!0){if(this._active.length){let t=!1,l=this._active.length-1,s=!1;if(this._stack.paused&&(l=this._stack.loopPosition-1,t=o,s=this._stack.fallThrough,this._stack.paused=!1),!s&&t===!1){for(;l>=0&&(t=this._active[l].unhook(_),t!==!0);l--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!1,t;l--}for(;l>=0;l--)if(t=this._active[l].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=l,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",_);this._active=d,this._ident=0}};const C=new f.Params;C.addParam(0),c.DcsHandler=class{constructor(_){this._handler=_,this._data="",this._params=C,this._hitLimit=!1}hook(_){this._params=_.length>1||_.params[0]?_.clone():C,this._data="",this._hitLimit=!1}put(_,o,t){this._hitLimit||(this._data+=(0,g.utf32ToString)(_,o,t),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(_){let o=!1;if(this._hitLimit)o=!1;else if(_&&(o=this._handler(this._data,this._params),o instanceof Promise))return o.then(t=>(this._params=C,this._data="",this._hitLimit=!1,t));return this._params=C,this._data="",this._hitLimit=!1,o}}},2015:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EscapeSequenceParser=c.VT500_TRANSITION_TABLE=c.TransitionTable=void 0;const g=y(844),f=y(8742),u=y(6242),d=y(6351);class C{constructor(l){this.table=new Uint8Array(l)}setDefault(l,s){this.table.fill(l<<4|s)}add(l,s,i,h){this.table[s<<8|l]=i<<4|h}addMany(l,s,i,h){for(let p=0;p<l.length;p++)this.table[s<<8|l[p]]=i<<4|h}}c.TransitionTable=C;const _=160;c.VT500_TRANSITION_TABLE=function(){const t=new C(4095),l=Array.apply(null,Array(256)).map((w,m)=>m),s=(w,m)=>l.slice(w,m),i=s(32,127),h=s(0,24);h.push(25),h.push.apply(h,s(28,32));const p=s(0,14);let v;for(v in t.setDefault(1,0),t.addMany(i,0,2,0),p)t.addMany([24,26,153,154],v,3,0),t.addMany(s(128,144),v,3,0),t.addMany(s(144,152),v,3,0),t.add(156,v,0,0),t.add(27,v,11,1),t.add(157,v,4,8),t.addMany([152,158,159],v,0,7),t.add(155,v,11,3),t.add(144,v,11,9);return t.addMany(h,0,3,0),t.addMany(h,1,3,1),t.add(127,1,0,1),t.addMany(h,8,0,8),t.addMany(h,3,3,3),t.add(127,3,0,3),t.addMany(h,4,3,4),t.add(127,4,0,4),t.addMany(h,6,3,6),t.addMany(h,5,3,5),t.add(127,5,0,5),t.addMany(h,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(i,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(s(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(i,7,0,7),t.addMany(h,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(s(64,127),3,7,0),t.addMany(s(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(s(48,60),4,8,4),t.addMany(s(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(s(32,64),6,0,6),t.add(127,6,0,6),t.addMany(s(64,127),6,0,0),t.addMany(s(32,48),3,9,5),t.addMany(s(32,48),5,9,5),t.addMany(s(48,64),5,0,6),t.addMany(s(64,127),5,7,0),t.addMany(s(32,48),4,9,5),t.addMany(s(32,48),1,9,2),t.addMany(s(32,48),2,9,2),t.addMany(s(48,127),2,10,0),t.addMany(s(48,80),1,10,0),t.addMany(s(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(s(96,127),1,10,0),t.add(80,1,11,9),t.addMany(h,9,0,9),t.add(127,9,0,9),t.addMany(s(28,32),9,0,9),t.addMany(s(32,48),9,9,12),t.addMany(s(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(h,11,0,11),t.addMany(s(32,128),11,0,11),t.addMany(s(28,32),11,0,11),t.addMany(h,10,0,10),t.add(127,10,0,10),t.addMany(s(28,32),10,0,10),t.addMany(s(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(s(32,48),10,9,12),t.addMany(h,12,0,12),t.add(127,12,0,12),t.addMany(s(28,32),12,0,12),t.addMany(s(32,48),12,9,12),t.addMany(s(48,64),12,0,11),t.addMany(s(64,127),12,12,13),t.addMany(s(64,127),10,12,13),t.addMany(s(64,127),9,12,13),t.addMany(h,13,13,13),t.addMany(i,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(_,0,2,0),t.add(_,8,5,8),t.add(_,6,0,6),t.add(_,11,0,11),t.add(_,13,13,13),t}();class o extends g.Disposable{constructor(l=c.VT500_TRANSITION_TABLE){super(),this._transitions=l,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new f.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(s,i,h)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,i)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,g.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new u.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(l,s=[64,126]){let i=0;if(l.prefix){if(l.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=l.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(l.intermediates){if(l.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let p=0;p<l.intermediates.length;++p){const v=l.intermediates.charCodeAt(p);if(32>v||v>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=v}}if(l.final.length!==1)throw new Error("final must be a single byte");const h=l.final.charCodeAt(0);if(s[0]>h||h>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return i<<=8,i|=h,i}identToString(l){const s=[];for(;l;)s.push(String.fromCharCode(255&l)),l>>=8;return s.reverse().join("")}setPrintHandler(l){this._printHandler=l}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(l,s){const i=this._identifier(l,[48,126]);this._escHandlers[i]===void 0&&(this._escHandlers[i]=[]);const h=this._escHandlers[i];return h.push(s),{dispose:()=>{const p=h.indexOf(s);p!==-1&&h.splice(p,1)}}}clearEscHandler(l){this._escHandlers[this._identifier(l,[48,126])]&&delete this._escHandlers[this._identifier(l,[48,126])]}setEscHandlerFallback(l){this._escHandlerFb=l}setExecuteHandler(l,s){this._executeHandlers[l.charCodeAt(0)]=s}clearExecuteHandler(l){this._executeHandlers[l.charCodeAt(0)]&&delete this._executeHandlers[l.charCodeAt(0)]}setExecuteHandlerFallback(l){this._executeHandlerFb=l}registerCsiHandler(l,s){const i=this._identifier(l);this._csiHandlers[i]===void 0&&(this._csiHandlers[i]=[]);const h=this._csiHandlers[i];return h.push(s),{dispose:()=>{const p=h.indexOf(s);p!==-1&&h.splice(p,1)}}}clearCsiHandler(l){this._csiHandlers[this._identifier(l)]&&delete this._csiHandlers[this._identifier(l)]}setCsiHandlerFallback(l){this._csiHandlerFb=l}registerDcsHandler(l,s){return this._dcsParser.registerHandler(this._identifier(l),s)}clearDcsHandler(l){this._dcsParser.clearHandler(this._identifier(l))}setDcsHandlerFallback(l){this._dcsParser.setHandlerFallback(l)}registerOscHandler(l,s){return this._oscParser.registerHandler(l,s)}clearOscHandler(l){this._oscParser.clearHandler(l)}setOscHandlerFallback(l){this._oscParser.setHandlerFallback(l)}setErrorHandler(l){this._errorHandler=l}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(l,s,i,h,p){this._parseStack.state=l,this._parseStack.handlers=s,this._parseStack.handlerPos=i,this._parseStack.transition=h,this._parseStack.chunkPos=p}parse(l,s,i){let h,p=0,v=0,w=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,w=this._parseStack.chunkPos+1;else{if(i===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const m=this._parseStack.handlers;let b=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(i===!1&&b>-1){for(;b>=0&&(h=m[b](this._params),h!==!0);b--)if(h instanceof Promise)return this._parseStack.handlerPos=b,h}this._parseStack.handlers=[];break;case 4:if(i===!1&&b>-1){for(;b>=0&&(h=m[b](),h!==!0);b--)if(h instanceof Promise)return this._parseStack.handlerPos=b,h}this._parseStack.handlers=[];break;case 6:if(p=l[this._parseStack.chunkPos],h=this._dcsParser.unhook(p!==24&&p!==26,i),h)return h;p===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(p=l[this._parseStack.chunkPos],h=this._oscParser.end(p!==24&&p!==26,i),h)return h;p===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,w=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let m=w;m<s;++m){switch(p=l[m],v=this._transitions.table[this.currentState<<8|(p<160?p:_)],v>>4){case 2:for(let B=m+1;;++B){if(B>=s||(p=l[B])<32||p>126&&p<_){this._printHandler(l,m,B),m=B-1;break}if(++B>=s||(p=l[B])<32||p>126&&p<_){this._printHandler(l,m,B),m=B-1;break}if(++B>=s||(p=l[B])<32||p>126&&p<_){this._printHandler(l,m,B),m=B-1;break}if(++B>=s||(p=l[B])<32||p>126&&p<_){this._printHandler(l,m,B),m=B-1;break}}break;case 3:this._executeHandlers[p]?this._executeHandlers[p]():this._executeHandlerFb(p),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:m,code:p,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const b=this._csiHandlers[this._collect<<8|p];let E=b?b.length-1:-1;for(;E>=0&&(h=b[E](this._params),h!==!0);E--)if(h instanceof Promise)return this._preserveStack(3,b,E,v,m),h;E<0&&this._csiHandlerFb(this._collect<<8|p,this._params),this.precedingCodepoint=0;break;case 8:do switch(p){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(p-48)}while(++m<s&&(p=l[m])>47&&p<60);m--;break;case 9:this._collect<<=8,this._collect|=p;break;case 10:const A=this._escHandlers[this._collect<<8|p];let T=A?A.length-1:-1;for(;T>=0&&(h=A[T](),h!==!0);T--)if(h instanceof Promise)return this._preserveStack(4,A,T,v,m),h;T<0&&this._escHandlerFb(this._collect<<8|p),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|p,this._params);break;case 13:for(let B=m+1;;++B)if(B>=s||(p=l[B])===24||p===26||p===27||p>127&&p<_){this._dcsParser.put(l,m,B),m=B-1;break}break;case 14:if(h=this._dcsParser.unhook(p!==24&&p!==26),h)return this._preserveStack(6,[],0,v,m),h;p===27&&(v|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let B=m+1;;B++)if(B>=s||(p=l[B])<32||p>127&&p<_){this._oscParser.put(l,m,B),m=B-1;break}break;case 6:if(h=this._oscParser.end(p!==24&&p!==26),h)return this._preserveStack(5,[],0,v,m),h;p===27&&(v|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&v}}}c.EscapeSequenceParser=o},6242:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OscHandler=c.OscParser=void 0;const g=y(5770),f=y(482),u=[];c.OscParser=class{constructor(){this._state=0,this._active=u,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,C){this._handlers[d]===void 0&&(this._handlers[d]=[]);const _=this._handlers[d];return _.push(C),{dispose:()=>{const o=_.indexOf(C);o!==-1&&_.splice(o,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}reset(){if(this._state===2)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=u,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||u,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,C,_){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(d,C,_);else this._handlerFb(this._id,"PUT",(0,f.utf32ToString)(d,C,_))}start(){this.reset(),this._state=1}put(d,C,_){if(this._state!==3){if(this._state===1)for(;C<_;){const o=d[C++];if(o===59){this._state=2,this._start();break}if(o<48||57<o)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+o-48}this._state===2&&_-C>0&&this._put(d,C,_)}}end(d,C=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let _=!1,o=this._active.length-1,t=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,_=C,t=this._stack.fallThrough,this._stack.paused=!1),!t&&_===!1){for(;o>=0&&(_=this._active[o].end(d),_!==!0);o--)if(_ instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,_;o--}for(;o>=0;o--)if(_=this._active[o].end(!1),_ instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,_}else this._handlerFb(this._id,"END",d);this._active=u,this._id=-1,this._state=0}}},c.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,C,_){this._hitLimit||(this._data+=(0,f.utf32ToString)(d,C,_),this._data.length>g.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let C=!1;if(this._hitLimit)C=!1;else if(d&&(C=this._handler(this._data),C instanceof Promise))return C.then(_=>(this._data="",this._hitLimit=!1,_));return this._data="",this._hitLimit=!1,C}}},8742:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Params=void 0;const y=2147483647;class g{constructor(u=32,d=32){if(this.maxLength=u,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(u),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(u),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(u){const d=new g;if(!u.length)return d;for(let C=Array.isArray(u[0])?1:0;C<u.length;++C){const _=u[C];if(Array.isArray(_))for(let o=0;o<_.length;++o)d.addSubParam(_[o]);else d.addParam(_)}return d}clone(){const u=new g(this.maxLength,this.maxSubParamsLength);return u.params.set(this.params),u.length=this.length,u._subParams.set(this._subParams),u._subParamsLength=this._subParamsLength,u._subParamsIdx.set(this._subParamsIdx),u._rejectDigits=this._rejectDigits,u._rejectSubDigits=this._rejectSubDigits,u._digitIsSub=this._digitIsSub,u}toArray(){const u=[];for(let d=0;d<this.length;++d){u.push(this.params[d]);const C=this._subParamsIdx[d]>>8,_=255&this._subParamsIdx[d];_-C>0&&u.push(Array.prototype.slice.call(this._subParams,C,_))}return u}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(u){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=u>y?y:u}}addSubParam(u){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=u>y?y:u,this._subParamsIdx[this.length-1]++}}hasSubParams(u){return(255&this._subParamsIdx[u])-(this._subParamsIdx[u]>>8)>0}getSubParams(u){const d=this._subParamsIdx[u]>>8,C=255&this._subParamsIdx[u];return C-d>0?this._subParams.subarray(d,C):null}getSubParamsAll(){const u={};for(let d=0;d<this.length;++d){const C=this._subParamsIdx[d]>>8,_=255&this._subParamsIdx[d];_-C>0&&(u[d]=this._subParams.slice(C,_))}return u}addDigit(u){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const C=this._digitIsSub?this._subParams:this.params,_=C[d-1];C[d-1]=~_?Math.min(10*_+u,y):u}}c.Params=g},5741:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AddonManager=void 0,c.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let y=this._addons.length-1;y>=0;y--)this._addons[y].instance.dispose()}loadAddon(y,g){const f={instance:g,dispose:g.dispose,isDisposed:!1};this._addons.push(f),g.dispose=()=>this._wrappedAddonDispose(f),g.activate(y)}_wrappedAddonDispose(y){if(y.isDisposed)return;let g=-1;for(let f=0;f<this._addons.length;f++)if(this._addons[f]===y){g=f;break}if(g===-1)throw new Error("Could not dispose an addon that has not been loaded");y.isDisposed=!0,y.dispose.apply(y.instance),this._addons.splice(g,1)}}},8771:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferApiView=void 0;const g=y(3785),f=y(511);c.BufferApiView=class{constructor(u,d){this._buffer=u,this.type=d}init(u){return this._buffer=u,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(u){const d=this._buffer.lines.get(u);if(d)return new g.BufferLineApiView(d)}getNullCell(){return new f.CellData}}},3785:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLineApiView=void 0;const g=y(511);c.BufferLineApiView=class{constructor(f){this._line=f}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(f,u){if(!(f<0||f>=this._line.length))return u?(this._line.loadCell(f,u),u):this._line.loadCell(f,new g.CellData)}translateToString(f,u,d){return this._line.translateToString(f,u,d)}}},8285:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferNamespaceApi=void 0;const g=y(8771),f=y(8460);c.BufferNamespaceApi=class{constructor(u){this._core=u,this._onBufferChange=new f.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new g.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new g.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ParserApi=void 0,c.ParserApi=class{constructor(y){this._core=y}registerCsiHandler(y,g){return this._core.registerCsiHandler(y,f=>g(f.toArray()))}addCsiHandler(y,g){return this.registerCsiHandler(y,g)}registerDcsHandler(y,g){return this._core.registerDcsHandler(y,(f,u)=>g(f,u.toArray()))}addDcsHandler(y,g){return this.registerDcsHandler(y,g)}registerEscHandler(y,g){return this._core.registerEscHandler(y,g)}addEscHandler(y,g){return this.registerEscHandler(y,g)}registerOscHandler(y,g){return this._core.registerOscHandler(y,g)}addOscHandler(y,g){return this.registerOscHandler(y,g)}}},7090:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeApi=void 0,c.UnicodeApi=class{constructor(y){this._core=y}register(y){this._core.unicodeService.register(y)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(y){this._core.unicodeService.activeVersion=y}}},744:function($,c,y){var g=this&&this.__decorate||function(t,l,s,i){var h,p=arguments.length,v=p<3?l:i===null?i=Object.getOwnPropertyDescriptor(l,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(t,l,s,i);else for(var w=t.length-1;w>=0;w--)(h=t[w])&&(v=(p<3?h(v):p>3?h(l,s,v):h(l,s))||v);return p>3&&v&&Object.defineProperty(l,s,v),v},f=this&&this.__param||function(t,l){return function(s,i){l(s,i,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferService=c.MINIMUM_ROWS=c.MINIMUM_COLS=void 0;const u=y(2585),d=y(5295),C=y(8460),_=y(844);c.MINIMUM_COLS=2,c.MINIMUM_ROWS=1;let o=class extends _.Disposable{constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new C.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new C.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,c.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,c.MINIMUM_ROWS),this.buffers=this.register(new d.BufferSet(t,this))}get buffer(){return this.buffers.active}resize(t,l){this.cols=t,this.rows=l,this.buffers.resize(t,l),this._onResize.fire({cols:t,rows:l})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,l=!1){const s=this.buffer;let i;i=this._cachedBlankLine,i&&i.length===this.cols&&i.getFg(0)===t.fg&&i.getBg(0)===t.bg||(i=s.getBlankLine(t,l),this._cachedBlankLine=i),i.isWrapped=l;const h=s.ybase+s.scrollTop,p=s.ybase+s.scrollBottom;if(s.scrollTop===0){const v=s.lines.isFull;p===s.lines.length-1?v?s.lines.recycle().copyFrom(i):s.lines.push(i.clone()):s.lines.splice(p+1,0,i.clone()),v?this.isUserScrolling&&(s.ydisp=Math.max(s.ydisp-1,0)):(s.ybase++,this.isUserScrolling||s.ydisp++)}else{const v=p-h+1;s.lines.shiftElements(h+1,v-1,-1),s.lines.set(p,i.clone())}this.isUserScrolling||(s.ydisp=s.ybase),this._onScroll.fire(s.ydisp)}scrollLines(t,l,s){const i=this.buffer;if(t<0){if(i.ydisp===0)return;this.isUserScrolling=!0}else t+i.ydisp>=i.ybase&&(this.isUserScrolling=!1);const h=i.ydisp;i.ydisp=Math.max(Math.min(i.ydisp+t,i.ybase),0),h!==i.ydisp&&(l||this._onScroll.fire(i.ydisp))}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(t){const l=t-this.buffer.ydisp;l!==0&&this.scrollLines(l)}};o=g([f(0,u.IOptionsService)],o),c.BufferService=o},7994:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CharsetService=void 0,c.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(y){this.glevel=y,this.charset=this._charsets[y]}setgCharset(y,g){this._charsets[y]=g,this.glevel===y&&(this.charset=g)}}},1753:function($,c,y){var g=this&&this.__decorate||function(i,h,p,v){var w,m=arguments.length,b=m<3?h:v===null?v=Object.getOwnPropertyDescriptor(h,p):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(i,h,p,v);else for(var E=i.length-1;E>=0;E--)(w=i[E])&&(b=(m<3?w(b):m>3?w(h,p,b):w(h,p))||b);return m>3&&b&&Object.defineProperty(h,p,b),b},f=this&&this.__param||function(i,h){return function(p,v){h(p,v,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreMouseService=void 0;const u=y(2585),d=y(8460),C=y(844),_={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:i=>i.button!==4&&i.action===1&&(i.ctrl=!1,i.alt=!1,i.shift=!1,!0)},VT200:{events:19,restrict:i=>i.action!==32},DRAG:{events:23,restrict:i=>i.action!==32||i.button!==3},ANY:{events:31,restrict:i=>!0}};function o(i,h){let p=(i.ctrl?16:0)|(i.shift?4:0)|(i.alt?8:0);return i.button===4?(p|=64,p|=i.action):(p|=3&i.button,4&i.button&&(p|=64),8&i.button&&(p|=128),i.action===32?p|=32:i.action!==0||h||(p|=3)),p}const t=String.fromCharCode,l={DEFAULT:i=>{const h=[o(i,!1)+32,i.col+32,i.row+32];return h[0]>255||h[1]>255||h[2]>255?"":`\x1B[M${t(h[0])}${t(h[1])}${t(h[2])}`},SGR:i=>{const h=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${o(i,!0)};${i.col};${i.row}${h}`},SGR_PIXELS:i=>{const h=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${o(i,!0)};${i.x};${i.y}${h}`}};let s=class extends C.Disposable{constructor(i,h){super(),this._bufferService=i,this._coreService=h,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const p of Object.keys(_))this.addProtocol(p,_[p]);for(const p of Object.keys(l))this.addEncoding(p,l[p]);this.reset()}addProtocol(i,h){this._protocols[i]=h}addEncoding(i,h){this._encodings[i]=h}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(i){if(!this._protocols[i])throw new Error(`unknown protocol "${i}"`);this._activeProtocol=i,this._onProtocolChange.fire(this._protocols[i].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(i){if(!this._encodings[i])throw new Error(`unknown encoding "${i}"`);this._activeEncoding=i}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(i){if(i.col<0||i.col>=this._bufferService.cols||i.row<0||i.row>=this._bufferService.rows||i.button===4&&i.action===32||i.button===3&&i.action!==32||i.button!==4&&(i.action===2||i.action===3)||(i.col++,i.row++,i.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,i,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(i))return!1;const h=this._encodings[this._activeEncoding](i);return h&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(h):this._coreService.triggerDataEvent(h,!0)),this._lastEvent=i,!0}explainEvents(i){return{down:!!(1&i),up:!!(2&i),drag:!!(4&i),move:!!(8&i),wheel:!!(16&i)}}_equalEvents(i,h,p){if(p){if(i.x!==h.x||i.y!==h.y)return!1}else if(i.col!==h.col||i.row!==h.row)return!1;return i.button===h.button&&i.action===h.action&&i.ctrl===h.ctrl&&i.alt===h.alt&&i.shift===h.shift}};s=g([f(0,u.IBufferService),f(1,u.ICoreService)],s),c.CoreMouseService=s},6975:function($,c,y){var g=this&&this.__decorate||function(s,i,h,p){var v,w=arguments.length,m=w<3?i:p===null?p=Object.getOwnPropertyDescriptor(i,h):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(s,i,h,p);else for(var b=s.length-1;b>=0;b--)(v=s[b])&&(m=(w<3?v(m):w>3?v(i,h,m):v(i,h))||m);return w>3&&m&&Object.defineProperty(i,h,m),m},f=this&&this.__param||function(s,i){return function(h,p){i(h,p,s)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreService=void 0;const u=y(2585),d=y(8460),C=y(1439),_=y(844),o=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let l=class extends _.Disposable{constructor(s,i,h){super(),this._bufferService=s,this._logService=i,this._optionsService=h,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,C.clone)(o),this.decPrivateModes=(0,C.clone)(t)}reset(){this.modes=(0,C.clone)(o),this.decPrivateModes=(0,C.clone)(t)}triggerDataEvent(s,i=!1){if(this._optionsService.rawOptions.disableStdin)return;const h=this._bufferService.buffer;i&&this._optionsService.rawOptions.scrollOnUserInput&&h.ybase!==h.ydisp&&this._onRequestScrollToBottom.fire(),i&&this._onUserInput.fire(),this._logService.debug(`sending data "${s}"`,()=>s.split("").map(p=>p.charCodeAt(0))),this._onData.fire(s)}triggerBinaryEvent(s){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${s}"`,()=>s.split("").map(i=>i.charCodeAt(0))),this._onBinary.fire(s))}};l=g([f(0,u.IBufferService),f(1,u.ILogService),f(2,u.IOptionsService)],l),c.CoreService=l},9074:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DecorationService=void 0;const g=y(8055),f=y(8460),u=y(844),d=y(6106);let C=0,_=0;class o extends u.Disposable{constructor(){super(),this._decorations=new d.SortedList(s=>s==null?void 0:s.marker.line),this._onDecorationRegistered=this.register(new f.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new f.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,u.toDisposable)(()=>{for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(s){if(s.marker.isDisposed)return;const i=new t(s);if(i){const h=i.marker.onDispose(()=>i.dispose());i.onDispose(()=>{i&&(this._decorations.delete(i)&&this._onDecorationRemoved.fire(i),h.dispose())}),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}reset(){for(const s of this._decorations.values())s.dispose();this._decorations.clear()}*getDecorationsAtCell(s,i,h){var p,v,w;let m=0,b=0;for(const E of this._decorations.getKeyIterator(i))m=(p=E.options.x)!==null&&p!==void 0?p:0,b=m+((v=E.options.width)!==null&&v!==void 0?v:1),s>=m&&s<b&&(!h||((w=E.options.layer)!==null&&w!==void 0?w:"bottom")===h)&&(yield E)}forEachDecorationAtCell(s,i,h,p){this._decorations.forEachByKey(i,v=>{var w,m,b;C=(w=v.options.x)!==null&&w!==void 0?w:0,_=C+((m=v.options.width)!==null&&m!==void 0?m:1),s>=C&&s<_&&(!h||((b=v.options.layer)!==null&&b!==void 0?b:"bottom")===h)&&p(v)})}dispose(){for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}}c.DecorationService=o;class t extends u.Disposable{constructor(s){super(),this.options=s,this.onRenderEmitter=this.register(new f.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=s.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=g.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=g.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.InstantiationService=c.ServiceCollection=void 0;const g=y(2585),f=y(8343);class u{constructor(...C){this._entries=new Map;for(const[_,o]of C)this.set(_,o)}set(C,_){const o=this._entries.get(C);return this._entries.set(C,_),o}forEach(C){for(const[_,o]of this._entries.entries())C(_,o)}has(C){return this._entries.has(C)}get(C){return this._entries.get(C)}}c.ServiceCollection=u,c.InstantiationService=class{constructor(){this._services=new u,this._services.set(g.IInstantiationService,this)}setService(d,C){this._services.set(d,C)}getService(d){return this._services.get(d)}createInstance(d,...C){const _=(0,f.getServiceDependencies)(d).sort((l,s)=>l.index-s.index),o=[];for(const l of _){const s=this._services.get(l.id);if(!s)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${l.id}.`);o.push(s)}const t=_.length>0?_[0].index:C.length;if(C.length!==t)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${t+1} conflicts with ${C.length} static arguments`);return new d(...C,...o)}}},7866:function($,c,y){var g=this&&this.__decorate||function(o,t,l,s){var i,h=arguments.length,p=h<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,l):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,t,l,s);else for(var v=o.length-1;v>=0;v--)(i=o[v])&&(p=(h<3?i(p):h>3?i(t,l,p):i(t,l))||p);return h>3&&p&&Object.defineProperty(t,l,p),p},f=this&&this.__param||function(o,t){return function(l,s){t(l,s,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.LogService=void 0;const u=y(844),d=y(2585),C={debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let _=class extends u.Disposable{constructor(o){super(),this._optionsService=o,this.logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=C[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(o){for(let t=0;t<o.length;t++)typeof o[t]=="function"&&(o[t]=o[t]())}_log(o,t,l){this._evalLazyOptionalParams(l),o.call(console,"xterm.js: "+t,...l)}debug(o,...t){this.logLevel<=d.LogLevelEnum.DEBUG&&this._log(console.log,o,t)}info(o,...t){this.logLevel<=d.LogLevelEnum.INFO&&this._log(console.info,o,t)}warn(o,...t){this.logLevel<=d.LogLevelEnum.WARN&&this._log(console.warn,o,t)}error(o,...t){this.logLevel<=d.LogLevelEnum.ERROR&&this._log(console.error,o,t)}};_=g([f(0,d.IOptionsService)],_),c.LogService=_},7302:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OptionsService=c.DEFAULT_OPTIONS=void 0;const g=y(8460),f=y(6114),u=y(844);c.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:f.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];class C extends u.Disposable{constructor(o){super(),this._onOptionChange=this.register(new g.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},c.DEFAULT_OPTIONS);for(const l in o)if(l in t)try{const s=o[l];t[l]=this._sanitizeAndValidateOption(l,s)}catch(s){console.error(s)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(o,t){return this.onOptionChange(l=>{l===o&&t(this.rawOptions[o])})}onMultipleOptionChange(o,t){return this.onOptionChange(l=>{o.indexOf(l)!==-1&&t()})}_setupOptions(){const o=l=>{if(!(l in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${l}"`);return this.rawOptions[l]},t=(l,s)=>{if(!(l in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${l}"`);s=this._sanitizeAndValidateOption(l,s),this.rawOptions[l]!==s&&(this.rawOptions[l]=s,this._onOptionChange.fire(l))};for(const l in this.rawOptions){const s={get:o.bind(this,l),set:t.bind(this,l)};Object.defineProperty(this.options,l,s)}}_sanitizeAndValidateOption(o,t){switch(o){case"cursorStyle":if(t||(t=c.DEFAULT_OPTIONS[o]),!function(l){return l==="block"||l==="underline"||l==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${o}`);break;case"wordSeparator":t||(t=c.DEFAULT_OPTIONS[o]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=d.includes(t)?t:c.DEFAULT_OPTIONS[o];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${o} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${o} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${o} cannot be less than or equal to 0, value: ${t}`);case"rows":case"cols":if(!t&&t!==0)throw new Error(`${o} must be numeric, value: ${t}`)}return t}}c.OptionsService=C},2660:function($,c,y){var g=this&&this.__decorate||function(C,_,o,t){var l,s=arguments.length,i=s<3?_:t===null?t=Object.getOwnPropertyDescriptor(_,o):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(C,_,o,t);else for(var h=C.length-1;h>=0;h--)(l=C[h])&&(i=(s<3?l(i):s>3?l(_,o,i):l(_,o))||i);return s>3&&i&&Object.defineProperty(_,o,i),i},f=this&&this.__param||function(C,_){return function(o,t){_(o,t,C)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkService=void 0;const u=y(2585);let d=class{constructor(C){this._bufferService=C,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(C){const _=this._bufferService.buffer;if(C.id===void 0){const h=_.addMarker(_.ybase+_.y),p={data:C,id:this._nextId++,lines:[h]};return h.onDispose(()=>this._removeMarkerFromLink(p,h)),this._dataByLinkId.set(p.id,p),p.id}const o=C,t=this._getEntryIdKey(o),l=this._entriesWithId.get(t);if(l)return this.addLineToLink(l.id,_.ybase+_.y),l.id;const s=_.addMarker(_.ybase+_.y),i={id:this._nextId++,key:this._getEntryIdKey(o),data:o,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(i,s)),this._entriesWithId.set(i.key,i),this._dataByLinkId.set(i.id,i),i.id}addLineToLink(C,_){const o=this._dataByLinkId.get(C);if(o&&o.lines.every(t=>t.line!==_)){const t=this._bufferService.buffer.addMarker(_);o.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(o,t))}}getLinkData(C){var _;return(_=this._dataByLinkId.get(C))===null||_===void 0?void 0:_.data}_getEntryIdKey(C){return`${C.id};;${C.uri}`}_removeMarkerFromLink(C,_){const o=C.lines.indexOf(_);o!==-1&&(C.lines.splice(o,1),C.lines.length===0&&(C.data.id!==void 0&&this._entriesWithId.delete(C.key),this._dataByLinkId.delete(C.id)))}};d=g([f(0,u.IBufferService)],d),c.OscLinkService=d},8343:($,c)=>{function y(g,f,u){f.di$target===f?f.di$dependencies.push({id:g,index:u}):(f.di$dependencies=[{id:g,index:u}],f.di$target=f)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(g){return g.di$dependencies||[]},c.createDecorator=function(g){if(c.serviceRegistry.has(g))return c.serviceRegistry.get(g);const f=function(u,d,C){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");y(f,u,C)};return f.toString=()=>g,c.serviceRegistry.set(g,f),f}},2585:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const g=y(8343);var f;c.IBufferService=(0,g.createDecorator)("BufferService"),c.ICoreMouseService=(0,g.createDecorator)("CoreMouseService"),c.ICoreService=(0,g.createDecorator)("CoreService"),c.ICharsetService=(0,g.createDecorator)("CharsetService"),c.IInstantiationService=(0,g.createDecorator)("InstantiationService"),(f=c.LogLevelEnum||(c.LogLevelEnum={}))[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f[f.OFF=4]="OFF",c.ILogService=(0,g.createDecorator)("LogService"),c.IOptionsService=(0,g.createDecorator)("OptionsService"),c.IOscLinkService=(0,g.createDecorator)("OscLinkService"),c.IUnicodeService=(0,g.createDecorator)("UnicodeService"),c.IDecorationService=(0,g.createDecorator)("DecorationService")},1480:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeService=void 0;const g=y(8460),f=y(225);c.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new g.EventEmitter,this.onChange=this._onChange.event;const u=new f.UnicodeV6;this.register(u),this._active=u.version,this._activeProvider=u}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(u){if(!this._providers[u])throw new Error(`unknown Unicode version "${u}"`);this._active=u,this._activeProvider=this._providers[u],this._onChange.fire(u)}register(u){this._providers[u.version]=u}wcwidth(u){return this._activeProvider.wcwidth(u)}getStringCellWidth(u){let d=0;const C=u.length;for(let _=0;_<C;++_){let o=u.charCodeAt(_);if(55296<=o&&o<=56319){if(++_>=C)return d+this.wcwidth(o);const t=u.charCodeAt(_);56320<=t&&t<=57343?o=1024*(o-55296)+t-56320+65536:d+=this.wcwidth(t)}d+=this.wcwidth(o)}return d}}}},se={};function ce($){var c=se[$];if(c!==void 0)return c.exports;var y=se[$]={exports:{}};return J[$].call(y.exports,y,y.exports,ce),y.exports}var _e={};return(()=>{var $=_e;Object.defineProperty($,"__esModule",{value:!0}),$.Terminal=void 0;const c=ce(3236),y=ce(9042),g=ce(7975),f=ce(7090),u=ce(5741),d=ce(8285),C=["cols","rows"];$.Terminal=class{constructor(_){this._core=new c.Terminal(_),this._addonManager=new u.AddonManager,this._publicOptions=Object.assign({},this._core.options);const o=l=>this._core.options[l],t=(l,s)=>{this._checkReadonlyOptions(l),this._core.options[l]=s};for(const l in this._core.options){const s={get:o.bind(this,l),set:t.bind(this,l)};Object.defineProperty(this._publicOptions,l,s)}}_checkReadonlyOptions(_){if(C.includes(_))throw new Error(`Option "${_}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new g.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new d.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const _=this._core.coreService.decPrivateModes;let o="none";switch(this._core.coreMouseService.activeProtocol){case"X10":o="x10";break;case"VT200":o="vt200";break;case"DRAG":o="drag";break;case"ANY":o="any"}return{applicationCursorKeysMode:_.applicationCursorKeys,applicationKeypadMode:_.applicationKeypad,bracketedPasteMode:_.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:o,originMode:_.origin,reverseWraparoundMode:_.reverseWraparound,sendFocusMode:_.sendFocus,wraparoundMode:_.wraparound}}get options(){return this._publicOptions}set options(_){for(const o in _)this._publicOptions[o]=_[o]}blur(){this._core.blur()}focus(){this._core.focus()}resize(_,o){this._verifyIntegers(_,o),this._core.resize(_,o)}open(_){this._core.open(_)}attachCustomKeyEventHandler(_){this._core.attachCustomKeyEventHandler(_)}registerLinkProvider(_){return this._core.registerLinkProvider(_)}registerCharacterJoiner(_){return this._checkProposedApi(),this._core.registerCharacterJoiner(_)}deregisterCharacterJoiner(_){this._checkProposedApi(),this._core.deregisterCharacterJoiner(_)}registerMarker(_=0){return this._verifyIntegers(_),this._core.addMarker(_)}registerDecoration(_){var o,t,l;return this._checkProposedApi(),this._verifyPositiveIntegers((o=_.x)!==null&&o!==void 0?o:0,(t=_.width)!==null&&t!==void 0?t:0,(l=_.height)!==null&&l!==void 0?l:0),this._core.registerDecoration(_)}hasSelection(){return this._core.hasSelection()}select(_,o,t){this._verifyIntegers(_,o,t),this._core.select(_,o,t)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(_,o){this._verifyIntegers(_,o),this._core.selectLines(_,o)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(_){this._verifyIntegers(_),this._core.scrollLines(_)}scrollPages(_){this._verifyIntegers(_),this._core.scrollPages(_)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(_){this._verifyIntegers(_),this._core.scrollToLine(_)}clear(){this._core.clear()}write(_,o){this._core.write(_,o)}writeln(_,o){this._core.write(_),this._core.write(`\r
`,o)}paste(_){this._core.paste(_)}refresh(_,o){this._verifyIntegers(_,o),this._core.refresh(_,o)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(_){return this._addonManager.loadAddon(this,_)}static get strings(){return y}_verifyIntegers(..._){for(const o of _)if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(..._){for(const o of _)if(o&&(o===1/0||isNaN(o)||o%1!=0||o<0))throw new Error("This API only accepts positive integers")}}})(),_e})())})(Xi);var dn=Xi.exports,Zi={exports:{}};(function(V,U){(function(J,se){V.exports=se()})(self,function(){return(()=>{var J={903:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseRenderLayer=void 0;const g=y(503),f=y(627),u=y(237),d=y(860),C=y(374),_=y(296),o=y(855),t=y(274),l=y(859),s=y(399),i=y(345);class h extends l.Disposable{constructor(w,m,b,E,A,T,B,F,D,H){super(),this._terminal=w,this._container=m,this._alpha=A,this._themeService=T,this._bufferService=B,this._optionsService=F,this._decorationService=D,this._coreBrowserService=H,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._selectionModel=(0,_.createSelectionRenderModel)(),this._bitmapGenerator=[],this._onAddTextureAtlasCanvas=this.register(new i.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._cellColorResolver=new t.CellColorResolver(this._terminal,this._selectionModel,this._decorationService,this._coreBrowserService,this._themeService),this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${b}-layer`),this._canvas.style.zIndex=E.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this._refreshCharAtlas(this._themeService.colors),this.register(this._themeService.onChangeColors(L=>{this._refreshCharAtlas(L),this.reset()})),this.register((0,l.toDisposable)(()=>{var L;(0,g.removeElementFromParent)(this._canvas),(L=this._charAtlas)===null||L===void 0||L.dispose()}))}get canvas(){return this._canvas}get cacheCanvas(){var w;return(w=this._charAtlas)===null||w===void 0?void 0:w.pages[0].canvas}_initCanvas(){this._ctx=(0,C.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(){}handleFocus(){}handleCursorMove(){}handleGridChanged(w,m){}handleSelectionChanged(w,m,b=!1){this._selectionModel.update(this._terminal,w,m,b)}_setTransparency(w){if(w===this._alpha)return;const m=this._canvas;this._alpha=w,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,m),this._refreshCharAtlas(this._themeService.colors),this.handleGridChanged(0,this._bufferService.rows-1)}_refreshCharAtlas(w){var m;if(!(this._deviceCharWidth<=0&&this._deviceCharHeight<=0)){(m=this._charAtlasDisposable)===null||m===void 0||m.dispose(),this._charAtlas=(0,f.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,w,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlasDisposable=(0,i.forwardEvent)(this._charAtlas.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),this._charAtlas.warmUp();for(let b=0;b<this._charAtlas.pages.length;b++)this._bitmapGenerator[b]=new p(this._charAtlas.pages[b].canvas)}}resize(w){this._deviceCellWidth=w.device.cell.width,this._deviceCellHeight=w.device.cell.height,this._deviceCharWidth=w.device.char.width,this._deviceCharHeight=w.device.char.height,this._deviceCharLeft=w.device.char.left,this._deviceCharTop=w.device.char.top,this._canvas.width=w.device.canvas.width,this._canvas.height=w.device.canvas.height,this._canvas.style.width=`${w.css.canvas.width}px`,this._canvas.style.height=`${w.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(this._themeService.colors)}clearTextureAtlas(){var w;(w=this._charAtlas)===null||w===void 0||w.clearTexture()}_fillCells(w,m,b,E){this._ctx.fillRect(w*this._deviceCellWidth,m*this._deviceCellHeight,b*this._deviceCellWidth,E*this._deviceCellHeight)}_fillMiddleLineAtCells(w,m,b=1){const E=Math.ceil(.5*this._deviceCellHeight);this._ctx.fillRect(w*this._deviceCellWidth,(m+1)*this._deviceCellHeight-E-this._coreBrowserService.dpr,b*this._deviceCellWidth,this._coreBrowserService.dpr)}_fillBottomLineAtCells(w,m,b=1,E=0){this._ctx.fillRect(w*this._deviceCellWidth,(m+1)*this._deviceCellHeight+E-this._coreBrowserService.dpr-1,b*this._deviceCellWidth,this._coreBrowserService.dpr)}_curlyUnderlineAtCell(w,m,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const E=this._coreBrowserService.dpr;this._ctx.lineWidth=E;for(let A=0;A<b;A++){const T=(w+A)*this._deviceCellWidth,B=(w+A+.5)*this._deviceCellWidth,F=(w+A+1)*this._deviceCellWidth,D=(m+1)*this._deviceCellHeight-E-1,H=D-E,L=D+E;this._ctx.moveTo(T,D),this._ctx.bezierCurveTo(T,H,B,H,B,D),this._ctx.bezierCurveTo(B,L,F,L,F,D)}this._ctx.stroke(),this._ctx.restore()}_dottedUnderlineAtCell(w,m,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const E=this._coreBrowserService.dpr;this._ctx.lineWidth=E,this._ctx.setLineDash([2*E,E]);const A=w*this._deviceCellWidth,T=(m+1)*this._deviceCellHeight-E-1;this._ctx.moveTo(A,T);for(let B=0;B<b;B++){const F=(w+b+B)*this._deviceCellWidth;this._ctx.lineTo(F,T)}this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_dashedUnderlineAtCell(w,m,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const E=this._coreBrowserService.dpr;this._ctx.lineWidth=E,this._ctx.setLineDash([4*E,3*E]);const A=w*this._deviceCellWidth,T=(w+b)*this._deviceCellWidth,B=(m+1)*this._deviceCellHeight-E-1;this._ctx.moveTo(A,B),this._ctx.lineTo(T,B),this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_fillLeftLineAtCell(w,m,b){this._ctx.fillRect(w*this._deviceCellWidth,m*this._deviceCellHeight,this._coreBrowserService.dpr*b,this._deviceCellHeight)}_strokeRectAtCell(w,m,b,E){const A=this._coreBrowserService.dpr;this._ctx.lineWidth=A,this._ctx.strokeRect(w*this._deviceCellWidth+A/2,m*this._deviceCellHeight+A/2,b*this._deviceCellWidth-A,E*this._deviceCellHeight-A)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(w,m,b,E){this._alpha?this._ctx.clearRect(w*this._deviceCellWidth,m*this._deviceCellHeight,b*this._deviceCellWidth,E*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(w*this._deviceCellWidth,m*this._deviceCellHeight,b*this._deviceCellWidth,E*this._deviceCellHeight))}_fillCharTrueColor(w,m,b){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=u.TEXT_BASELINE,this._clipRow(b);let E=!1;this._optionsService.rawOptions.customGlyphs!==!1&&(E=(0,d.tryDrawCustomChar)(this._ctx,w.getChars(),m*this._deviceCellWidth,b*this._deviceCellHeight,this._deviceCellWidth,this._deviceCellHeight,this._optionsService.rawOptions.fontSize,this._coreBrowserService.dpr)),E||this._ctx.fillText(w.getChars(),m*this._deviceCellWidth+this._deviceCharLeft,b*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_drawChars(w,m,b){var E,A;const T=w.getChars();let B;this._cellColorResolver.resolve(w,m,this._bufferService.buffer.ydisp+b),B=T&&T.length>1?this._charAtlas.getRasterizedGlyphCombinedChar(T,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext):this._charAtlas.getRasterizedGlyph(w.getCode()||o.WHITESPACE_CELL_CODE,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext),B.size.x&&B.size.y&&(this._ctx.save(),this._clipRow(b),this._charAtlas.pages[B.texturePage].version!==((E=this._bitmapGenerator[B.texturePage])===null||E===void 0?void 0:E.version)&&(this._bitmapGenerator[B.texturePage]||(this._bitmapGenerator[B.texturePage]=new p(this._charAtlas.pages[B.texturePage].canvas)),this._bitmapGenerator[B.texturePage].refresh(),this._bitmapGenerator[B.texturePage].version=this._charAtlas.pages[B.texturePage].version),this._ctx.drawImage(((A=this._bitmapGenerator[B.texturePage])===null||A===void 0?void 0:A.bitmap)||this._charAtlas.pages[B.texturePage].canvas,B.texturePosition.x,B.texturePosition.y,B.size.x,B.size.y,m*this._deviceCellWidth+this._deviceCharLeft-B.offset.x,b*this._deviceCellHeight+this._deviceCharTop-B.offset.y,B.size.x,B.size.y),this._ctx.restore())}_clipRow(w){this._ctx.beginPath(),this._ctx.rect(0,w*this._deviceCellHeight,this._bufferService.cols*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(w,m){return`${m?"italic":""} ${w?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight} ${this._optionsService.rawOptions.fontSize*this._coreBrowserService.dpr}px ${this._optionsService.rawOptions.fontFamily}`}}c.BaseRenderLayer=h;class p{constructor(w){this._canvas=w,this._state=0,this._commitTimeout=void 0,this._bitmap=void 0,this.version=-1}get bitmap(){return this._bitmap}refresh(){this._bitmap=void 0,s.isSafari||(this._commitTimeout===void 0&&(this._commitTimeout=window.setTimeout(()=>this._generate(),100)),this._state===1&&(this._state=2))}_generate(){this._state===0&&(this._bitmap=void 0,this._state=1,window.createImageBitmap(this._canvas).then(w=>{this._state===2?this.refresh():this._bitmap=w,this._state=0}),this._commitTimeout&&(this._commitTimeout=void 0))}}},949:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasRenderer=void 0;const g=y(627),f=y(56),u=y(374),d=y(345),C=y(859),_=y(873),o=y(43),t=y(630),l=y(744);class s extends C.Disposable{constructor(h,p,v,w,m,b,E,A,T,B,F){super(),this._terminal=h,this._screenElement=p,this._bufferService=w,this._charSizeService=m,this._optionsService=b,this._coreBrowserService=T,this._themeService=F,this._onRequestRedraw=this.register(new d.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onChangeTextureAtlas=this.register(new d.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new d.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event;const D=this._optionsService.rawOptions.allowTransparency;this._renderLayers=[new l.TextRenderLayer(this._terminal,this._screenElement,0,D,this._bufferService,this._optionsService,E,B,this._coreBrowserService,F),new t.SelectionRenderLayer(this._terminal,this._screenElement,1,this._bufferService,this._coreBrowserService,B,this._optionsService,F),new o.LinkRenderLayer(this._terminal,this._screenElement,2,v,this._bufferService,this._optionsService,B,this._coreBrowserService,F),new _.CursorRenderLayer(this._terminal,this._screenElement,3,this._onRequestRedraw,this._bufferService,this._optionsService,A,this._coreBrowserService,B,F)];for(const H of this._renderLayers)(0,d.forwardEvent)(H.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas);this.dimensions=(0,u.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this.register((0,f.observeDevicePixelDimensions)(this._renderLayers[0].canvas,this._coreBrowserService.window,(H,L)=>this._setCanvasDevicePixelDimensions(H,L))),this.register((0,C.toDisposable)(()=>{for(const H of this._renderLayers)H.dispose();(0,g.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){return this._renderLayers[0].cacheCanvas}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._bufferService.cols,this._bufferService.rows))}handleResize(h,p){this._updateDimensions();for(const v of this._renderLayers)v.resize(this.dimensions);this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}handleCharSizeChanged(){this.handleResize(this._bufferService.cols,this._bufferService.rows)}handleBlur(){this._runOperation(h=>h.handleBlur())}handleFocus(){this._runOperation(h=>h.handleFocus())}handleSelectionChanged(h,p,v=!1){this._runOperation(w=>w.handleSelectionChanged(h,p,v)),this._themeService.colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}handleCursorMove(){this._runOperation(h=>h.handleCursorMove())}clear(){this._runOperation(h=>h.reset())}_runOperation(h){for(const p of this._renderLayers)h(p)}renderRows(h,p){for(const v of this._renderLayers)v.handleGridChanged(h,p)}clearTextureAtlas(){for(const h of this._renderLayers)h.clearTextureAtlas()}_updateDimensions(){if(!this._charSizeService.hasValidSize)return;const h=this._coreBrowserService.dpr;this.dimensions.device.char.width=Math.floor(this._charSizeService.width*h),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*h),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._bufferService.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._bufferService.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/h),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/h),this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows,this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols}_setCanvasDevicePixelDimensions(h,p){this.dimensions.device.canvas.height=p,this.dimensions.device.canvas.width=h;for(const v of this._renderLayers)v.resize(this.dimensions);this._requestRedrawViewport()}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}}c.CanvasRenderer=s},873:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CursorRenderLayer=void 0;const g=y(903),f=y(782),u=y(859);class d extends g.BaseRenderLayer{constructor(o,t,l,s,i,h,p,v,w,m){super(o,t,"cursor",l,!0,m,i,h,w,v),this._onRequestRedraw=s,this._coreService=p,this._cell=new f.CellData,this._state={x:0,y:0,isFocused:!1,style:"",width:0},this._cursorRenderers={bar:this._renderBarCursor.bind(this),block:this._renderBlockCursor.bind(this),underline:this._renderUnderlineCursor.bind(this)},this.register(h.onOptionChange(()=>this._handleOptionsChanged())),this.register((0,u.toDisposable)(()=>{var b;(b=this._cursorBlinkStateManager)===null||b===void 0||b.dispose(),this._cursorBlinkStateManager=void 0}))}resize(o){super.resize(o),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}reset(){var o;this._clearCursor(),(o=this._cursorBlinkStateManager)===null||o===void 0||o.restartBlinkAnimation(),this._handleOptionsChanged()}handleBlur(){var o;(o=this._cursorBlinkStateManager)===null||o===void 0||o.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleFocus(){var o;(o=this._cursorBlinkStateManager)===null||o===void 0||o.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}_handleOptionsChanged(){var o;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new C(this._coreBrowserService.isFocused,()=>{this._render(!0)},this._coreBrowserService)):((o=this._cursorBlinkStateManager)===null||o===void 0||o.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleCursorMove(){var o;(o=this._cursorBlinkStateManager)===null||o===void 0||o.restartBlinkAnimation()}handleGridChanged(o,t){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()}_render(o){if(!this._coreService.isCursorInitialized||this._coreService.isCursorHidden)return void this._clearCursor();const t=this._bufferService.buffer.ybase+this._bufferService.buffer.y,l=t-this._bufferService.buffer.ydisp;if(l<0||l>=this._bufferService.rows)return void this._clearCursor();const s=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(t).loadCell(s,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;const i=this._optionsService.rawOptions.cursorStyle;return i&&i!=="block"?this._cursorRenderers[i](s,l,this._cell):this._renderBlurCursor(s,l,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=l,this._state.isFocused=!1,this._state.style=i,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===s&&this._state.y===l&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](s,l,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=l,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}_clearCursor(){this._state&&(this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}_renderBarCursor(o,t,l){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(o,t,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}_renderBlockCursor(o,t,l){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(o,t,l.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(l,o,t),this._ctx.restore()}_renderUnderlineCursor(o,t,l){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(o,t),this._ctx.restore()}_renderBlurCursor(o,t,l){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(o,t,l.getWidth(),1),this._ctx.restore()}}c.CursorRenderLayer=d;class C{constructor(o,t,l){this._renderCallback=t,this._coreBrowserService=l,this.isCursorVisible=!0,o&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(o=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,t>0)return void this._restartInterval(t)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(t)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},o)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},574:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GridCache=void 0,c.GridCache=class{constructor(){this.cache=[]}resize(y,g){for(let f=0;f<y;f++){this.cache.length<=f&&this.cache.push([]);for(let u=this.cache[f].length;u<g;u++)this.cache[f].push(void 0);this.cache[f].length=g}this.cache.length=y}clear(){for(let y=0;y<this.cache.length;y++)for(let g=0;g<this.cache[y].length;g++)this.cache[y][g]=void 0}}},43:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkRenderLayer=void 0;const g=y(903),f=y(237),u=y(197);class d extends g.BaseRenderLayer{constructor(_,o,t,l,s,i,h,p,v){super(_,o,"link",t,!0,v,s,i,h,p),this.register(l.onShowLinkUnderline(w=>this._handleShowLinkUnderline(w))),this.register(l.onHideLinkUnderline(w=>this._handleHideLinkUnderline(w)))}resize(_){super.resize(_),this._state=void 0}reset(){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const _=this._state.y2-this._state.y1-1;_>0&&this._clearCells(0,this._state.y1+1,this._state.cols,_),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(_){if(_.fg===f.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:_.fg&&(0,u.is256Color)(_.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[_.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,_.y1===_.y2)this._fillBottomLineAtCells(_.x1,_.y1,_.x2-_.x1);else{this._fillBottomLineAtCells(_.x1,_.y1,_.cols-_.x1);for(let o=_.y1+1;o<_.y2;o++)this._fillBottomLineAtCells(0,o,_.cols);this._fillBottomLineAtCells(0,_.y2,_.x2)}this._state=_}_handleHideLinkUnderline(_){this._clearCurrentLink()}}c.LinkRenderLayer=d},630:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionRenderLayer=void 0;const g=y(903);class f extends g.BaseRenderLayer{constructor(d,C,_,o,t,l,s,i){super(d,C,"selection",_,!0,i,o,s,l,t),this._clearState()}_clearState(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}}resize(d){super.resize(d),this._selectionModel.selectionStart&&this._selectionModel.selectionEnd&&this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}reset(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())}handleBlur(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleFocus(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleSelectionChanged(d,C,_){super.handleSelectionChanged(d,C,_),this._redrawSelection(d,C,_)}_redrawSelection(d,C,_){if(!this._didStateChange(d,C,_,this._bufferService.buffer.ydisp))return;if(this._clearAll(),!d||!C)return void this._clearState();const o=d[1]-this._bufferService.buffer.ydisp,t=C[1]-this._bufferService.buffer.ydisp,l=Math.max(o,0),s=Math.min(t,this._bufferService.rows-1);if(l>=this._bufferService.rows||s<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=(this._coreBrowserService.isFocused?this._themeService.colors.selectionBackgroundTransparent:this._themeService.colors.selectionInactiveBackgroundTransparent).css,_){const i=d[0],h=C[0]-i,p=s-l+1;this._fillCells(i,l,h,p)}else{const i=o===l?d[0]:0,h=l===t?C[0]:this._bufferService.cols;this._fillCells(i,l,h-i,1);const p=Math.max(s-l-1,0);if(this._fillCells(0,l+1,this._bufferService.cols,p),l!==s){const v=t===s?C[0]:this._bufferService.cols;this._fillCells(0,s,v,1)}}this._state.start=[d[0],d[1]],this._state.end=[C[0],C[1]],this._state.columnSelectMode=_,this._state.ydisp=this._bufferService.buffer.ydisp}}_didStateChange(d,C,_,o){return!this._areCoordinatesEqual(d,this._state.start)||!this._areCoordinatesEqual(C,this._state.end)||_!==this._state.columnSelectMode||o!==this._state.ydisp}_areCoordinatesEqual(d,C){return!(!d||!C)&&d[0]===C[0]&&d[1]===C[1]}}c.SelectionRenderLayer=f},744:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextRenderLayer=void 0;const g=y(574),f=y(903),u=y(147),d=y(855),C=y(782),_=y(577),o=y(160);class t extends f.BaseRenderLayer{constructor(s,i,h,p,v,w,m,b,E,A){super(s,i,"text",h,p,A,v,w,b,E),this._characterJoinerService=m,this._characterWidth=0,this._characterFont="",this._characterOverlapCache={},this._workCell=new C.CellData,this._state=new g.GridCache,this.register(w.onSpecificOptionChange("allowTransparency",T=>this._setTransparency(T)))}resize(s){super.resize(s);const i=this._getFont(!1,!1);this._characterWidth===s.device.char.width&&this._characterFont===i||(this._characterWidth=s.device.char.width,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)}reset(){this._state.clear(),this._clearAll()}_forEachCell(s,i,h){for(let p=s;p<=i;p++){const v=p+this._bufferService.buffer.ydisp,w=this._bufferService.buffer.lines.get(v),m=this._characterJoinerService.getJoinedCharacters(v);for(let b=0;b<this._bufferService.cols;b++){w.loadCell(b,this._workCell);let E=this._workCell,A=!1,T=b;if(E.getWidth()===0)continue;const B=E.getCode();if(B!==0&&B!==32){if(m.length>0&&b===m[0][0]){A=!0;const F=m.shift();E=new _.JoinedCellData(this._workCell,w.translateToString(!0,F[0],F[1]),F[1]-F[0]),T=F[1]-1}!A&&this._isOverlapping(E)&&T<w.length-1&&w.getCodePoint(T+1)===d.NULL_CELL_CODE&&(E.content&=-12582913,E.content|=8388608),h(E,b,p),b=T}}}}_drawBackground(s,i){const h=this._ctx,p=this._bufferService.cols;let v=0,w=0,m=null;h.save(),this._forEachCell(s,i,(b,E,A)=>{let T=null;b.isInverse()?T=b.isFgDefault()?this._themeService.colors.foreground.css:b.isFgRGB()?`rgb(${u.AttributeData.toColorRGB(b.getFgColor()).join(",")})`:this._themeService.colors.ansi[b.getFgColor()].css:b.isBgRGB()?T=`rgb(${u.AttributeData.toColorRGB(b.getBgColor()).join(",")})`:b.isBgPalette()&&(T=this._themeService.colors.ansi[b.getBgColor()].css),T&&b.isDim()&&(T=o.color.multiplyOpacity(o.css.toColor(T),.5).css);let B=!1;this._decorationService.forEachDecorationAtCell(E,this._bufferService.buffer.ydisp+A,void 0,F=>{F.options.layer!=="top"&&B||(F.backgroundColorRGB&&(T=F.backgroundColorRGB.css),B=F.options.layer==="top")}),m===null&&(v=E,w=A),A!==w?(h.fillStyle=m||"",this._fillCells(v,w,p-v,1),v=E,w=A):m!==T&&(h.fillStyle=m||"",this._fillCells(v,w,E-v,1),v=E,w=A),m=T}),m!==null&&(h.fillStyle=m,this._fillCells(v,w,p-v,1)),h.restore()}_drawForeground(s,i){this._forEachCell(s,i,(h,p,v)=>this._drawChars(h,p,v))}handleGridChanged(s,i){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,s,this._bufferService.cols,i-s+1),this._drawBackground(s,i),this._drawForeground(s,i))}_isOverlapping(s){if(s.getWidth()!==1||s.getCode()<256)return!1;const i=s.getChars();if(this._characterOverlapCache.hasOwnProperty(i))return this._characterOverlapCache[i];this._ctx.save(),this._ctx.font=this._characterFont;const h=Math.floor(this._ctx.measureText(i).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[i]=h,h}}c.TextRenderLayer=t},503:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeElementFromParent=void 0,c.removeElementFromParent=function(...y){var g;for(const f of y)(g=f==null?void 0:f.parentElement)===null||g===void 0||g.removeChild(f)}},274:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellColorResolver=void 0;let y,g=0,f=0,u=!1,d=!1,C=!1;c.CellColorResolver=class{constructor(_,o,t,l,s){this._terminal=_,this._selectionRenderModel=o,this._decorationService=t,this._coreBrowserService=l,this._themeService=s,this.result={fg:0,bg:0,ext:0}}resolve(_,o,t){this.result.bg=_.bg,this.result.fg=_.fg,this.result.ext=268435456&_.bg?_.extended.ext:0,f=0,g=0,d=!1,u=!1,C=!1,y=this._themeService.colors,this._decorationService.forEachDecorationAtCell(o,t,"bottom",l=>{l.backgroundColorRGB&&(f=l.backgroundColorRGB.rgba>>8&16777215,d=!0),l.foregroundColorRGB&&(g=l.foregroundColorRGB.rgba>>8&16777215,u=!0)}),C=this._selectionRenderModel.isCellSelected(this._terminal,o,t),C&&(f=(this._coreBrowserService.isFocused?y.selectionBackgroundOpaque:y.selectionInactiveBackgroundOpaque).rgba>>8&16777215,d=!0,y.selectionForeground&&(g=y.selectionForeground.rgba>>8&16777215,u=!0)),this._decorationService.forEachDecorationAtCell(o,t,"top",l=>{l.backgroundColorRGB&&(f=l.backgroundColorRGB.rgba>>8&16777215,d=!0),l.foregroundColorRGB&&(g=l.foregroundColorRGB.rgba>>8&16777215,u=!0)}),d&&(f=C?-16777216&_.bg&-134217729|f|50331648:-16777216&_.bg|f|50331648),u&&(g=-16777216&_.fg&-67108865|g|50331648),67108864&this.result.fg&&(d&&!u&&(g=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&y.background.rgba>>8|50331648,u=!0),!d&&u&&(f=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&y.foreground.rgba>>8|50331648,d=!0)),y=void 0,this.result.bg=d?f:this.result.bg,this.result.fg=u?g:this.result.fg}}},627:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeTerminalFromCache=c.acquireTextureAtlas=void 0;const g=y(509),f=y(197),u=[];c.acquireTextureAtlas=function(d,C,_,o,t,l,s,i){const h=(0,f.generateConfig)(o,t,l,s,C,_,i);for(let w=0;w<u.length;w++){const m=u[w],b=m.ownedBy.indexOf(d);if(b>=0){if((0,f.configEquals)(m.config,h))return m.atlas;m.ownedBy.length===1?(m.atlas.dispose(),u.splice(w,1)):m.ownedBy.splice(b,1);break}}for(let w=0;w<u.length;w++){const m=u[w];if((0,f.configEquals)(m.config,h))return m.ownedBy.push(d),m.atlas}const p=d._core,v={atlas:new g.TextureAtlas(document,h,p.unicodeService),config:h,ownedBy:[d]};return u.push(v),v.atlas},c.removeTerminalFromCache=function(d){for(let C=0;C<u.length;C++){const _=u[C].ownedBy.indexOf(d);if(_!==-1){u[C].ownedBy.length===1?(u[C].atlas.dispose(),u.splice(C,1)):u[C].ownedBy.splice(_,1);break}}}},197:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.is256Color=c.configEquals=c.generateConfig=void 0;const g=y(160);c.generateConfig=function(f,u,d,C,_,o,t){const l={foreground:o.foreground,background:o.background,cursor:g.NULL_COLOR,cursorAccent:g.NULL_COLOR,selectionForeground:g.NULL_COLOR,selectionBackgroundTransparent:g.NULL_COLOR,selectionBackgroundOpaque:g.NULL_COLOR,selectionInactiveBackgroundTransparent:g.NULL_COLOR,selectionInactiveBackgroundOpaque:g.NULL_COLOR,ansi:o.ansi.slice(),contrastCache:o.contrastCache};return{customGlyphs:_.customGlyphs,devicePixelRatio:t,letterSpacing:_.letterSpacing,lineHeight:_.lineHeight,deviceCellWidth:f,deviceCellHeight:u,deviceCharWidth:d,deviceCharHeight:C,fontFamily:_.fontFamily,fontSize:_.fontSize,fontWeight:_.fontWeight,fontWeightBold:_.fontWeightBold,allowTransparency:_.allowTransparency,drawBoldTextInBrightColors:_.drawBoldTextInBrightColors,minimumContrastRatio:_.minimumContrastRatio,colors:l}},c.configEquals=function(f,u){for(let d=0;d<f.colors.ansi.length;d++)if(f.colors.ansi[d].rgba!==u.colors.ansi[d].rgba)return!1;return f.devicePixelRatio===u.devicePixelRatio&&f.customGlyphs===u.customGlyphs&&f.lineHeight===u.lineHeight&&f.letterSpacing===u.letterSpacing&&f.fontFamily===u.fontFamily&&f.fontSize===u.fontSize&&f.fontWeight===u.fontWeight&&f.fontWeightBold===u.fontWeightBold&&f.allowTransparency===u.allowTransparency&&f.deviceCharWidth===u.deviceCharWidth&&f.deviceCharHeight===u.deviceCharHeight&&f.drawBoldTextInBrightColors===u.drawBoldTextInBrightColors&&f.minimumContrastRatio===u.minimumContrastRatio&&f.colors.foreground.rgba===u.colors.foreground.rgba&&f.colors.background.rgba===u.colors.background.rgba},c.is256Color=function(f){return(50331648&f)==16777216||(50331648&f)==33554432}},237:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const g=y(399);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=g.isFirefox||g.isLegacyEdge?"bottom":"ideographic"},860:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tryDrawCustomChar=c.powerlineDefinitions=c.boxDrawingDefinitions=c.blockElementDefinitions=void 0;const g=y(374);c.blockElementDefinitions={"":[{x:0,y:0,w:8,h:4}],"":[{x:0,y:7,w:8,h:1}],"":[{x:0,y:6,w:8,h:2}],"":[{x:0,y:5,w:8,h:3}],"":[{x:0,y:4,w:8,h:4}],"":[{x:0,y:3,w:8,h:5}],"":[{x:0,y:2,w:8,h:6}],"":[{x:0,y:1,w:8,h:7}],"":[{x:0,y:0,w:8,h:8}],"":[{x:0,y:0,w:7,h:8}],"":[{x:0,y:0,w:6,h:8}],"":[{x:0,y:0,w:5,h:8}],"":[{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:3,h:8}],"":[{x:0,y:0,w:2,h:8}],"":[{x:0,y:0,w:1,h:8}],"":[{x:4,y:0,w:4,h:8}],"":[{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8}],"":[{x:0,y:4,w:4,h:4}],"":[{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"":[{x:4,y:0,w:4,h:4}],"":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:1,y:0,w:1,h:8}],"":[{x:2,y:0,w:1,h:8}],"":[{x:3,y:0,w:1,h:8}],"":[{x:4,y:0,w:1,h:8}],"":[{x:5,y:0,w:1,h:8}],"":[{x:6,y:0,w:1,h:8}],"":[{x:0,y:1,w:8,h:1}],"":[{x:0,y:2,w:8,h:1}],"":[{x:0,y:3,w:8,h:1}],"":[{x:0,y:4,w:8,h:1}],"":[{x:0,y:5,w:8,h:1}],"":[{x:0,y:6,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:2}],"":[{x:0,y:0,w:8,h:3}],"":[{x:0,y:0,w:8,h:5}],"":[{x:0,y:0,w:8,h:6}],"":[{x:0,y:0,w:8,h:7}],"":[{x:6,y:0,w:2,h:8}],"":[{x:5,y:0,w:3,h:8}],"":[{x:3,y:0,w:5,h:8}],"":[{x:2,y:0,w:6,h:8}],"":[{x:1,y:0,w:7,h:8}],"":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const f={"":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"":[[1,0],[0,0],[0,1],[0,0]],"":[[0,1],[1,1],[1,0],[1,1]]};c.boxDrawingDefinitions={"":{1:"M0,.5 L1,.5"},"":{3:"M0,.5 L1,.5"},"":{1:"M.5,0 L.5,1"},"":{3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5"},"":{3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M0,.5 L.5,.5 L.5,1"},"":{3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L1,.5"},"":{3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L0,.5"},"":{3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{1:"M.5,.5 L0,.5"},"":{3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0"},"":{3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5"},"":{3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1"},"":{3:"M.5,.5 L.5,1"},"":{1:(o,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1`},"":{1:(o,t)=>`M.5,1 L.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M${.5-o},1 L${.5-o},.5 L1,.5 M${.5+o},.5 L${.5+o},1`},"":{1:(o,t)=>`M1,${.5-t} L${.5-o},${.5-t} L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1`},"":{1:(o,t)=>`M0,${.5-t} L.5,${.5-t} L.5,1 M0,${.5+t} L.5,${.5+t}`},"":{1:(o,t)=>`M${.5+o},1 L${.5+o},.5 L0,.5 M${.5-o},.5 L${.5-o},1`},"":{1:(o,t)=>`M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M0,${.5-t} L${.5+o},${.5-t} L${.5+o},1`},"":{1:(o,t)=>`M.5,0 L.5,${.5+t} L1,${.5+t} M.5,${.5-t} L1,${.5-t}`},"":{1:(o,t)=>`M1,.5 L${.5-o},.5 L${.5-o},0 M${.5+o},.5 L${.5+o},0`},"":{1:(o,t)=>`M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0 M1,${.5+t} L${.5-o},${.5+t} L${.5-o},0`},"":{1:(o,t)=>`M0,${.5+t} L.5,${.5+t} L.5,0 M0,${.5-t} L.5,${.5-t}`},"":{1:(o,t)=>`M0,.5 L${.5+o},.5 L${.5+o},0 M${.5-o},.5 L${.5-o},0`},"":{1:(o,t)=>`M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0 M0,${.5+t} L${.5+o},${.5+t} L${.5+o},0`},"":{1:(o,t)=>`M.5,0 L.5,1 M.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1 M${.5+o},.5 L1,.5`},"":{1:(o,t)=>`M${.5-o},0 L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1 M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0`},"":{1:(o,t)=>`M.5,0 L.5,1 M0,${.5-t} L.5,${.5-t} M0,${.5+t} L.5,${.5+t}`},"":{1:(o,t)=>`M0,.5 L${.5-o},.5 M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1`},"":{1:(o,t)=>`M${.5+o},0 L${.5+o},1 M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0`},"":{1:(o,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t} M.5,${.5+t} L.5,1`},"":{1:(o,t)=>`M0,.5 L1,.5 M${.5-o},.5 L${.5-o},1 M${.5+o},.5 L${.5+o},1`},"":{1:(o,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1`},"":{1:(o,t)=>`M.5,0 L.5,${.5-t} M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M0,.5 L1,.5 M${.5-o},.5 L${.5-o},0 M${.5+o},.5 L${.5+o},0`},"":{1:(o,t)=>`M0,${.5+t} L1,${.5+t} M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0 M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0`},"":{1:(o,t)=>`M.5,0 L.5,1 M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M0,.5 L1,.5 M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1`},"":{1:(o,t)=>`M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1 M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0 M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0`},"":{1:"M1,0 L0,1"},"":{1:"M0,0 L1,1"},"":{1:"M1,0 L0,1 M0,0 L1,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{1:(o,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,1,.5`},"":{1:(o,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,0,.5`},"":{1:(o,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,0,.5`},"":{1:(o,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,1,.5`}},c.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.tryDrawCustomChar=function(o,t,l,s,i,h,p,v){const w=c.blockElementDefinitions[t];if(w)return function(A,T,B,F,D,H){for(let L=0;L<T.length;L++){const I=T[L],O=D/8,P=H/8;A.fillRect(B+I.x*O,F+I.y*P,I.w*O,I.h*P)}}(o,w,l,s,i,h),!0;const m=f[t];if(m)return function(A,T,B,F,D,H){let L=u.get(T);L||(L=new Map,u.set(T,L));const I=A.fillStyle;if(typeof I!="string")throw new Error(`Unexpected fillStyle type "${I}"`);let O=L.get(I);if(!O){const P=T[0].length,Q=T.length,z=document.createElement("canvas");z.width=P,z.height=Q;const X=(0,g.throwIfFalsy)(z.getContext("2d")),K=new ImageData(P,Q);let ie,G,j,W;if(I.startsWith("#"))ie=parseInt(I.slice(1,3),16),G=parseInt(I.slice(3,5),16),j=parseInt(I.slice(5,7),16),W=I.length>7&&parseInt(I.slice(7,9),16)||1;else{if(!I.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${I}" when drawing pattern glyph`);[ie,G,j,W]=I.substring(5,I.length-1).split(",").map(te=>parseFloat(te))}for(let te=0;te<Q;te++)for(let ne=0;ne<P;ne++)K.data[4*(te*P+ne)]=ie,K.data[4*(te*P+ne)+1]=G,K.data[4*(te*P+ne)+2]=j,K.data[4*(te*P+ne)+3]=T[te][ne]*(255*W);X.putImageData(K,0,0),O=(0,g.throwIfFalsy)(A.createPattern(z,null)),L.set(I,O)}A.fillStyle=O,A.fillRect(B,F,D,H)}(o,m,l,s,i,h),!0;const b=c.boxDrawingDefinitions[t];if(b)return function(A,T,B,F,D,H,L){A.strokeStyle=A.fillStyle;for(const[I,O]of Object.entries(T)){let P;A.beginPath(),A.lineWidth=L*Number.parseInt(I),P=typeof O=="function"?O(.15,.15/H*D):O;for(const Q of P.split(" ")){const z=Q[0],X=C[z];if(!X){console.error(`Could not find drawing instructions for "${z}"`);continue}const K=Q.substring(1).split(",");K[0]&&K[1]&&X(A,_(K,D,H,B,F,!0,L))}A.stroke(),A.closePath()}}(o,b,l,s,i,h,v),!0;const E=c.powerlineDefinitions[t];return!!E&&(function(A,T,B,F,D,H,L,I){var O,P;const Q=new Path2D;Q.rect(B,F,D,H),A.clip(Q),A.beginPath();const z=L/12;A.lineWidth=I*z;for(const X of T.d.split(" ")){const K=X[0],ie=C[K];if(!ie){console.error(`Could not find drawing instructions for "${K}"`);continue}const G=X.substring(1).split(",");G[0]&&G[1]&&ie(A,_(G,D,H,B,F,!1,I,((O=T.leftPadding)!==null&&O!==void 0?O:0)*(z/2),((P=T.rightPadding)!==null&&P!==void 0?P:0)*(z/2)))}T.type===1?(A.strokeStyle=A.fillStyle,A.stroke()):A.fill(),A.closePath()}(o,E,l,s,i,h,p,v),!0)};const u=new Map;function d(o,t,l=0){return Math.max(Math.min(o,t),l)}const C={C:(o,t)=>o.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]),L:(o,t)=>o.lineTo(t[0],t[1]),M:(o,t)=>o.moveTo(t[0],t[1])};function _(o,t,l,s,i,h,p,v=0,w=0){const m=o.map(b=>parseFloat(b)||parseInt(b));if(m.length<2)throw new Error("Too few arguments for instruction");for(let b=0;b<m.length;b+=2)m[b]*=t-v*p-w*p,h&&m[b]!==0&&(m[b]=d(Math.round(m[b]+.5)-.5,t,0)),m[b]+=s+v*p;for(let b=1;b<m.length;b+=2)m[b]*=l,h&&m[b]!==0&&(m[b]=d(Math.round(m[b]+.5)-.5,l,0)),m[b]+=i;return m}},56:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.observeDevicePixelDimensions=void 0;const g=y(859);c.observeDevicePixelDimensions=function(f,u,d){let C=new u.ResizeObserver(_=>{const o=_.find(s=>s.target===f);if(!o)return;if(!("devicePixelContentBoxSize"in o))return C==null||C.disconnect(),void(C=void 0);const t=o.devicePixelContentBoxSize[0].inlineSize,l=o.devicePixelContentBoxSize[0].blockSize;t>0&&l>0&&d(t,l)});try{C.observe(f,{box:["device-pixel-content-box"]})}catch{C.disconnect(),C=void 0}return(0,g.toDisposable)(()=>C==null?void 0:C.disconnect())}},374:($,c)=>{function y(g){return 57508<=g&&g<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(g){if(!g)throw new Error("value must not be falsy");return g},c.isPowerlineGlyph=y,c.isRestrictedPowerlineGlyph=function(g){return 57520<=g&&g<=57527},c.excludeFromContrastRatioDemands=function(g){return y(g)||function(f){return 9472<=f&&f<=9631}(g)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createSelectionRenderModel=void 0;class y{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(f,u,d,C=!1){if(this.selectionStart=u,this.selectionEnd=d,!u||!d||u[0]===d[0]&&u[1]===d[1])return void this.clear();const _=u[1]-f.buffer.active.viewportY,o=d[1]-f.buffer.active.viewportY,t=Math.max(_,0),l=Math.min(o,f.rows-1);t>=f.rows||l<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=C,this.viewportStartRow=_,this.viewportEndRow=o,this.viewportCappedStartRow=t,this.viewportCappedEndRow=l,this.startCol=u[0],this.endCol=d[0])}isCellSelected(f,u,d){return!!this.hasSelection&&(d-=f.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?u>=this.startCol&&d>=this.viewportCappedStartRow&&u<this.endCol&&d<=this.viewportCappedEndRow:u<this.startCol&&d>=this.viewportCappedStartRow&&u>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&u>=this.startCol&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&u>=this.startCol)}}c.createSelectionRenderModel=function(){return new y}},509:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextureAtlas=void 0;const g=y(237),f=y(855),u=y(147),d=y(160),C=y(860),_=y(374),o=y(485),t=y(385),l=y(345),s={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let i;class h{constructor(b,E,A){this._document=b,this._config=E,this._unicodeService=A,this._didWarmUp=!1,this._cacheMap=new o.FourKeyMap,this._cacheMapCombined=new o.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new u.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new l.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new l.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=w(b,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,_.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}get pages(){return this._pages}dispose(){for(const b of this.pages)b.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const b=new t.IdleTaskQueue;for(let E=33;E<126;E++)b.enqueue(()=>{if(!this._cacheMap.get(E,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT)){const A=this._drawToCache(E,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT);this._cacheMap.set(E,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT,A)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const b of this._pages)b.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){h.maxAtlasPages&&this._pages.length>=Math.max(4,h.maxAtlasPages/2)&&queueMicrotask(()=>{const E=this._pages.filter(L=>2*L.canvas.width<=(h.maxTextureSize||4096)).sort((L,I)=>I.canvas.width!==L.canvas.width?I.canvas.width-L.canvas.width:I.percentageUsed-L.percentageUsed);let A=-1,T=0;for(let L=0;L<E.length;L++)if(E[L].canvas.width!==T)A=L,T=E[L].canvas.width;else if(L-A==3)break;const B=E.slice(A,A+4),F=B.map(L=>L.glyphs[0].texturePage).sort((L,I)=>L>I?1:-1),D=F[0],H=this._mergePages(B,D);H.version++,this._pages[D]=H;for(let L=F.length-1;L>=1;L--)this._deletePage(F[L]);this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(H.canvas)});const b=new p(this._document,this._textureSize);return this._pages.push(b),this._activePages.push(b),this._onAddTextureAtlasCanvas.fire(b.canvas),b}_mergePages(b,E){const A=2*b[0].canvas.width,T=new p(this._document,A,b);for(const[B,F]of b.entries()){const D=B*F.canvas.width%A,H=Math.floor(B/2)*F.canvas.height;T.ctx.drawImage(F.canvas,D,H);for(const I of F.glyphs)I.texturePage=E,I.sizeClipSpace.x=I.size.x/A,I.sizeClipSpace.y=I.size.y/A,I.texturePosition.x+=D,I.texturePosition.y+=H,I.texturePositionClipSpace.x=I.texturePosition.x/A,I.texturePositionClipSpace.y=I.texturePosition.y/A;this._onRemoveTextureAtlasCanvas.fire(F.canvas);const L=this._activePages.indexOf(F);L!==-1&&this._activePages.splice(L,1)}return T}_deletePage(b){this._pages.splice(b,1);for(let E=b;E<this._pages.length;E++){const A=this._pages[E];for(const T of A.glyphs)T.texturePage--;A.version++}}getRasterizedGlyphCombinedChar(b,E,A,T){return this._getFromCacheMap(this._cacheMapCombined,b,E,A,T)}getRasterizedGlyph(b,E,A,T){return this._getFromCacheMap(this._cacheMap,b,E,A,T)}_getFromCacheMap(b,E,A,T,B){return i=b.get(E,A,T,B),i||(i=this._drawToCache(E,A,T,B),b.set(E,A,T,B,i)),i}_getColorFromAnsiIndex(b){if(b>=this._config.colors.ansi.length)throw new Error("No color found for idx "+b);return this._config.colors.ansi[b]}_getBackgroundColor(b,E,A,T){if(this._config.allowTransparency)return d.NULL_COLOR;let B;switch(b){case 16777216:case 33554432:B=this._getColorFromAnsiIndex(E);break;case 50331648:const F=u.AttributeData.toColorRGB(E);B=d.rgba.toColor(F[0],F[1],F[2]);break;default:B=A?this._config.colors.foreground:this._config.colors.background}return T&&(B=d.color.blend(this._config.colors.background,d.color.multiplyOpacity(B,g.DIM_OPACITY))),B}_getForegroundColor(b,E,A,T,B,F,D,H,L,I){const O=this._getMinimumContrastColor(b,E,A,T,B,F,!1,L,I);if(O)return O;let P;switch(B){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&L&&F<8&&(F+=8),P=this._getColorFromAnsiIndex(F);break;case 50331648:const Q=u.AttributeData.toColorRGB(F);P=d.rgba.toColor(Q[0],Q[1],Q[2]);break;default:P=D?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(P=d.color.opaque(P)),H&&(P=d.color.multiplyOpacity(P,g.DIM_OPACITY)),P}_resolveBackgroundRgba(b,E,A){switch(b){case 16777216:case 33554432:return this._getColorFromAnsiIndex(E).rgba;case 50331648:return E<<8;default:return A?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(b,E,A,T){switch(b){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&T&&E<8&&(E+=8),this._getColorFromAnsiIndex(E).rgba;case 50331648:return E<<8;default:return A?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(b,E,A,T,B,F,D,H,L){if(this._config.minimumContrastRatio===1||L)return;const I=this._config.colors.contrastCache.getColor(b,T);if(I!==void 0)return I||void 0;const O=this._resolveBackgroundRgba(E,A,D),P=this._resolveForegroundRgba(B,F,D,H),Q=d.rgba.ensureContrastRatio(O,P,this._config.minimumContrastRatio);if(!Q)return void this._config.colors.contrastCache.setColor(b,T,null);const z=d.rgba.toColor(Q>>24&255,Q>>16&255,Q>>8&255);return this._config.colors.contrastCache.setColor(b,T,z),z}_drawToCache(b,E,A,T){const B=typeof b=="number"?String.fromCharCode(b):b,F=this._config.deviceCellWidth*Math.max(B.length,2)+4;this._tmpCanvas.width<F&&(this._tmpCanvas.width=F);const D=this._config.deviceCellHeight+8;if(this._tmpCanvas.height<D&&(this._tmpCanvas.height=D),this._tmpCtx.save(),this._workAttributeData.fg=A,this._workAttributeData.bg=E,this._workAttributeData.extended.ext=T,this._workAttributeData.isInvisible())return s;const H=!!this._workAttributeData.isBold(),L=!!this._workAttributeData.isInverse(),I=!!this._workAttributeData.isDim(),O=!!this._workAttributeData.isItalic(),P=!!this._workAttributeData.isUnderline(),Q=!!this._workAttributeData.isStrikethrough();let z=this._workAttributeData.getFgColor(),X=this._workAttributeData.getFgColorMode(),K=this._workAttributeData.getBgColor(),ie=this._workAttributeData.getBgColorMode();if(L){const Ce=z;z=K,K=Ce;const Ae=X;X=ie,ie=Ae}const G=this._getBackgroundColor(ie,K,L,I);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=G.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const j=H?this._config.fontWeightBold:this._config.fontWeight,W=O?"italic":"";this._tmpCtx.font=`${W} ${j} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=g.TEXT_BASELINE;const te=B.length===1&&(0,_.isPowerlineGlyph)(B.charCodeAt(0)),ne=B.length===1&&(0,_.isRestrictedPowerlineGlyph)(B.charCodeAt(0)),be=this._getForegroundColor(E,ie,K,A,X,z,L,I,H,(0,_.excludeFromContrastRatioDemands)(B.charCodeAt(0)));this._tmpCtx.fillStyle=be.css;const he=ne?0:4;let ke=!1;this._config.customGlyphs!==!1&&(ke=(0,C.tryDrawCustomChar)(this._tmpCtx,B,he,he,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let ee,Ee=!te;if(ee=typeof b=="number"?this._unicodeService.wcwidth(b):this._unicodeService.getStringCellWidth(b),P){this._tmpCtx.save();const Ce=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),Ae=Ce%2==1?.5:0;if(this._tmpCtx.lineWidth=Ce,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())Ee=!1,this._tmpCtx.strokeStyle=`rgb(${u.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{Ee=!1;let ze=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&ze<8&&(ze+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(ze).css}this._tmpCtx.beginPath();const Pe=he,Ne=Math.ceil(he+this._config.deviceCharHeight)-Ae,nt=he+this._config.deviceCharHeight+Ce-Ae,Qe=Math.ceil(he+this._config.deviceCharHeight+2*Ce)-Ae;for(let ze=0;ze<ee;ze++){this._tmpCtx.save();const Me=Pe+ze*this._config.deviceCellWidth,Ve=Pe+(ze+1)*this._config.deviceCellWidth,Ct=Me+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne),this._tmpCtx.moveTo(Me,Qe),this._tmpCtx.lineTo(Ve,Qe);break;case 3:const ot=Ce<=1?Qe:Math.ceil(he+this._config.deviceCharHeight-Ce/2)-Ae,ft=Ce<=1?Ne:Math.ceil(he+this._config.deviceCharHeight+Ce/2)-Ae,kt=new Path2D;kt.rect(Me,Ne,this._config.deviceCellWidth,Qe-Ne),this._tmpCtx.clip(kt),this._tmpCtx.moveTo(Me-this._config.deviceCellWidth/2,nt),this._tmpCtx.bezierCurveTo(Me-this._config.deviceCellWidth/2,ft,Me,ft,Me,nt),this._tmpCtx.bezierCurveTo(Me,ot,Ct,ot,Ct,nt),this._tmpCtx.bezierCurveTo(Ct,ft,Ve,ft,Ve,nt),this._tmpCtx.bezierCurveTo(Ve,ot,Ve+this._config.deviceCellWidth/2,ot,Ve+this._config.deviceCellWidth/2,nt);break;case 4:this._tmpCtx.setLineDash([2*this._config.devicePixelRatio,this._config.devicePixelRatio]),this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne);break;default:this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ke&&this._config.fontSize>=12&&!this._config.allowTransparency&&B!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const ze=this._tmpCtx.measureText(B);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in ze&&ze.actualBoundingBoxDescent>0){this._tmpCtx.save();const Me=new Path2D;Me.rect(Pe,Ne-Math.ceil(Ce/2),this._config.deviceCellWidth,Qe-Ne+Math.ceil(Ce/2)),this._tmpCtx.clip(Me),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=G.css,this._tmpCtx.strokeText(B,he,he+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(ke||this._tmpCtx.fillText(B,he,he+this._config.deviceCharHeight),B==="_"&&!this._config.allowTransparency){let Ce=v(this._tmpCtx.getImageData(he,he,this._config.deviceCellWidth,this._config.deviceCellHeight),G,be,Ee);if(Ce)for(let Ae=1;Ae<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=G.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(B,he,he+this._config.deviceCharHeight-Ae),Ce=v(this._tmpCtx.getImageData(he,he,this._config.deviceCellWidth,this._config.deviceCellHeight),G,be,Ee),Ce);Ae++);}if(Q){const Ce=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),Ae=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=Ce,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(he,he+Math.floor(this._config.deviceCharHeight/2)-Ae),this._tmpCtx.lineTo(he+this._config.deviceCharWidth*ee,he+Math.floor(this._config.deviceCharHeight/2)-Ae),this._tmpCtx.stroke()}this._tmpCtx.restore();const fe=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let st;if(st=this._config.allowTransparency?function(Ce){for(let Ae=0;Ae<Ce.data.length;Ae+=4)if(Ce.data[Ae+3]>0)return!1;return!0}(fe):v(fe,G,be,Ee),st)return s;const Re=this._findGlyphBoundingBox(fe,this._workBoundingBox,F,ne,ke,he);let re,xe;for(;;){if(this._activePages.length===0){const Ce=this._createNewPage();re=Ce,xe=Ce.currentRow,xe.height=Re.size.y;break}re=this._activePages[this._activePages.length-1],xe=re.currentRow;for(const Ce of this._activePages)Re.size.y<=Ce.currentRow.height&&(re=Ce,xe=Ce.currentRow);for(let Ce=this._activePages.length-1;Ce>=0;Ce--)for(const Ae of this._activePages[Ce].fixedRows)Ae.height<=xe.height&&Re.size.y<=Ae.height&&(re=this._activePages[Ce],xe=Ae);if(xe.y+Re.size.y>=re.canvas.height||xe.height>Re.size.y+2){let Ce=!1;if(re.currentRow.y+re.currentRow.height+Re.size.y>=re.canvas.height){let Ae;for(const Pe of this._activePages)if(Pe.currentRow.y+Pe.currentRow.height+Re.size.y<Pe.canvas.height){Ae=Pe;break}if(Ae)re=Ae;else{const Pe=this._createNewPage();re=Pe,xe=Pe.currentRow,xe.height=Re.size.y,Ce=!0}}Ce||(re.currentRow.height>0&&re.fixedRows.push(re.currentRow),xe={x:0,y:re.currentRow.y+re.currentRow.height,height:Re.size.y},re.fixedRows.push(xe),re.currentRow={x:0,y:xe.y+xe.height,height:0})}if(xe.x+Re.size.x<=re.canvas.width)break;xe===re.currentRow?(xe.x=0,xe.y+=xe.height,xe.height=0):re.fixedRows.splice(re.fixedRows.indexOf(xe),1)}return Re.texturePage=this._pages.indexOf(re),Re.texturePosition.x=xe.x,Re.texturePosition.y=xe.y,Re.texturePositionClipSpace.x=xe.x/re.canvas.width,Re.texturePositionClipSpace.y=xe.y/re.canvas.height,Re.sizeClipSpace.x/=re.canvas.width,Re.sizeClipSpace.y/=re.canvas.height,xe.height=Math.max(xe.height,Re.size.y),xe.x+=Re.size.x,re.ctx.putImageData(fe,Re.texturePosition.x-this._workBoundingBox.left,Re.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,Re.size.x,Re.size.y),re.addGlyph(Re),re.version++,Re}_findGlyphBoundingBox(b,E,A,T,B,F){E.top=0;const D=T?this._config.deviceCellHeight:this._tmpCanvas.height,H=T?this._config.deviceCellWidth:A;let L=!1;for(let I=0;I<D;I++){for(let O=0;O<H;O++){const P=I*this._tmpCanvas.width*4+4*O+3;if(b.data[P]!==0){E.top=I,L=!0;break}}if(L)break}E.left=0,L=!1;for(let I=0;I<F+H;I++){for(let O=0;O<D;O++){const P=O*this._tmpCanvas.width*4+4*I+3;if(b.data[P]!==0){E.left=I,L=!0;break}}if(L)break}E.right=H,L=!1;for(let I=F+H-1;I>=F;I--){for(let O=0;O<D;O++){const P=O*this._tmpCanvas.width*4+4*I+3;if(b.data[P]!==0){E.right=I,L=!0;break}}if(L)break}E.bottom=D,L=!1;for(let I=D-1;I>=0;I--){for(let O=0;O<H;O++){const P=I*this._tmpCanvas.width*4+4*O+3;if(b.data[P]!==0){E.bottom=I,L=!0;break}}if(L)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:E.right-E.left+1,y:E.bottom-E.top+1},sizeClipSpace:{x:E.right-E.left+1,y:E.bottom-E.top+1},offset:{x:-E.left+F+(T||B?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-E.top+F+(T||B?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}c.TextureAtlas=h;class p{constructor(b,E,A){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],A)for(const T of A)this._glyphs.push(...T.glyphs),this._usedPixels+=T._usedPixels;this.canvas=w(b,E,E),this.ctx=(0,_.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(b){this._glyphs.push(b),this._usedPixels+=b.size.x*b.size.y}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function v(m,b,E,A){const T=b.rgba>>>24,B=b.rgba>>>16&255,F=b.rgba>>>8&255,D=E.rgba>>>24,H=E.rgba>>>16&255,L=E.rgba>>>8&255,I=Math.floor((Math.abs(T-D)+Math.abs(B-H)+Math.abs(F-L))/12);let O=!0;for(let P=0;P<m.data.length;P+=4)m.data[P]===T&&m.data[P+1]===B&&m.data[P+2]===F||A&&Math.abs(m.data[P]-T)+Math.abs(m.data[P+1]-B)+Math.abs(m.data[P+2]-F)<I?m.data[P+3]=0:O=!1;return O}function w(m,b,E){const A=m.createElement("canvas");return A.width=b,A.height=E,A}},577:function($,c,y){var g=this&&this.__decorate||function(l,s,i,h){var p,v=arguments.length,w=v<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,i):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(l,s,i,h);else for(var m=l.length-1;m>=0;m--)(p=l[m])&&(w=(v<3?p(w):v>3?p(s,i,w):p(s,i))||w);return v>3&&w&&Object.defineProperty(s,i,w),w},f=this&&this.__param||function(l,s){return function(i,h){s(i,h,l)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const u=y(147),d=y(855),C=y(782),_=y(97);class o extends u.AttributeData{constructor(s,i,h){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=i,this._width=h}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=o;let t=class Ji{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new C.CellData}register(s){const i={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(i),i.id}deregister(s){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===s)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(s);if(!i||i.length===0)return[];const h=[],p=i.translateToString(!0);let v=0,w=0,m=0,b=i.getFg(0),E=i.getBg(0);for(let A=0;A<i.getTrimmedLength();A++)if(i.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==E){if(A-v>1){const T=this._getJoinedRanges(p,m,w,i,v);for(let B=0;B<T.length;B++)h.push(T[B])}v=A,m=w,b=this._workCell.fg,E=this._workCell.bg}w+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-v>1){const A=this._getJoinedRanges(p,m,w,i,v);for(let T=0;T<A.length;T++)h.push(A[T])}return h}_getJoinedRanges(s,i,h,p,v){const w=s.substring(i,h);let m=[];try{m=this._characterJoiners[0].handler(w)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{const E=this._characterJoiners[b].handler(w);for(let A=0;A<E.length;A++)Ji._mergeRanges(m,E[A])}catch(E){console.error(E)}return this._stringRangesToCellRanges(m,p,v),m}_stringRangesToCellRanges(s,i,h){let p=0,v=!1,w=0,m=s[p];if(m){for(let b=h;b<this._bufferService.cols;b++){const E=i.getWidth(b),A=i.getString(b).length||d.WHITESPACE_CELL_CHAR.length;if(E!==0){if(!v&&m[0]<=w&&(m[0]=b,v=!0),m[1]<=w){if(m[1]=b,m=s[++p],!m)break;m[0]<=w?(m[0]=b,v=!0):v=!1}w+=A}}m&&(m[1]=this._bufferService.cols)}}static _mergeRanges(s,i){let h=!1;for(let p=0;p<s.length;p++){const v=s[p];if(h){if(i[1]<=v[0])return s[p-1][1]=i[1],s;if(i[1]<=v[1])return s[p-1][1]=Math.max(i[1],v[1]),s.splice(p,1),s;s.splice(p,1),p--}else{if(i[1]<=v[0])return s.splice(p,0,i),s;if(i[1]<=v[1])return v[0]=Math.min(i[0],v[0]),s;i[0]<v[1]&&(v[0]=Math.min(i[0],v[0]),h=!0)}}return h?s[s.length-1][1]=i[1]:s.push(i),s}};t=g([f(0,_.IBufferService)],t),c.CharacterJoinerService=t},160:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const g=y(399);let f=0,u=0,d=0,C=0;var _,o,t;function l(i){const h=i.toString(16);return h.length<2?"0"+h:h}function s(i,h){return i<h?(h+.05)/(i+.05):(i+.05)/(h+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(i){i.toCss=function(h,p,v,w){return w!==void 0?`#${l(h)}${l(p)}${l(v)}${l(w)}`:`#${l(h)}${l(p)}${l(v)}`},i.toRgba=function(h,p,v,w=255){return(h<<24|p<<16|v<<8|w)>>>0}}(_=c.channels||(c.channels={})),function(i){function h(p,v){return C=Math.round(255*v),[f,u,d]=t.toChannels(p.rgba),{css:_.toCss(f,u,d,C),rgba:_.toRgba(f,u,d,C)}}i.blend=function(p,v){if(C=(255&v.rgba)/255,C===1)return{css:v.css,rgba:v.rgba};const w=v.rgba>>24&255,m=v.rgba>>16&255,b=v.rgba>>8&255,E=p.rgba>>24&255,A=p.rgba>>16&255,T=p.rgba>>8&255;return f=E+Math.round((w-E)*C),u=A+Math.round((m-A)*C),d=T+Math.round((b-T)*C),{css:_.toCss(f,u,d),rgba:_.toRgba(f,u,d)}},i.isOpaque=function(p){return(255&p.rgba)==255},i.ensureContrastRatio=function(p,v,w){const m=t.ensureContrastRatio(p.rgba,v.rgba,w);if(m)return t.toColor(m>>24&255,m>>16&255,m>>8&255)},i.opaque=function(p){const v=(255|p.rgba)>>>0;return[f,u,d]=t.toChannels(v),{css:_.toCss(f,u,d),rgba:v}},i.opacity=h,i.multiplyOpacity=function(p,v){return C=255&p.rgba,h(p,C*v/255)},i.toColorRGB=function(p){return[p.rgba>>24&255,p.rgba>>16&255,p.rgba>>8&255]}}(c.color||(c.color={})),function(i){let h,p;if(!g.isNode){const v=document.createElement("canvas");v.width=1,v.height=1;const w=v.getContext("2d",{willReadFrequently:!0});w&&(h=w,h.globalCompositeOperation="copy",p=h.createLinearGradient(0,0,1,1))}i.toColor=function(v){if(v.match(/#[\da-f]{3,8}/i))switch(v.length){case 4:return f=parseInt(v.slice(1,2).repeat(2),16),u=parseInt(v.slice(2,3).repeat(2),16),d=parseInt(v.slice(3,4).repeat(2),16),t.toColor(f,u,d);case 5:return f=parseInt(v.slice(1,2).repeat(2),16),u=parseInt(v.slice(2,3).repeat(2),16),d=parseInt(v.slice(3,4).repeat(2),16),C=parseInt(v.slice(4,5).repeat(2),16),t.toColor(f,u,d,C);case 7:return{css:v,rgba:(parseInt(v.slice(1),16)<<8|255)>>>0};case 9:return{css:v,rgba:parseInt(v.slice(1),16)>>>0}}const w=v.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return f=parseInt(w[1]),u=parseInt(w[2]),d=parseInt(w[3]),C=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),t.toColor(f,u,d,C);if(!h||!p)throw new Error("css.toColor: Unsupported css format");if(h.fillStyle=p,h.fillStyle=v,typeof h.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(h.fillRect(0,0,1,1),[f,u,d,C]=h.getImageData(0,0,1,1).data,C!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:_.toRgba(f,u,d,C),css:v}}}(c.css||(c.css={})),function(i){function h(p,v,w){const m=p/255,b=v/255,E=w/255;return .2126*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.7152*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.0722*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))}i.relativeLuminance=function(p){return h(p>>16&255,p>>8&255,255&p)},i.relativeLuminance2=h}(o=c.rgb||(c.rgb={})),function(i){function h(v,w,m){const b=v>>24&255,E=v>>16&255,A=v>>8&255;let T=w>>24&255,B=w>>16&255,F=w>>8&255,D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));for(;D<m&&(T>0||B>0||F>0);)T-=Math.max(0,Math.ceil(.1*T)),B-=Math.max(0,Math.ceil(.1*B)),F-=Math.max(0,Math.ceil(.1*F)),D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));return(T<<24|B<<16|F<<8|255)>>>0}function p(v,w,m){const b=v>>24&255,E=v>>16&255,A=v>>8&255;let T=w>>24&255,B=w>>16&255,F=w>>8&255,D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));for(;D<m&&(T<255||B<255||F<255);)T=Math.min(255,T+Math.ceil(.1*(255-T))),B=Math.min(255,B+Math.ceil(.1*(255-B))),F=Math.min(255,F+Math.ceil(.1*(255-F))),D=s(o.relativeLuminance2(T,B,F),o.relativeLuminance2(b,E,A));return(T<<24|B<<16|F<<8|255)>>>0}i.ensureContrastRatio=function(v,w,m){const b=o.relativeLuminance(v>>8),E=o.relativeLuminance(w>>8);if(s(b,E)<m){if(E<b){const B=h(v,w,m),F=s(b,o.relativeLuminance(B>>8));if(F<m){const D=p(v,w,m);return F>s(b,o.relativeLuminance(D>>8))?B:D}return B}const A=p(v,w,m),T=s(b,o.relativeLuminance(A>>8));if(T<m){const B=h(v,w,m);return T>s(b,o.relativeLuminance(B>>8))?A:B}return A}},i.reduceLuminance=h,i.increaseLuminance=p,i.toChannels=function(v){return[v>>24&255,v>>16&255,v>>8&255,255&v]},i.toColor=function(v,w,m,b){return{css:_.toCss(v,w,m,b),rgba:_.toRgba(v,w,m,b)}}}(t=c.rgba||(c.rgba={})),c.toPaddedHex=l,c.contrastRatio=s},345:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=y=>(this._listeners.push(y),{dispose:()=>{if(!this._disposed){for(let g=0;g<this._listeners.length;g++)if(this._listeners[g]===y)return void this._listeners.splice(g,1)}}})),this._event}fire(y,g){const f=[];for(let u=0;u<this._listeners.length;u++)f.push(this._listeners[u]);for(let u=0;u<f.length;u++)f[u].call(void 0,y,g)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(y,g){return y(f=>g.fire(f))}},859:($,c)=>{function y(g){for(const f of g)f.dispose();g.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const g of this._disposables)g.dispose();this._disposables.length=0}register(g){return this._disposables.push(g),g}unregister(g){const f=this._disposables.indexOf(g);f!==-1&&this._disposables.splice(f,1)}},c.toDisposable=function(g){return{dispose:g}},c.disposeArray=y,c.getDisposeArrayDisposable=function(g){return{dispose:()=>y(g)}}},485:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class y{constructor(){this._data={}}set(f,u,d){this._data[f]||(this._data[f]={}),this._data[f][u]=d}get(f,u){return this._data[f]?this._data[f][u]:void 0}clear(){this._data={}}}c.TwoKeyMap=y,c.FourKeyMap=class{constructor(){this._data=new y}set(g,f,u,d,C){this._data.get(g,f)||this._data.set(g,f,new y),this._data.get(g,f).set(u,d,C)}get(g,f,u,d){var C;return(C=this._data.get(g,f))===null||C===void 0?void 0:C.get(u,d)}clear(){this._data.clear()}}},399:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const y=c.isNode?"node":navigator.userAgent,g=c.isNode?"node":navigator.platform;c.isFirefox=y.includes("Firefox"),c.isLegacyEdge=y.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(y),c.getSafariVersion=function(){if(!c.isSafari)return 0;const f=y.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(g),c.isIpad=g==="iPad",c.isIphone=g==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(g),c.isLinux=g.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(y)},385:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const g=y(399);class f{constructor(){this._tasks=[],this._i=0}enqueue(C){this._tasks.push(C),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(C){this._idleCallback=void 0;let _=0,o=0,t=C.timeRemaining(),l=0;for(;this._i<this._tasks.length;){if(_=Date.now(),this._tasks[this._i]()||this._i++,_=Math.max(1,Date.now()-_),o=Math.max(_,o),l=C.timeRemaining(),1.5*o>l)return t-_<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-_))}ms`),void this._start();t=l}this.clear()}}class u extends f{_requestCallback(C){return setTimeout(()=>C(this._createDeadline(16)))}_cancelCallback(C){clearTimeout(C)}_createDeadline(C){const _=Date.now()+C;return{timeRemaining:()=>Math.max(0,_-Date.now())}}}c.PriorityTaskQueue=u,c.IdleTaskQueue=!g.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:u,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},147:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class y{constructor(){this.fg=0,this.bg=0,this.extended=new g}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new y;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=y;class g{constructor(u=0,d=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=d}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}clone(){return new g(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=g},782:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const g=y(133),f=y(855),u=y(147);class d extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(_){const o=new d;return o.setFromCharData(_),o}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,g.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(_){this.fg=_[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let o=!1;if(_[f.CHAR_DATA_CHAR_INDEX].length>2)o=!0;else if(_[f.CHAR_DATA_CHAR_INDEX].length===2){const t=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const l=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=l&&l<=57343?this.content=1024*(t-55296)+l-56320+65536|_[f.CHAR_DATA_WIDTH_INDEX]<<22:o=!0}else o=!0}else this.content=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|_[f.CHAR_DATA_WIDTH_INDEX]<<22;o&&(this.combinedData=_[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|_[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=d},855:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},133:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(y){return y>65535?(y-=65536,String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):String.fromCharCode(y)},c.utf32ToString=function(y,g=0,f=y.length){let u="";for(let d=g;d<f;++d){let C=y[d];C>65535?(C-=65536,u+=String.fromCharCode(55296+(C>>10))+String.fromCharCode(C%1024+56320)):u+=String.fromCharCode(C)}return u},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(y,g){const f=y.length;if(!f)return 0;let u=0,d=0;if(this._interim){const C=y.charCodeAt(d++);56320<=C&&C<=57343?g[u++]=1024*(this._interim-55296)+C-56320+65536:(g[u++]=this._interim,g[u++]=C),this._interim=0}for(let C=d;C<f;++C){const _=y.charCodeAt(C);if(55296<=_&&_<=56319){if(++C>=f)return this._interim=_,u;const o=y.charCodeAt(C);56320<=o&&o<=57343?g[u++]=1024*(_-55296)+o-56320+65536:(g[u++]=_,g[u++]=o)}else _!==65279&&(g[u++]=_)}return u}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(y,g){const f=y.length;if(!f)return 0;let u,d,C,_,o=0,t=0,l=0;if(this.interim[0]){let h=!1,p=this.interim[0];p&=(224&p)==192?31:(240&p)==224?15:7;let v,w=0;for(;(v=63&this.interim[++w])&&w<4;)p<<=6,p|=v;const m=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,b=m-w;for(;l<b;){if(l>=f)return 0;if(v=y[l++],(192&v)!=128){l--,h=!0;break}this.interim[w++]=v,p<<=6,p|=63&v}h||(m===2?p<128?l--:g[o++]=p:m===3?p<2048||p>=55296&&p<=57343||p===65279||(g[o++]=p):p<65536||p>1114111||(g[o++]=p)),this.interim.fill(0)}const s=f-4;let i=l;for(;i<f;){for(;!(!(i<s)||128&(u=y[i])||128&(d=y[i+1])||128&(C=y[i+2])||128&(_=y[i+3]));)g[o++]=u,g[o++]=d,g[o++]=C,g[o++]=_,i+=4;if(u=y[i++],u<128)g[o++]=u;else if((224&u)==192){if(i>=f)return this.interim[0]=u,o;if(d=y[i++],(192&d)!=128){i--;continue}if(t=(31&u)<<6|63&d,t<128){i--;continue}g[o++]=t}else if((240&u)==224){if(i>=f)return this.interim[0]=u,o;if(d=y[i++],(192&d)!=128){i--;continue}if(i>=f)return this.interim[0]=u,this.interim[1]=d,o;if(C=y[i++],(192&C)!=128){i--;continue}if(t=(15&u)<<12|(63&d)<<6|63&C,t<2048||t>=55296&&t<=57343||t===65279)continue;g[o++]=t}else if((248&u)==240){if(i>=f)return this.interim[0]=u,o;if(d=y[i++],(192&d)!=128){i--;continue}if(i>=f)return this.interim[0]=u,this.interim[1]=d,o;if(C=y[i++],(192&C)!=128){i--;continue}if(i>=f)return this.interim[0]=u,this.interim[1]=d,this.interim[2]=C,o;if(_=y[i++],(192&_)!=128){i--;continue}if(t=(7&u)<<18|(63&d)<<12|(63&C)<<6|63&_,t<65536||t>1114111)continue;g[o++]=t}}return o}}},726:($,c)=>{function y(g,f,u){f.di$target===f?f.di$dependencies.push({id:g,index:u}):(f.di$dependencies=[{id:g,index:u}],f.di$target=f)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(g){return g.di$dependencies||[]},c.createDecorator=function(g){if(c.serviceRegistry.has(g))return c.serviceRegistry.get(g);const f=function(u,d,C){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");y(f,u,C)};return f.toString=()=>g,c.serviceRegistry.set(g,f),f}},97:($,c,y)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const g=y(726);var f;c.IBufferService=(0,g.createDecorator)("BufferService"),c.ICoreMouseService=(0,g.createDecorator)("CoreMouseService"),c.ICoreService=(0,g.createDecorator)("CoreService"),c.ICharsetService=(0,g.createDecorator)("CharsetService"),c.IInstantiationService=(0,g.createDecorator)("InstantiationService"),(f=c.LogLevelEnum||(c.LogLevelEnum={}))[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f[f.OFF=4]="OFF",c.ILogService=(0,g.createDecorator)("LogService"),c.IOptionsService=(0,g.createDecorator)("OptionsService"),c.IOscLinkService=(0,g.createDecorator)("OscLinkService"),c.IUnicodeService=(0,g.createDecorator)("UnicodeService"),c.IDecorationService=(0,g.createDecorator)("DecorationService")}},se={};function ce($){var c=se[$];if(c!==void 0)return c.exports;var y=se[$]={exports:{}};return J[$].call(y.exports,y,y.exports,ce),y.exports}var _e={};return(()=>{var $=_e;Object.defineProperty($,"__esModule",{value:!0}),$.CanvasAddon=void 0;const c=ce(949),y=ce(345),g=ce(859);class f extends g.Disposable{constructor(){super(...arguments),this._onChangeTextureAtlas=this.register(new y.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new y.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event}get textureAtlas(){var d;return(d=this._renderer)===null||d===void 0?void 0:d.textureAtlas}activate(d){const C=d._core;if(!d.element)return void this.register(C.onWillOpen(()=>this.activate(d)));this._terminal=d;const _=C.coreService,o=C.optionsService,t=C.screenElement,l=C.linkifier2,s=C,i=s._bufferService,h=s._renderService,p=s._characterJoinerService,v=s._charSizeService,w=s._coreBrowserService,m=s._decorationService,b=s._themeService;this._renderer=new c.CanvasRenderer(d,t,l,i,v,o,p,_,w,m,b),this.register((0,y.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,y.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),h.setRenderer(this._renderer),h.handleResize(i.cols,i.rows),this.register((0,g.toDisposable)(()=>{var E;h.setRenderer(this._terminal._core._createRenderer()),h.handleResize(d.cols,d.rows),(E=this._renderer)===null||E===void 0||E.dispose(),this._renderer=void 0}))}}$.CanvasAddon=f})(),_e})()})})(Zi);var fn=Zi.exports,Qi={exports:{}};(function(V,U){(function(J,se){V.exports=se()})(self,function(){return(()=>{var J={};return(()=>{var se=J;Object.defineProperty(se,"__esModule",{value:!0}),se.FitAddon=void 0,se.FitAddon=class{constructor(){}activate(ce){this._terminal=ce}dispose(){}fit(){const ce=this.proposeDimensions();if(!ce||!this._terminal||isNaN(ce.cols)||isNaN(ce.rows))return;const _e=this._terminal._core;this._terminal.rows===ce.rows&&this._terminal.cols===ce.cols||(_e._renderService.clear(),this._terminal.resize(ce.cols,ce.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const ce=this._terminal._core,_e=ce._renderService.dimensions;if(_e.css.cell.width===0||_e.css.cell.height===0)return;const $=this._terminal.options.scrollback===0?0:ce.viewport.scrollBarWidth,c=window.getComputedStyle(this._terminal.element.parentElement),y=parseInt(c.getPropertyValue("height")),g=Math.max(0,parseInt(c.getPropertyValue("width"))),f=window.getComputedStyle(this._terminal.element),u=y-(parseInt(f.getPropertyValue("padding-top"))+parseInt(f.getPropertyValue("padding-bottom"))),d=g-(parseInt(f.getPropertyValue("padding-right"))+parseInt(f.getPropertyValue("padding-left")))-$;return{cols:Math.max(2,Math.floor(d/_e.css.cell.width)),rows:Math.max(1,Math.floor(u/_e.css.cell.height))}}}})(),J})()})})(Qi);var pn=Qi.exports,br={exports:{}};const _n={},gn=Object.freeze(Object.defineProperty({__proto__:null,default:_n},Symbol.toStringTag,{value:"Module"})),Vt=ln(gn);var Kt={},Xt={},Yt,Ci;function es(){return Ci||(Ci=1,Yt=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var U={},J=Symbol("test"),se=Object(J);if(typeof J=="string"||Object.prototype.toString.call(J)!=="[object Symbol]"||Object.prototype.toString.call(se)!=="[object Symbol]")return!1;var ce=42;U[J]=ce;for(J in U)return!1;if(typeof Object.keys=="function"&&Object.keys(U).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(U).length!==0)return!1;var _e=Object.getOwnPropertySymbols(U);if(_e.length!==1||_e[0]!==J||!Object.prototype.propertyIsEnumerable.call(U,J))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var $=Object.getOwnPropertyDescriptor(U,J);if($.value!==ce||$.enumerable!==!0)return!1}return!0}),Yt}var Zt,wi;function Cr(){if(wi)return Zt;wi=1;var V=es();return Zt=function(){return V()&&!!Symbol.toStringTag},Zt}var Jt,xi;function vn(){if(xi)return Jt;xi=1;var V=typeof Symbol<"u"&&Symbol,U=es();return Jt=function(){return typeof V!="function"||typeof Symbol!="function"||typeof V("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:U()},Jt}var Qt,Ei;function mn(){if(Ei)return Qt;Ei=1;var V={foo:{}},U=Object;return Qt=function(){return{__proto__:V}.foo===V.foo&&!({__proto__:null}instanceof U)},Qt}var er,Li;function yn(){if(Li)return er;Li=1;var V="Function.prototype.bind called on incompatible ",U=Object.prototype.toString,J=Math.max,se="[object Function]",ce=function(y,g){for(var f=[],u=0;u<y.length;u+=1)f[u]=y[u];for(var d=0;d<g.length;d+=1)f[d+y.length]=g[d];return f},_e=function(y,g){for(var f=[],u=g||0,d=0;u<y.length;u+=1,d+=1)f[d]=y[u];return f},$=function(c,y){for(var g="",f=0;f<c.length;f+=1)g+=c[f],f+1<c.length&&(g+=y);return g};return er=function(y){var g=this;if(typeof g!="function"||U.apply(g)!==se)throw new TypeError(V+g);for(var f=_e(arguments,1),u,d=function(){if(this instanceof u){var l=g.apply(this,ce(f,arguments));return Object(l)===l?l:this}return g.apply(y,ce(f,arguments))},C=J(0,g.length-f.length),_=[],o=0;o<C;o++)_[o]="$"+o;if(u=Function("binder","return function ("+$(_,",")+"){ return binder.apply(this,arguments); }")(d),g.prototype){var t=function(){};t.prototype=g.prototype,u.prototype=new t,t.prototype=null}return u},er}var tr,ki;function wr(){if(ki)return tr;ki=1;var V=yn();return tr=Function.prototype.bind||V,tr}var rr,Ri;function bn(){if(Ri)return rr;Ri=1;var V=Function.prototype.call,U=Object.prototype.hasOwnProperty,J=wr();return rr=J.call(V,U),rr}var ir,Ai;function St(){if(Ai)return ir;Ai=1;var V,U=SyntaxError,J=Function,se=TypeError,ce=function(T){try{return J('"use strict"; return ('+T+").constructor;")()}catch{}},_e=Object.getOwnPropertyDescriptor;if(_e)try{_e({},"")}catch{_e=null}var $=function(){throw new se},c=_e?function(){try{return arguments.callee,$}catch{try{return _e(arguments,"callee").get}catch{return $}}}():$,y=vn()(),g=mn()(),f=Object.getPrototypeOf||(g?function(T){return T.__proto__}:null),u={},d=typeof Uint8Array>"u"||!f?V:f(Uint8Array),C={"%AggregateError%":typeof AggregateError>"u"?V:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?V:ArrayBuffer,"%ArrayIteratorPrototype%":y&&f?f([][Symbol.iterator]()):V,"%AsyncFromSyncIteratorPrototype%":V,"%AsyncFunction%":u,"%AsyncGenerator%":u,"%AsyncGeneratorFunction%":u,"%AsyncIteratorPrototype%":u,"%Atomics%":typeof Atomics>"u"?V:Atomics,"%BigInt%":typeof BigInt>"u"?V:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?V:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?V:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?V:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?V:Float32Array,"%Float64Array%":typeof Float64Array>"u"?V:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?V:FinalizationRegistry,"%Function%":J,"%GeneratorFunction%":u,"%Int8Array%":typeof Int8Array>"u"?V:Int8Array,"%Int16Array%":typeof Int16Array>"u"?V:Int16Array,"%Int32Array%":typeof Int32Array>"u"?V:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&f?f(f([][Symbol.iterator]())):V,"%JSON%":typeof JSON=="object"?JSON:V,"%Map%":typeof Map>"u"?V:Map,"%MapIteratorPrototype%":typeof Map>"u"||!y||!f?V:f(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?V:Promise,"%Proxy%":typeof Proxy>"u"?V:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?V:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?V:Set,"%SetIteratorPrototype%":typeof Set>"u"||!y||!f?V:f(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?V:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&f?f(""[Symbol.iterator]()):V,"%Symbol%":y?Symbol:V,"%SyntaxError%":U,"%ThrowTypeError%":c,"%TypedArray%":d,"%TypeError%":se,"%Uint8Array%":typeof Uint8Array>"u"?V:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?V:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?V:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?V:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?V:WeakMap,"%WeakRef%":typeof WeakRef>"u"?V:WeakRef,"%WeakSet%":typeof WeakSet>"u"?V:WeakSet};if(f)try{null.error}catch(T){var _=f(f(T));C["%Error.prototype%"]=_}var o=function T(B){var F;if(B==="%AsyncFunction%")F=ce("async function () {}");else if(B==="%GeneratorFunction%")F=ce("function* () {}");else if(B==="%AsyncGeneratorFunction%")F=ce("async function* () {}");else if(B==="%AsyncGenerator%"){var D=T("%AsyncGeneratorFunction%");D&&(F=D.prototype)}else if(B==="%AsyncIteratorPrototype%"){var H=T("%AsyncGenerator%");H&&f&&(F=f(H.prototype))}return C[B]=F,F},t={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},l=wr(),s=bn(),i=l.call(Function.call,Array.prototype.concat),h=l.call(Function.apply,Array.prototype.splice),p=l.call(Function.call,String.prototype.replace),v=l.call(Function.call,String.prototype.slice),w=l.call(Function.call,RegExp.prototype.exec),m=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,b=/\\(\\)?/g,E=function(B){var F=v(B,0,1),D=v(B,-1);if(F==="%"&&D!=="%")throw new U("invalid intrinsic syntax, expected closing `%`");if(D==="%"&&F!=="%")throw new U("invalid intrinsic syntax, expected opening `%`");var H=[];return p(B,m,function(L,I,O,P){H[H.length]=O?p(P,b,"$1"):I||L}),H},A=function(B,F){var D=B,H;if(s(t,D)&&(H=t[D],D="%"+H[0]+"%"),s(C,D)){var L=C[D];if(L===u&&(L=o(D)),typeof L>"u"&&!F)throw new se("intrinsic "+B+" exists, but is not available. Please file an issue!");return{alias:H,name:D,value:L}}throw new U("intrinsic "+B+" does not exist!")};return ir=function(B,F){if(typeof B!="string"||B.length===0)throw new se("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof F!="boolean")throw new se('"allowMissing" argument must be a boolean');if(w(/^%?[^%]*%?$/,B)===null)throw new U("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var D=E(B),H=D.length>0?D[0]:"",L=A("%"+H+"%",F),I=L.name,O=L.value,P=!1,Q=L.alias;Q&&(H=Q[0],h(D,i([0,1],Q)));for(var z=1,X=!0;z<D.length;z+=1){var K=D[z],ie=v(K,0,1),G=v(K,-1);if((ie==='"'||ie==="'"||ie==="`"||G==='"'||G==="'"||G==="`")&&ie!==G)throw new U("property names with quotes must have matching quotes");if((K==="constructor"||!X)&&(P=!0),H+="."+K,I="%"+H+"%",s(C,I))O=C[I];else if(O!=null){if(!(K in O)){if(!F)throw new se("base intrinsic for "+B+" exists, but the property is not available.");return}if(_e&&z+1>=D.length){var j=_e(O,K);X=!!j,X&&"get"in j&&!("originalValue"in j.get)?O=j.get:O=O[K]}else X=s(O,K),O=O[K];X&&!P&&(C[I]=O)}}return O},ir}var sr={exports:{}},nr,Ti;function ts(){if(Ti)return nr;Ti=1;var V=St(),U=V("%Object.defineProperty%",!0),J=function(){if(U)try{return U({},"a",{value:1}),!0}catch{return!1}return!1};return J.hasArrayLengthDefineBug=function(){if(!J())return null;try{return U([],"length",{value:1}).length!==1}catch{return!0}},nr=J,nr}var or,Di;function xr(){if(Di)return or;Di=1;var V=St(),U=V("%Object.getOwnPropertyDescriptor%",!0);if(U)try{U([],"length")}catch{U=null}return or=U,or}var ar,Mi;function Sn(){if(Mi)return ar;Mi=1;var V=ts()(),U=St(),J=V&&U("%Object.defineProperty%",!0);if(J)try{J({},"a",{value:1})}catch{J=!1}var se=U("%SyntaxError%"),ce=U("%TypeError%"),_e=xr();return ar=function(c,y,g){if(!c||typeof c!="object"&&typeof c!="function")throw new ce("`obj` must be an object or a function`");if(typeof y!="string"&&typeof y!="symbol")throw new ce("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ce("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ce("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ce("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ce("`loose`, if provided, must be a boolean");var f=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,d=arguments.length>5?arguments[5]:null,C=arguments.length>6?arguments[6]:!1,_=!!_e&&_e(c,y);if(J)J(c,y,{configurable:d===null&&_?_.configurable:!d,enumerable:f===null&&_?_.enumerable:!f,value:g,writable:u===null&&_?_.writable:!u});else if(C||!f&&!u&&!d)c[y]=g;else throw new se("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},ar}var lr,Bi;function Cn(){if(Bi)return lr;Bi=1;var V=St(),U=Sn(),J=ts()(),se=xr(),ce=V("%TypeError%"),_e=V("%Math.floor%");return lr=function(c,y){if(typeof c!="function")throw new ce("`fn` is not a function");if(typeof y!="number"||y<0||y>4294967295||_e(y)!==y)throw new ce("`length` must be a positive 32-bit integer");var g=arguments.length>2&&!!arguments[2],f=!0,u=!0;if("length"in c&&se){var d=se(c,"length");d&&!d.configurable&&(f=!1),d&&!d.writable&&(u=!1)}return(f||u||!g)&&(J?U(c,"length",y,!0,!0):U(c,"length",y)),c},lr}var Oi;function rs(){return Oi||(Oi=1,function(V){var U=wr(),J=St(),se=Cn(),ce=J("%TypeError%"),_e=J("%Function.prototype.apply%"),$=J("%Function.prototype.call%"),c=J("%Reflect.apply%",!0)||U.call($,_e),y=J("%Object.defineProperty%",!0),g=J("%Math.max%");if(y)try{y({},"a",{value:1})}catch{y=null}V.exports=function(d){if(typeof d!="function")throw new ce("a function is required");var C=c(U,$,arguments);return se(C,1+g(0,d.length-(arguments.length-1)),!0)};var f=function(){return c(U,_e,arguments)};y?y(V.exports,"apply",{value:f}):V.exports.apply=f}(sr)),sr.exports}var cr,Ii;function is(){if(Ii)return cr;Ii=1;var V=St(),U=rs(),J=U(V("String.prototype.indexOf"));return cr=function(ce,_e){var $=V(ce,!!_e);return typeof $=="function"&&J(ce,".prototype.")>-1?U($):$},cr}var hr,Pi;function wn(){if(Pi)return hr;Pi=1;var V=Cr()(),U=is(),J=U("Object.prototype.toString"),se=function(c){return V&&c&&typeof c=="object"&&Symbol.toStringTag in c?!1:J(c)==="[object Arguments]"},ce=function(c){return se(c)?!0:c!==null&&typeof c=="object"&&typeof c.length=="number"&&c.length>=0&&J(c)!=="[object Array]"&&J(c.callee)==="[object Function]"},_e=function(){return se(arguments)}();return se.isLegacyArguments=ce,hr=_e?se:ce,hr}var ur,Ui;function xn(){if(Ui)return ur;Ui=1;var V=Object.prototype.toString,U=Function.prototype.toString,J=/^\s*(?:function)?\*/,se=Cr()(),ce=Object.getPrototypeOf,_e=function(){if(!se)return!1;try{return Function("return function*() {}")()}catch{}},$;return ur=function(y){if(typeof y!="function")return!1;if(J.test(U.call(y)))return!0;if(!se){var g=V.call(y);return g==="[object GeneratorFunction]"}if(!ce)return!1;if(typeof $>"u"){var f=_e();$=f?ce(f):!1}return ce(y)===$},ur}var dr,Fi;function En(){if(Fi)return dr;Fi=1;var V=Function.prototype.toString,U=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,J,se;if(typeof U=="function"&&typeof Object.defineProperty=="function")try{J=Object.defineProperty({},"length",{get:function(){throw se}}),se={},U(function(){throw 42},null,J)}catch(s){s!==se&&(U=null)}else U=null;var ce=/^\s*class\b/,_e=function(i){try{var h=V.call(i);return ce.test(h)}catch{return!1}},$=function(i){try{return _e(i)?!1:(V.call(i),!0)}catch{return!1}},c=Object.prototype.toString,y="[object Object]",g="[object Function]",f="[object GeneratorFunction]",u="[object HTMLAllCollection]",d="[object HTML document.all class]",C="[object HTMLCollection]",_=typeof Symbol=="function"&&!!Symbol.toStringTag,o=!(0 in[,]),t=function(){return!1};if(typeof document=="object"){var l=document.all;c.call(l)===c.call(document.all)&&(t=function(i){if((o||!i)&&(typeof i>"u"||typeof i=="object"))try{var h=c.call(i);return(h===u||h===d||h===C||h===y)&&i("")==null}catch{}return!1})}return dr=U?function(i){if(t(i))return!0;if(!i||typeof i!="function"&&typeof i!="object")return!1;try{U(i,null,J)}catch(h){if(h!==se)return!1}return!_e(i)&&$(i)}:function(i){if(t(i))return!0;if(!i||typeof i!="function"&&typeof i!="object")return!1;if(_)return $(i);if(_e(i))return!1;var h=c.call(i);return h!==g&&h!==f&&!/^\[object HTML/.test(h)?!1:$(i)},dr}var fr,Hi;function Ln(){if(Hi)return fr;Hi=1;var V=En(),U=Object.prototype.toString,J=Object.prototype.hasOwnProperty,se=function(y,g,f){for(var u=0,d=y.length;u<d;u++)J.call(y,u)&&(f==null?g(y[u],u,y):g.call(f,y[u],u,y))},ce=function(y,g,f){for(var u=0,d=y.length;u<d;u++)f==null?g(y.charAt(u),u,y):g.call(f,y.charAt(u),u,y)},_e=function(y,g,f){for(var u in y)J.call(y,u)&&(f==null?g(y[u],u,y):g.call(f,y[u],u,y))},$=function(y,g,f){if(!V(g))throw new TypeError("iterator must be a function");var u;arguments.length>=3&&(u=f),U.call(y)==="[object Array]"?se(y,g,u):typeof y=="string"?ce(y,g,u):_e(y,g,u)};return fr=$,fr}var pr,Ni;function kn(){if(Ni)return pr;Ni=1;var V=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],U=typeof globalThis>"u"?Vi:globalThis;return pr=function(){for(var se=[],ce=0;ce<V.length;ce++)typeof U[V[ce]]=="function"&&(se[se.length]=V[ce]);return se},pr}var _r,Wi;function ss(){if(Wi)return _r;Wi=1;var V=Ln(),U=kn(),J=rs(),se=is(),ce=xr(),_e=se("Object.prototype.toString"),$=Cr()(),c=typeof globalThis>"u"?Vi:globalThis,y=U(),g=se("String.prototype.slice"),f=Object.getPrototypeOf,u=se("Array.prototype.indexOf",!0)||function(t,l){for(var s=0;s<t.length;s+=1)if(t[s]===l)return s;return-1},d={__proto__:null};$&&ce&&f?V(y,function(o){var t=new c[o];if(Symbol.toStringTag in t){var l=f(t),s=ce(l,Symbol.toStringTag);if(!s){var i=f(l);s=ce(i,Symbol.toStringTag)}d["$"+o]=J(s.get)}}):V(y,function(o){var t=new c[o],l=t.slice||t.set;l&&(d["$"+o]=J(l))});var C=function(t){var l=!1;return V(d,function(s,i){if(!l)try{"$"+s(t)===i&&(l=g(i,1))}catch{}}),l},_=function(t){var l=!1;return V(d,function(s,i){if(!l)try{s(t),l=g(i,1)}catch{}}),l};return _r=function(t){if(!t||typeof t!="object")return!1;if(!$){var l=g(_e(t),8,-1);return u(y,l)>-1?l:l!=="Object"?!1:_(t)}return ce?C(t):null},_r}var gr,Gi;function Rn(){if(Gi)return gr;Gi=1;var V=ss();return gr=function(J){return!!V(J)},gr}var zi;function An(){return zi||(zi=1,function(V){var U=wn(),J=xn(),se=ss(),ce=Rn();function _e(re){return re.call.bind(re)}var $=typeof BigInt<"u",c=typeof Symbol<"u",y=_e(Object.prototype.toString),g=_e(Number.prototype.valueOf),f=_e(String.prototype.valueOf),u=_e(Boolean.prototype.valueOf);if($)var d=_e(BigInt.prototype.valueOf);if(c)var C=_e(Symbol.prototype.valueOf);function _(re,xe){if(typeof re!="object")return!1;try{return xe(re),!0}catch{return!1}}V.isArgumentsObject=U,V.isGeneratorFunction=J,V.isTypedArray=ce;function o(re){return typeof Promise<"u"&&re instanceof Promise||re!==null&&typeof re=="object"&&typeof re.then=="function"&&typeof re.catch=="function"}V.isPromise=o;function t(re){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(re):ce(re)||X(re)}V.isArrayBufferView=t;function l(re){return se(re)==="Uint8Array"}V.isUint8Array=l;function s(re){return se(re)==="Uint8ClampedArray"}V.isUint8ClampedArray=s;function i(re){return se(re)==="Uint16Array"}V.isUint16Array=i;function h(re){return se(re)==="Uint32Array"}V.isUint32Array=h;function p(re){return se(re)==="Int8Array"}V.isInt8Array=p;function v(re){return se(re)==="Int16Array"}V.isInt16Array=v;function w(re){return se(re)==="Int32Array"}V.isInt32Array=w;function m(re){return se(re)==="Float32Array"}V.isFloat32Array=m;function b(re){return se(re)==="Float64Array"}V.isFloat64Array=b;function E(re){return se(re)==="BigInt64Array"}V.isBigInt64Array=E;function A(re){return se(re)==="BigUint64Array"}V.isBigUint64Array=A;function T(re){return y(re)==="[object Map]"}T.working=typeof Map<"u"&&T(new Map);function B(re){return typeof Map>"u"?!1:T.working?T(re):re instanceof Map}V.isMap=B;function F(re){return y(re)==="[object Set]"}F.working=typeof Set<"u"&&F(new Set);function D(re){return typeof Set>"u"?!1:F.working?F(re):re instanceof Set}V.isSet=D;function H(re){return y(re)==="[object WeakMap]"}H.working=typeof WeakMap<"u"&&H(new WeakMap);function L(re){return typeof WeakMap>"u"?!1:H.working?H(re):re instanceof WeakMap}V.isWeakMap=L;function I(re){return y(re)==="[object WeakSet]"}I.working=typeof WeakSet<"u"&&I(new WeakSet);function O(re){return I(re)}V.isWeakSet=O;function P(re){return y(re)==="[object ArrayBuffer]"}P.working=typeof ArrayBuffer<"u"&&P(new ArrayBuffer);function Q(re){return typeof ArrayBuffer>"u"?!1:P.working?P(re):re instanceof ArrayBuffer}V.isArrayBuffer=Q;function z(re){return y(re)==="[object DataView]"}z.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&z(new DataView(new ArrayBuffer(1),0,1));function X(re){return typeof DataView>"u"?!1:z.working?z(re):re instanceof DataView}V.isDataView=X;var K=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ie(re){return y(re)==="[object SharedArrayBuffer]"}function G(re){return typeof K>"u"?!1:(typeof ie.working>"u"&&(ie.working=ie(new K)),ie.working?ie(re):re instanceof K)}V.isSharedArrayBuffer=G;function j(re){return y(re)==="[object AsyncFunction]"}V.isAsyncFunction=j;function W(re){return y(re)==="[object Map Iterator]"}V.isMapIterator=W;function te(re){return y(re)==="[object Set Iterator]"}V.isSetIterator=te;function ne(re){return y(re)==="[object Generator]"}V.isGeneratorObject=ne;function be(re){return y(re)==="[object WebAssembly.Module]"}V.isWebAssemblyCompiledModule=be;function he(re){return _(re,g)}V.isNumberObject=he;function ke(re){return _(re,f)}V.isStringObject=ke;function ee(re){return _(re,u)}V.isBooleanObject=ee;function Ee(re){return $&&_(re,d)}V.isBigIntObject=Ee;function fe(re){return c&&_(re,C)}V.isSymbolObject=fe;function st(re){return he(re)||ke(re)||ee(re)||Ee(re)||fe(re)}V.isBoxedPrimitive=st;function Re(re){return typeof Uint8Array<"u"&&(Q(re)||G(re))}V.isAnyArrayBuffer=Re,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(re){Object.defineProperty(V,re,{enumerable:!1,value:function(){throw new Error(re+" is not supported in userland")}})})}(Xt)),Xt}var vr,ji;function Tn(){return ji||(ji=1,vr=function(U){return U&&typeof U=="object"&&typeof U.copy=="function"&&typeof U.fill=="function"&&typeof U.readUInt8=="function"}),vr}var Pt={exports:{}},$i;function Dn(){return $i||($i=1,typeof Object.create=="function"?Pt.exports=function(U,J){J&&(U.super_=J,U.prototype=Object.create(J.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}))}:Pt.exports=function(U,J){if(J){U.super_=J;var se=function(){};se.prototype=J.prototype,U.prototype=new se,U.prototype.constructor=U}}),Pt.exports}var qi;function Mn(){return qi||(qi=1,function(V){var U=Object.getOwnPropertyDescriptors||function(X){for(var K=Object.keys(X),ie={},G=0;G<K.length;G++)ie[K[G]]=Object.getOwnPropertyDescriptor(X,K[G]);return ie},J=/%[sdj%]/g;V.format=function(z){if(!p(z)){for(var X=[],K=0;K<arguments.length;K++)X.push($(arguments[K]));return X.join(" ")}for(var K=1,ie=arguments,G=ie.length,j=String(z).replace(J,function(te){if(te==="%%")return"%";if(K>=G)return te;switch(te){case"%s":return String(ie[K++]);case"%d":return Number(ie[K++]);case"%j":try{return JSON.stringify(ie[K++])}catch{return"[Circular]"}default:return te}}),W=ie[K];K<G;W=ie[++K])s(W)||!b(W)?j+=" "+W:j+=" "+$(W);return j},V.deprecate=function(z,X){if(typeof process<"u"&&process.noDeprecation===!0)return z;if(typeof process>"u")return function(){return V.deprecate(z,X).apply(this,arguments)};var K=!1;function ie(){if(!K){if(process.throwDeprecation)throw new Error(X);process.traceDeprecation?console.trace(X):console.error(X),K=!0}return z.apply(this,arguments)}return ie};var se={},ce=/^$/;if({}.NODE_DEBUG){var _e={}.NODE_DEBUG;_e=_e.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),ce=new RegExp("^"+_e+"$","i")}V.debuglog=function(z){if(z=z.toUpperCase(),!se[z])if(ce.test(z)){var X=process.pid;se[z]=function(){var K=V.format.apply(V,arguments);console.error("%s %d: %s",z,X,K)}}else se[z]=function(){};return se[z]};function $(z,X){var K={seen:[],stylize:y};return arguments.length>=3&&(K.depth=arguments[2]),arguments.length>=4&&(K.colors=arguments[3]),l(X)?K.showHidden=X:X&&V._extend(K,X),w(K.showHidden)&&(K.showHidden=!1),w(K.depth)&&(K.depth=2),w(K.colors)&&(K.colors=!1),w(K.customInspect)&&(K.customInspect=!0),K.colors&&(K.stylize=c),f(K,z,K.depth)}V.inspect=$,$.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},$.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function c(z,X){var K=$.styles[X];return K?"\x1B["+$.colors[K][0]+"m"+z+"\x1B["+$.colors[K][1]+"m":z}function y(z,X){return z}function g(z){var X={};return z.forEach(function(K,ie){X[K]=!0}),X}function f(z,X,K){if(z.customInspect&&X&&T(X.inspect)&&X.inspect!==V.inspect&&!(X.constructor&&X.constructor.prototype===X)){var ie=X.inspect(K,z);return p(ie)||(ie=f(z,ie,K)),ie}var G=u(z,X);if(G)return G;var j=Object.keys(X),W=g(j);if(z.showHidden&&(j=Object.getOwnPropertyNames(X)),A(X)&&(j.indexOf("message")>=0||j.indexOf("description")>=0))return d(X);if(j.length===0){if(T(X)){var te=X.name?": "+X.name:"";return z.stylize("[Function"+te+"]","special")}if(m(X))return z.stylize(RegExp.prototype.toString.call(X),"regexp");if(E(X))return z.stylize(Date.prototype.toString.call(X),"date");if(A(X))return d(X)}var ne="",be=!1,he=["{","}"];if(t(X)&&(be=!0,he=["[","]"]),T(X)){var ke=X.name?": "+X.name:"";ne=" [Function"+ke+"]"}if(m(X)&&(ne=" "+RegExp.prototype.toString.call(X)),E(X)&&(ne=" "+Date.prototype.toUTCString.call(X)),A(X)&&(ne=" "+d(X)),j.length===0&&(!be||X.length==0))return he[0]+ne+he[1];if(K<0)return m(X)?z.stylize(RegExp.prototype.toString.call(X),"regexp"):z.stylize("[Object]","special");z.seen.push(X);var ee;return be?ee=C(z,X,K,W,j):ee=j.map(function(Ee){return _(z,X,K,W,Ee,be)}),z.seen.pop(),o(ee,ne,he)}function u(z,X){if(w(X))return z.stylize("undefined","undefined");if(p(X)){var K="'"+JSON.stringify(X).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return z.stylize(K,"string")}if(h(X))return z.stylize(""+X,"number");if(l(X))return z.stylize(""+X,"boolean");if(s(X))return z.stylize("null","null")}function d(z){return"["+Error.prototype.toString.call(z)+"]"}function C(z,X,K,ie,G){for(var j=[],W=0,te=X.length;W<te;++W)I(X,String(W))?j.push(_(z,X,K,ie,String(W),!0)):j.push("");return G.forEach(function(ne){ne.match(/^\d+$/)||j.push(_(z,X,K,ie,ne,!0))}),j}function _(z,X,K,ie,G,j){var W,te,ne;if(ne=Object.getOwnPropertyDescriptor(X,G)||{value:X[G]},ne.get?ne.set?te=z.stylize("[Getter/Setter]","special"):te=z.stylize("[Getter]","special"):ne.set&&(te=z.stylize("[Setter]","special")),I(ie,G)||(W="["+G+"]"),te||(z.seen.indexOf(ne.value)<0?(s(K)?te=f(z,ne.value,null):te=f(z,ne.value,K-1),te.indexOf(`
`)>-1&&(j?te=te.split(`
`).map(function(be){return"  "+be}).join(`
`).slice(2):te=`
`+te.split(`
`).map(function(be){return"   "+be}).join(`
`))):te=z.stylize("[Circular]","special")),w(W)){if(j&&G.match(/^\d+$/))return te;W=JSON.stringify(""+G),W.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(W=W.slice(1,-1),W=z.stylize(W,"name")):(W=W.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),W=z.stylize(W,"string"))}return W+": "+te}function o(z,X,K){var ie=z.reduce(function(G,j){return j.indexOf(`
`)>=0,G+j.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ie>60?K[0]+(X===""?"":X+`
 `)+" "+z.join(`,
  `)+" "+K[1]:K[0]+X+" "+z.join(", ")+" "+K[1]}V.types=An();function t(z){return Array.isArray(z)}V.isArray=t;function l(z){return typeof z=="boolean"}V.isBoolean=l;function s(z){return z===null}V.isNull=s;function i(z){return z==null}V.isNullOrUndefined=i;function h(z){return typeof z=="number"}V.isNumber=h;function p(z){return typeof z=="string"}V.isString=p;function v(z){return typeof z=="symbol"}V.isSymbol=v;function w(z){return z===void 0}V.isUndefined=w;function m(z){return b(z)&&F(z)==="[object RegExp]"}V.isRegExp=m,V.types.isRegExp=m;function b(z){return typeof z=="object"&&z!==null}V.isObject=b;function E(z){return b(z)&&F(z)==="[object Date]"}V.isDate=E,V.types.isDate=E;function A(z){return b(z)&&(F(z)==="[object Error]"||z instanceof Error)}V.isError=A,V.types.isNativeError=A;function T(z){return typeof z=="function"}V.isFunction=T;function B(z){return z===null||typeof z=="boolean"||typeof z=="number"||typeof z=="string"||typeof z=="symbol"||typeof z>"u"}V.isPrimitive=B,V.isBuffer=Tn();function F(z){return Object.prototype.toString.call(z)}function D(z){return z<10?"0"+z.toString(10):z.toString(10)}var H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(){var z=new Date,X=[D(z.getHours()),D(z.getMinutes()),D(z.getSeconds())].join(":");return[z.getDate(),H[z.getMonth()],X].join(" ")}V.log=function(){console.log("%s - %s",L(),V.format.apply(V,arguments))},V.inherits=Dn(),V._extend=function(z,X){if(!X||!b(X))return z;for(var K=Object.keys(X),ie=K.length;ie--;)z[K[ie]]=X[K[ie]];return z};function I(z,X){return Object.prototype.hasOwnProperty.call(z,X)}var O=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;V.promisify=function(X){if(typeof X!="function")throw new TypeError('The "original" argument must be of type Function');if(O&&X[O]){var K=X[O];if(typeof K!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(K,O,{value:K,enumerable:!1,writable:!1,configurable:!0}),K}function K(){for(var ie,G,j=new Promise(function(ne,be){ie=ne,G=be}),W=[],te=0;te<arguments.length;te++)W.push(arguments[te]);W.push(function(ne,be){ne?G(ne):ie(be)});try{X.apply(this,W)}catch(ne){G(ne)}return j}return Object.setPrototypeOf(K,Object.getPrototypeOf(X)),O&&Object.defineProperty(K,O,{value:K,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(K,U(X))},V.promisify.custom=O;function P(z,X){if(!z){var K=new Error("Promise was rejected with a falsy value");K.reason=z,z=K}return X(z)}function Q(z){if(typeof z!="function")throw new TypeError('The "original" argument must be of type Function');function X(){for(var K=[],ie=0;ie<arguments.length;ie++)K.push(arguments[ie]);var G=K.pop();if(typeof G!="function")throw new TypeError("The last argument must be of type Function");var j=this,W=function(){return G.apply(j,arguments)};z.apply(this,K).then(function(te){process.nextTick(W.bind(null,null,te))},function(te){process.nextTick(P.bind(null,te,W))})}return Object.setPrototypeOf(X,Object.getPrototypeOf(z)),Object.defineProperties(X,U(z)),X}V.callbackify=Q}(Kt)),Kt}/*! For license information please see xterm-addon-ligatures.js.LICENSE.txt */(function(V,U){(function(J,se){V.exports=se(Vt,Vt,Mn(),Vt)})(self,function(J,se,ce,_e){return(()=>{var $={185:(f,u)=>{function d(_){const o={};for(const[t,l]of Object.entries(_.individual))o[t]=C(l);for(const{range:t,entry:l}of _.range){const s=C(l);for(let i=t[0];i<t[1];i++)o[i]=s}return o}function C(_){const o={};return _.forward&&(o.forward=d(_.forward)),_.reverse&&(o.reverse=d(_.reverse)),_.lookup&&(o.lookup=_.lookup),o}Object.defineProperty(u,"__esModule",{value:!0}),u.default=d},98:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(602),_=d(593),o=d(233),t=d(694),l=d(532),s=d(595),i=d(223),h=d(439),p=d(349),v=d(185);class w{constructor(E,A){this._lookupTrees=[],this._glyphLookups={},this._font=E,A.cacheSize>0&&(this._cache=new _({max:A.cacheSize,length:(D,H)=>H.length}));const T=(this._font.tables.gsub&&this._font.tables.gsub.features.filter(D=>D.tag==="calt")||[]).reduce((D,H)=>[...D,...H.feature.lookupListIndexes],[]),B=this._font.tables.gsub&&this._font.tables.gsub.lookups||[],F=B.filter((D,H)=>T.some(L=>L===H));for(const[D,H]of F.entries()){const L=[];switch(H.lookupType){case 6:for(const[O,P]of H.subtables.entries())switch(P.substFormat){case 1:L.push(s.default(P,B,O));break;case 2:L.push(i.default(P,B,O));break;case 3:L.push(h.default(P,B,O))}break;case 8:for(const[O,P]of H.subtables.entries())L.push(p.default(P,O))}const I=v.default(o.default(L));this._lookupTrees.push({tree:I,processForward:H.lookupType!==8});for(const O of Object.keys(I))this._glyphLookups[O]||(this._glyphLookups[O]=[]),this._glyphLookups[O].push(D)}}findLigatures(E){const A=this._cache&&this._cache.get(E);if(A&&!Array.isArray(A))return A;const T=[];for(const D of E)T.push(this._font.charToGlyphIndex(D));if(this._lookupTrees.length===0)return{inputGlyphs:T,outputGlyphs:T,contextRanges:[]};const B=this._findInternal(T.slice()),F={inputGlyphs:T,outputGlyphs:B.sequence,contextRanges:B.ranges};return this._cache&&this._cache.set(E,F),F}findLigatureRanges(E){if(this._lookupTrees.length===0)return[];const A=this._cache&&this._cache.get(E);if(A)return Array.isArray(A)?A:A.contextRanges;const T=[];for(const F of E)T.push(this._font.charToGlyphIndex(F));const B=this._findInternal(T);return this._cache&&this._cache.set(E,B.ranges),B.ranges}_findInternal(E){const A=[];let T=this._getNextLookup(E,0);for(;T.index!==null;){const B=this._lookupTrees[T.index];if(B.processForward){let F=T.last;for(let D=T.first;D<F;D++){const H=t.default(B.tree,E,D,D);if(H){for(let L=0;L<H.substitutions.length;L++){const I=H.substitutions[L];I!==null&&(E[D+L]=I)}l.default(A,H.contextRange[0]+D,H.contextRange[1]+D),D+H.length>=F&&(F=D+H.length+1),D+=H.length-1}}}else for(let F=T.last-1;F>=T.first;F--){const D=t.default(B.tree,E,F,F);if(D){for(let H=0;H<D.substitutions.length;H++){const L=D.substitutions[H];L!==null&&(E[F+H]=L)}l.default(A,D.contextRange[0]+F,D.contextRange[1]+F),F-=D.length-1}}T=this._getNextLookup(E,T.index+1)}return{sequence:E,ranges:A}}_getNextLookup(E,A){const T={index:null,first:1/0,last:-1};for(let B=0;B<E.length;B++){const F=this._glyphLookups[E[B]];if(F)for(let D=0;D<F.length;D++){const H=F[D];if(H>=A){(T.index===null||H<=T.index)&&(T.index=H,T.first>B&&(T.first=B),T.last=B+1);break}}}return T}}async function m(b,E){const A=await Promise.resolve().then(()=>d(269)).then(T=>T.promisify(C.load)(b));return new w(A,Object.assign({cacheSize:0},E))}u.load=async function(b,E){const[A]=await Promise.resolve().then(()=>d(781)).then(T=>T.listVariants(b));if(!A)throw new Error(`Font ${b} not found`);return m(A.path,E)},u.loadFile=m,u.loadBuffer=function(b,E){const A=C.parse(b);return new w(A,Object.assign({cacheSize:0},E))}},233:(f,u)=>{function d(i,h){for(const[p,v]of Object.entries(h.individual))if(i.individual[p])C(i.individual[p],v);else{let w=!1;for(const[m,{range:b,entry:E}]of i.range.entries()){const A=o(Number(p),b);if(A.both!==null){w=!0,i.individual[p]=v,C(i.individual[p],l(E)),i.range.splice(m,1);for(const T of A.second)Array.isArray(T)?i.range.push({range:T,entry:l(E)}):i.individual[T]=l(E)}}w||(i.individual[p]=v)}for(const{range:p,entry:v}of h.range){let w=[p];for(let m=0;m<i.range.length;m++){const{range:b,entry:E}=i.range[m];for(const[A,T]of w.entries()){if(!Array.isArray(T)){const B=o(T,b);if(B.both===null)continue;i.individual[T]=l(v),C(i.individual[T],l(E)),i.range.splice(m,1),m--;for(const F of B.second)Array.isArray(F)?i.range.push({range:F,entry:l(E)}):i.individual[F]=l(E);w.splice(A,1,...B.first);break}{const B=_(T,b);if(B.both===null)continue;i.range.splice(m,1),m--;const F=l(E);Array.isArray(B.both)?i.range.push({range:B.both,entry:F}):i.individual[B.both]=F,C(F,l(v));for(const D of B.second)Array.isArray(D)?i.range.push({range:D,entry:l(E)}):i.individual[D]=l(E);w=B.first}}}for(const m of Object.keys(i.individual))for(const[b,E]of w.entries()){if(Array.isArray(E)){const A=o(Number(m),E);if(A.both===null)continue;C(i.individual[m],l(v)),w.splice(b,1,...A.second);break}if(Number(m)===E){C(i.individual[m],l(v));break}}for(const m of w)Array.isArray(m)?i.range.push({range:m,entry:l(v)}):i.individual[m]=l(v)}}function C(i,h){h.lookup&&(!i.lookup||i.lookup.index>h.lookup.index||i.lookup.index===h.lookup.index&&i.lookup.subIndex>h.lookup.subIndex)&&(i.lookup=h.lookup),h.forward&&(i.forward?d(i.forward,h.forward):i.forward=h.forward),h.reverse&&(i.reverse?d(i.reverse,h.reverse):i.reverse=h.reverse)}function _(i,h){const p={first:[],second:[],both:null};if(i[0]<h[1]&&h[0]<i[1]){const v=Math.max(i[0],h[0]),w=Math.min(i[1],h[1]);p.both=t(v,w)}if(i[0]<h[0]){const v=i[0],w=Math.min(h[0],i[1]);p.first.push(t(v,w))}else if(h[0]<i[0]){const v=h[0],w=Math.min(h[1],i[0]);p.second.push(t(v,w))}if(i[1]>h[1]){const v=Math.max(i[0],h[1]),w=i[1];p.first.push(t(v,w))}else if(h[1]>i[1]){const v=Math.max(i[1],h[0]),w=h[1];p.second.push(t(v,w))}return p}function o(i,h){if(i<h[0]||i>h[1])return{first:[i],second:[h],both:null};const p={first:[],second:[],both:i};return h[0]<i&&p.second.push(t(h[0],i)),h[1]>i&&p.second.push(t(i+1,h[1])),p}function t(i,h){return h-i==1?i:[i,h]}function l(i){const h={};return i.forward&&(h.forward=s(i.forward)),i.reverse&&(h.reverse=s(i.reverse)),i.lookup&&(h.lookup={contextRange:i.lookup.contextRange.slice(),index:i.lookup.index,length:i.lookup.length,subIndex:i.lookup.subIndex,substitutions:i.lookup.substitutions.slice()}),h}function s(i){const h={};for(const[p,v]of Object.entries(i.individual))h[p]=l(v);return{individual:h,range:i.range.map(({range:p,entry:v})=>({range:p.slice(),entry:l(v)}))}}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(i){const h={individual:{},range:[]};for(const p of i)d(h,p);return h}},532:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d,C,_){let o=!1;for(let t=0;t<d.length;t++){const l=d[t];if(o){if(_<=l[0])return d[t-1][1]=_,d;if(_<=l[1])return d[t-1][1]=Math.max(_,l[1]),d.splice(t,1),o=!1,d;d.splice(t,1),t--}else{if(_<=l[0])return d.splice(t,0,[C,_]),d;if(_<=l[1])return l[0]=Math.min(C,l[0]),d;if(!(C<l[1]))continue;l[0]=Math.min(C,l[0]),o=!0}}return o?d[d.length-1][1]=_:d.push([C,_]),d}},595:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(283),_=d(267);u.default=function(o,t,l){const s={individual:{},range:[]},i=C.listGlyphsByIndex(o.coverage);for(const{glyphId:h,index:p}of i){const v=o.chainRuleSets[p];if(v)for(const[w,m]of v.entries()){let b=_.getInputTree(s,m.lookupRecords,t,0,h).map(({entry:E,substitution:A})=>({entry:E,substitutions:[A]}));for(const[E,A]of m.input.entries())b=_.processInputPosition([A],E+1,b,m.lookupRecords,t);for(const E of m.lookahead)b=_.processLookaheadPosition([E],b);for(const E of m.backtrack)b=_.processBacktrackPosition([E],b);for(const{entry:E,substitutions:A}of b)E.lookup={substitutions:A,length:m.input.length+1,index:l,subIndex:w,contextRange:[-1*m.backtrack.length,1+m.input.length+m.lookahead.length]}}}return s}},223:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(233),_=d(283),o=d(91),t=d(267);u.default=function(l,s,i){const h=[],p=_.listGlyphsByIndex(l.coverage);for(const{glyphId:v}of p){const w=o.default(l.inputClassDef,v);for(const[m,b]of w.entries()){if(b===null)continue;const E=l.chainClassSet[b];if(E)for(const[A,T]of E.entries()){const B={individual:{},range:[]};let F=t.getInputTree(B,T.lookupRecords,s,0,m).map(({entry:D,substitution:H})=>({entry:D,substitutions:[H]}));for(const[D,H]of T.input.entries())F=t.processInputPosition(o.listClassGlyphs(l.inputClassDef,H),D+1,F,T.lookupRecords,s);for(const D of T.lookahead)F=t.processLookaheadPosition(o.listClassGlyphs(l.lookaheadClassDef,D),F);for(const D of T.backtrack)F=t.processBacktrackPosition(o.listClassGlyphs(l.backtrackClassDef,D),F);for(const{entry:D,substitutions:H}of F)D.lookup={substitutions:H,index:i,subIndex:A,length:T.input.length+1,contextRange:[-1*T.backtrack.length,1+T.input.length+T.lookahead.length]};h.push(B)}}}return C.default(h)}},439:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(283),_=d(267);u.default=function(o,t,l){const s={individual:{},range:[]},i=C.listGlyphsByIndex(o.inputCoverage[0]);for(const{glyphId:h}of i){let p=_.getInputTree(s,o.lookupRecords,t,0,h).map(({entry:v,substitution:w})=>({entry:v,substitutions:[w]}));for(const[v,w]of o.inputCoverage.slice(1).entries())p=_.processInputPosition(C.listGlyphsByIndex(w).map(m=>m.glyphId),v+1,p,o.lookupRecords,t);for(const v of o.lookaheadCoverage)p=_.processLookaheadPosition(C.listGlyphsByIndex(v).map(w=>w.glyphId),p);for(const v of o.backtrackCoverage)p=_.processBacktrackPosition(C.listGlyphsByIndex(v).map(w=>w.glyphId),p);for(const{entry:v,substitutions:w}of p)v.lookup={substitutions:w,index:l,subIndex:0,length:o.inputCoverage.length,contextRange:[-1*o.backtrackCoverage.length,o.inputCoverage.length+o.lookaheadCoverage.length]}}return s}},349:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(283),_=d(267);u.default=function(o,t){const l={individual:{},range:[]},s=C.listGlyphsByIndex(o.coverage);for(const{glyphId:i,index:h}of s){const p={};Array.isArray(i)?l.range.push({entry:p,range:i}):l.individual[i]=p;let v=[{entry:p,substitutions:[o.substitutes[h]]}];for(const w of o.lookaheadCoverage)v=_.processLookaheadPosition(C.listGlyphsByIndex(w).map(m=>m.glyphId),v);for(const w of o.backtrackCoverage)v=_.processBacktrackPosition(C.listGlyphsByIndex(w).map(m=>m.glyphId),v);for(const{entry:w,substitutions:m}of v)w.lookup={substitutions:m,index:t,subIndex:0,length:1,contextRange:[-1*o.backtrackCoverage.length,1+o.lookaheadCoverage.length]}}return l}},91:(f,u)=>{function d(C,_){for(const o of C.ranges)if(o.start<=_&&o.end>=_)return o.classId;return null}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(C,_){return C.format===2?Array.isArray(_)?function(o,t){let l=t[0],s=d(o,l),i=t[0]+1;const h=new Map;for(;i<t[1];)d(o,i)!==s&&(i-l<=1?h.set(l,s):h.set([l,i],s)),i++;return i-l<=1?h.set(l,s):h.set([l,i],s),h}(C,_):new Map([[_,d(C,_)]]):new Map([[_,null]])},u.listClassGlyphs=function(C,_){if(C.format===2){const o=[];for(const t of C.ranges)t.classId===_&&(t.end===t.start?o.push(t.start):o.push([t.start,t.end+1]));return o}return[]}},283:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d,C){switch(d.format){case 1:const _=d.glyphs.indexOf(C);return _!==-1?_:null;case 2:const o=d.ranges.find(t=>t.start<=C&&t.end>=C);return o?o.index:null}},u.listGlyphsByIndex=function(d){switch(d.format){case 1:return d.glyphs.map((_,o)=>({glyphId:_,index:o}));case 2:let C=[];for(const[_,o]of d.ranges.entries())o.end===o.start?C.push({glyphId:o.start,index:_}):C.push({glyphId:[o.start,o.end+1],index:_});return C}}},267:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(603);function _(t,l,s,i,h){const p=[];if(Array.isArray(h)){const v=function(w,m,b,E){for(const A of w.filter(T=>T.sequenceIndex===b))for(const T of m[A.lookupListIndex].subtables){const B=C.getRangeSubstitutionGlyphs(T,E);if(!Array.from(B.values()).every(F=>F!==null))return B}return new Map([[E,null]])}(l,s,i,h);for(const[w,m]of v){const b={};Array.isArray(w)?t.range.push({range:w,entry:b}):t.individual[w]={},p.push({entry:b,substitution:m})}}else t.individual[h]={},p.push({entry:t.individual[h],substitution:o(l,s,i,h)});return p}function o(t,l,s,i){for(const h of t.filter(p=>p.sequenceIndex===s))for(const p of l[h.lookupListIndex].subtables){const v=C.getIndividualSubstitutionGlyph(p,i);if(v!==null)return v}return null}u.processInputPosition=function(t,l,s,i,h){const p=[];for(const v of s){v.entry.forward={individual:{},range:[]};for(const w of t)p.push(..._(v.entry.forward,i,h,l,w).map(({entry:m,substitution:b})=>({entry:m,substitutions:[...v.substitutions,b]})))}return p},u.processLookaheadPosition=function(t,l){const s=[];for(const i of l)for(const h of t){const p={};i.entry.forward||(i.entry.forward={individual:{},range:[]}),s.push({entry:p,substitutions:i.substitutions}),Array.isArray(h)?i.entry.forward.range.push({entry:p,range:h}):i.entry.forward.individual[h]=p}return s},u.processBacktrackPosition=function(t,l){const s=[];for(const i of l)for(const h of t){const p={};i.entry.reverse||(i.entry.reverse={individual:{},range:[]}),s.push({entry:p,substitutions:i.substitutions}),Array.isArray(h)?i.entry.reverse.range.push({entry:p,range:h}):i.entry.reverse.individual[h]=p}return s},u.getInputTree=_},603:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(283);function _(o,t){const l=C.default(o.coverage,t);if(l===null)return null;switch(o.substFormat){case 1:return(t+o.deltaGlyphId)%65536;case 2:return o.substitute[l]!=null?o.substitute[l]:null}}u.getRangeSubstitutionGlyphs=function(o,t){let l=t[0],s=_(o,l),i=t[0]+1;const h=new Map;for(;i<t[1];)_(o,i)!==s&&(i-l<=1?h.set(l,s):h.set([l,i],s)),i++;return i-l<=1?h.set(l,s):h.set([l,i],s),h},u.getIndividualSubstitutionGlyph=_},694:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function d(C,_,o,t){let l=C[_[t]];if(!l)return;let s=l.lookup;if(l.reverse){const h=function(p,v,w){let m=p[v[--w]],b=m&&m.lookup;for(;m&&((!b&&m.lookup||m.lookup&&b&&b.index>m.lookup.index)&&(b=m.lookup),!(--w<0)&&m.reverse);)m=m.reverse[v[w]];return b}(l.reverse,_,o);(!s&&h||h&&s&&(s.index>h.index||s.index===h.index&&s.subIndex>h.subIndex))&&(s=h)}if(++t>=_.length||!l.forward)return s;const i=d(l.forward,_,o,t);return(!s&&i||i&&s&&(s.index>i.index||s.index===i.index&&s.subIndex>i.subIndex))&&(s=i),s}},814:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(82);var _,o;(function(i){i.Serif="serif",i.SansSerif="sansSerif",i.Monospace="monospace",i.Cursive="cursive",i.Unknown="unknown"})(_=u.Type||(u.Type={})),function(i){i.Regular="regular",i.Italic="italic",i.Oblique="oblique",i.Bold="bold",i.BoldItalic="boldItalic",i.BoldOblique="boldOblique",i.Other="other"}(o=u.Style||(u.Style={}));const t=[" Regular"," Bold"," Bold Italic"," Bold Oblique"," Italic"," Oblique"];function l(i){if(!i.os2&&!i.head)return o.Other;const h=i.os2?32&i.os2.fsSelection:1&i.head.macStyle,p=i.os2?1&i.os2.fsSelection:i.post?i.post.italicAngle<0:2&i.head.macStyle,v=i.os2?512&i.os2.fsSelection:i.post?i.post.italicAngle>0:0,w=i.os2?320&i.os2.fsSelection:1;return h?v?o.BoldOblique:p?o.BoldItalic:o.Bold:v?o.Oblique:p?o.Italic:w?o.Regular:o.Other}u.name=function(i,h){const p=i.names.preferredFamily&&i.names.preferredFamily[h]?i.names.preferredFamily[h]:i.names.fontFamily[h];if(C.platform()==="win32"){const v=`${p} ${i.names.preferredSubfamily&&i.names.preferredSubfamily[h]?i.names.preferredSubfamily[h]:i.names.fontSubfamily[h]}`;let w=-1;for(const m of t){const b=v.lastIndexOf(m);if(b!==-1){w=b;break}}return w!==-1?v.substring(0,w):v}return p},u.type=function(i){if(i.os2)switch(i.os2.panose[0]){case 2:return i.os2.panose[3]===9?_.Monospace:i.os2.panose[1]>=11&&i.os2.panose[1]<=15||i.os2.panose[1]===0?_.SansSerif:_.Serif;case 3:return _.Cursive}else if(i.post&&i.post.isFixedPitch)return _.Monospace;return _.Unknown},u.style=l;const s=[o.Bold,o.BoldItalic,o.BoldOblique];u.weight=function(i){return i.os2?i.os2.usWeightClass:s.includes(l(i))?700:400}},781:function(f,u,d){var C=this&&this.__rest||function(h,p){var v={};for(var w in h)Object.prototype.hasOwnProperty.call(h,w)&&p.indexOf(w)<0&&(v[w]=h[w]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var m=0;for(w=Object.getOwnPropertySymbols(h);m<w.length;m++)p.indexOf(w[m])<0&&(v[w[m]]=h[w[m]])}return v};Object.defineProperty(u,"__esModule",{value:!0});const _=d(459),o=d(934),t=d(814);var l=d(814);async function s(h){const p=Object.assign({concurrency:4,language:"en"},h),v=await _.default({extensions:["ttf","otf"]}),w=await async function(b,E,A){const T=[];let B=0;const F=async H=>{T.push(await(async L=>{try{return i(L,await o.default(L),p.language)}catch(I){if(["TypeError","SyntaxError","ReferenceError","RangeError","AssertionError"].includes(I.name))throw I}})(E[H])),B<E.length&&await F(B++)},D=[];for(;B<E.length&&B<A;B++)D.push(F(B));return await Promise.all(D),T}(0,v,p.concurrency),m={};for(let b of w.filter(E=>E)){const{name:E}=b,A=C(b,["name"]);m[E]||(m[E]=[]),m[E].push(A)}return m}function i(h,p,v){return{name:t.name(p,v),path:h,type:t.type(p),weight:t.weight(p),style:t.style(p)}}u.Type=l.Type,u.Style=l.Style,u.list=s,u.listVariants=async function(h,p){return(await s(p))[h]||[]},u.get=async function(h,p){const v=Object.assign({language:"en"},p);return i(h,await o.default(h),v.language)}},934:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(89),_=d(896),o=d(380),t=d(879),l=d(130),s=d(731),i=d(954);var h;(function(w){w[w.TrueType=0]="TrueType",w[w.CFF=1]="CFF",w[w.Woff=2]="Woff"})(h||(h={}));const p={name:{tag:Buffer.from("name"),parse:o.default},ltag:{tag:Buffer.from("ltag"),parse:t.default},os2:{tag:Buffer.from("OS/2"),parse:l.default},head:{tag:Buffer.from("head"),parse:s.default},post:{tag:Buffer.from("post"),parse:i.default}};u.default=async function(w){return new Promise((m,b)=>{(async()=>{const E=_.default(),A=C.createReadStream(w);let T=!1;const B=()=>{T=!0};A.once("close",B),A.once("end",B),A.once("error",F=>{T=!0,b(F)}),A.pipe(E);try{switch(function(F){if(F.equals(v.one)||F.equals(v.true)||F.equals(v.typ1))return h.TrueType;if(F.equals(v.otto))return h.CFF;if(F.equals(v.woff))return h.Woff;throw new Error(`Unsupported signature type: ${F}`)}(await E.read(4))){case h.TrueType:case h.CFF:const F=(await E.read(2)).readUInt16BE(0);await E.skip(6);const D=await async function(O,P){const Q={};for(let z=0;z<P;z++){const X=await O.read(4),K=await O.read(12);for(const[ie,G]of Object.entries(p))if(X.equals(G.tag)&&(Q[ie]={offset:K.readUInt32BE(4),length:K.readUInt32BE(8)},Q.name&&Q.ltag&&Q.os2))return Q}return Q}(E,F),H=Object.entries(D).sort((O,P)=>O[1].offset-P[1].offset),L={};for(const[O,P]of H)await E.skip(P.offset-E.offset),L[O]=await E.read(P.length);let I=[];if(L.ltag&&(I=p.ltag.parse(L.ltag)),!L.name)throw new Error(`missing required OpenType table 'name' in font file: ${w}`);return{names:p.name.parse(L.name,I),os2:L.os2&&p.os2.parse(L.os2),head:L.head&&p.head.parse(L.head),post:L.post&&p.post.parse(L.post)};case h.Woff:default:throw new Error("provided font type is not supported yet")}}finally{A.unpipe(E),T||(A.destroy(),E.destroy())}})().then(m,b)})};const v={one:Buffer.from([0,1,0,0]),otto:Buffer.from("OTTO"),true:Buffer.from("true"),typ1:Buffer.from("typ1"),woff:Buffer.from("wOFF")}},731:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(980);u.default=function(_){return{version:C.formatFixed(_.readUInt16BE(0),_.readUInt16BE(2)),fontRevision:C.formatFixed(_.readUInt16BE(4),_.readUInt16BE(6)),checkSumAdjustment:_.readUInt32BE(8),magicNumber:_.readUInt32BE(12),flags:_.readUInt16BE(16),unitsPerEm:_.readUInt16BE(18),created:C.formatLongDateTime(_.readUInt32BE(20),_.readUInt32BE(24)),modified:C.formatLongDateTime(_.readUInt32BE(28),_.readUInt32BE(32)),xMin:_.readInt16BE(36),yMin:_.readInt16BE(38),xMax:_.readInt16BE(40),yMax:_.readInt16BE(42),macStyle:_.readUInt16BE(44),lowestRecPPEM:_.readUInt16BE(46),fontDirectionHint:_.readInt16BE(48),indexToLocFormat:_.readInt16BE(50),glyphDataFormat:_.readInt16BE(52)}}},879:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d){if(d.readUInt32BE(0)!==1)throw new Error("Unsupported ltag table version.");const C=d.readUInt32BE(8),_=[];for(let o=0;o<C;o++){let t="";const l=d.readUInt16BE(12+4*o),s=d.readUInt16BE(14+4*o);for(let i=l;i<l+s;++i)t+=String.fromCharCode(d.readInt8(i));_.push(t)}return _}},380:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0});const d=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],C={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},_={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function o(v,w,m){switch(v){case 0:if(w===65535)return"und";if(m)return m[w];break;case 1:return C[w];case 3:return _[w]}}const t="utf-16",l={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},s={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function i(v,w,m){switch(v){case 0:return t;case 1:return s[m]||l[w];case 3:if(w===1||w===10)return t}}u.default=function(v,w){const m={},b=v.readUInt16BE(2),E=v.readUInt16BE(4);let A=6;for(let T=0;T<b;T++){const B=v.readUInt16BE(A+0),F=v.readUInt16BE(A+2),D=v.readUInt16BE(A+4),H=v.readUInt16BE(A+6),L=d[H]||String(H),I=v.readUInt16BE(A+8),O=v.readUInt16BE(A+10),P=o(B,D,w),Q=i(B,F,D);if(A+=12,Q!==void 0&&P!==void 0){let z;if(Q===t){const X=I/2,K=Array(X);for(let ie=0;ie<X;ie++)K[ie]=v.readUInt16BE(E+O+2*ie);z=String.fromCharCode(...K)}else z=p(v,E+O,I,Q);if(z){let X=m[L];X===void 0&&(X=m[L]={}),X[P]=z}}}return m};const h={"x-mac-croatian":" ","x-mac-cyrillic":" ","x-mac-gaelic":" ","x-mac-greek":" ","x-mac-icelandic":" ","x-mac-inuit":" ","x-mac-ce":" ",macintosh:" ","x-mac-romanian":" ","x-mac-turkish":" "};function p(v,w,m,b){const E=h[b];if(E===void 0)return;let A="";for(let T=0;T<m;T++){const B=v.readUInt8(w+T);A+=B<=127?String.fromCharCode(B):E[127&B]}return A}},130:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d){const C={version:d.readUInt16BE(0),xAvgCharWidth:d.readUInt16BE(2),usWeightClass:d.readUInt16BE(4),usWidthClass:d.readUInt16BE(6),fsType:d.readUInt16BE(8),ySubscriptXSize:d.readInt16BE(10),ySubscriptYSize:d.readInt16BE(12),ySubscriptXOffset:d.readInt16BE(14),ySubscriptYOffset:d.readInt16BE(16),ySuperscriptXSize:d.readInt16BE(18),ySuperscriptYSize:d.readInt16BE(20),ySuperscriptXOffset:d.readInt16BE(22),ySuperscriptYOffset:d.readInt16BE(24),yStrikeoutSize:d.readInt16BE(26),yStrikeoutPosition:d.readInt16BE(28),sFamilyClass:d.readInt16BE(30),panose:[d.readUInt8(32),d.readUInt8(33),d.readUInt8(34),d.readUInt8(35),d.readUInt8(36),d.readUInt8(37),d.readUInt8(38),d.readUInt8(39),d.readUInt8(40),d.readUInt8(41)],ulUnicodeRange1:d.readUInt32BE(42),ulUnicodeRange2:d.readUInt32BE(46),ulUnicodeRange3:d.readUInt32BE(50),ulUnicodeRange4:d.readUInt32BE(54),achVendID:String.fromCharCode(d.readUInt8(58),d.readUInt8(59),d.readUInt8(60),d.readUInt8(61)),fsSelection:d.readUInt16BE(62),usFirstCharIndex:d.readUInt16BE(64),usLastCharIndex:d.readUInt16BE(66),sTypoAscender:d.readInt16BE(68),sTypoDescender:d.readInt16BE(70),sTypoLineGap:d.readInt16BE(72),usWinAscent:d.readUInt16BE(74),usWinDescent:d.readUInt16BE(76)};return C.version>=1&&(C.ulCodePageRange1=d.readUInt32BE(78),C.ulCodePageRange2=d.readUInt32BE(82)),C.version>=2&&(C.sxHeight=d.readInt16BE(86),C.sCapHeight=d.readInt16BE(88),C.usDefaultChar=d.readUInt16BE(90),C.usBreakChar=d.readUInt16BE(92),C.usMaxContent=d.readUInt16BE(94)),C}},954:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(980);u.default=function(_){return{version:C.formatFixed(_.readUInt16BE(0),_.readUInt16BE(2)),italicAngle:C.formatFixed(_.readUInt16BE(4),_.readUInt16BE(6)),underlinePosition:_.readInt16BE(8),underlineThickness:_.readInt16BE(10),isFixedPitch:_.readUInt32BE(12),minMemType42:_.readUInt32BE(16),maxMemType42:_.readUInt32BE(20),minMemType1:_.readUInt32BE(24),maxMemType1:_.readUInt32BE(28)}}},980:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.formatFixed=function(d,C){return d+C/65536},u.formatLongDateTime=function(d,C){return 1e3*(d*4294967296+C-2082844800)}},459:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(56),_=d(456),o=d(49),t={win32:()=>({}).WINDIR?[C.join({}.WINDIR,"Fonts")]:["C:\\Windows\\Fonts"],darwin:()=>{const s=_.homedir();return[...s?[C.join(s,"/Library/Fonts")]:[],"/Library/Fonts","/Network/Library/Fonts","/System/Library/Fonts","/System Folder/Fonts"]},linux:()=>{const s=_.homedir();return["/usr/share/fonts","/usr/local/share/fonts",...s?[C.join(s,".fonts"),C.join(s,".local/share/fonts")]:[]]}};function l(s){const i=Object.assign({extensions:["ttf","otf","ttc","woff","woff2"],additionalFolders:[]},s),h=_.platform(),p=t[h];if(!p)throw new Error(`Unsupported platform: ${h}`);const v=p();return o.default([...v,...i.additionalFolders],i.extensions)}f.exports=Object.assign(l,{default:l}),u.default=l},49:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(89),_=d(269),o=d(56),t=_.promisify(C.readdir),l=_.promisify(C.stat);async function s(i,h,p=10){if(p<=0)return[];let v;try{v=await t(i)}catch{return[]}const w=[];return await Promise.all(v.map(async m=>{const b=o.join(i,m);let E;try{E=await l(b)}catch{return}E.isFile()&&h.test(b)?w.push(b):E.isDirectory()&&w.push(...await s(b,h,p-1))})),w}u.default=async function(i,h){const p=new Set;return await Promise.all(i.map(async v=>{const w=await s(o.resolve(v),new RegExp(`\\.${h.map(m=>`(?:${m})`).join("|")}$`));for(const m of w)p.add(m)})),[...p]}},593:(f,u,d)=>{const C=d(411),_=Symbol("max"),o=Symbol("length"),t=Symbol("lengthCalculator"),l=Symbol("allowStale"),s=Symbol("maxAge"),i=Symbol("dispose"),h=Symbol("noDisposeOnSet"),p=Symbol("lruList"),v=Symbol("cache"),w=Symbol("updateAgeOnGet"),m=()=>1,b=(D,H,L)=>{const I=D[v].get(H);if(I){const O=I.value;if(E(D,O)){if(T(D,I),!D[l])return}else L&&(D[w]&&(I.value.now=Date.now()),D[p].unshiftNode(I));return O.value}},E=(D,H)=>{if(!H||!H.maxAge&&!D[s])return!1;const L=Date.now()-H.now;return H.maxAge?L>H.maxAge:D[s]&&L>D[s]},A=D=>{if(D[o]>D[_])for(let H=D[p].tail;D[o]>D[_]&&H!==null;){const L=H.prev;T(D,H),H=L}},T=(D,H)=>{if(H){const L=H.value;D[i]&&D[i](L.key,L.value),D[o]-=L.length,D[v].delete(L.key),D[p].removeNode(H)}};class B{constructor(H,L,I,O,P){this.key=H,this.value=L,this.length=I,this.now=O,this.maxAge=P||0}}const F=(D,H,L,I)=>{let O=L.value;E(D,O)&&(T(D,L),D[l]||(O=void 0)),O&&H.call(I,O.value,O.key,D)};f.exports=class{constructor(D){if(typeof D=="number"&&(D={max:D}),D||(D={}),D.max&&(typeof D.max!="number"||D.max<0))throw new TypeError("max must be a non-negative number");this[_]=D.max||1/0;const H=D.length||m;if(this[t]=typeof H!="function"?m:H,this[l]=D.stale||!1,D.maxAge&&typeof D.maxAge!="number")throw new TypeError("maxAge must be a number");this[s]=D.maxAge||0,this[i]=D.dispose,this[h]=D.noDisposeOnSet||!1,this[w]=D.updateAgeOnGet||!1,this.reset()}set max(D){if(typeof D!="number"||D<0)throw new TypeError("max must be a non-negative number");this[_]=D||1/0,A(this)}get max(){return this[_]}set allowStale(D){this[l]=!!D}get allowStale(){return this[l]}set maxAge(D){if(typeof D!="number")throw new TypeError("maxAge must be a non-negative number");this[s]=D,A(this)}get maxAge(){return this[s]}set lengthCalculator(D){typeof D!="function"&&(D=m),D!==this[t]&&(this[t]=D,this[o]=0,this[p].forEach(H=>{H.length=this[t](H.value,H.key),this[o]+=H.length})),A(this)}get lengthCalculator(){return this[t]}get length(){return this[o]}get itemCount(){return this[p].length}rforEach(D,H){H=H||this;for(let L=this[p].tail;L!==null;){const I=L.prev;F(this,D,L,H),L=I}}forEach(D,H){H=H||this;for(let L=this[p].head;L!==null;){const I=L.next;F(this,D,L,H),L=I}}keys(){return this[p].toArray().map(D=>D.key)}values(){return this[p].toArray().map(D=>D.value)}reset(){this[i]&&this[p]&&this[p].length&&this[p].forEach(D=>this[i](D.key,D.value)),this[v]=new Map,this[p]=new C,this[o]=0}dump(){return this[p].map(D=>!E(this,D)&&{k:D.key,v:D.value,e:D.now+(D.maxAge||0)}).toArray().filter(D=>D)}dumpLru(){return this[p]}set(D,H,L){if((L=L||this[s])&&typeof L!="number")throw new TypeError("maxAge must be a number");const I=L?Date.now():0,O=this[t](H,D);if(this[v].has(D)){if(O>this[_])return T(this,this[v].get(D)),!1;const Q=this[v].get(D).value;return this[i]&&(this[h]||this[i](D,Q.value)),Q.now=I,Q.maxAge=L,Q.value=H,this[o]+=O-Q.length,Q.length=O,this.get(D),A(this),!0}const P=new B(D,H,O,I,L);return P.length>this[_]?(this[i]&&this[i](D,H),!1):(this[o]+=P.length,this[p].unshift(P),this[v].set(D,this[p].head),A(this),!0)}has(D){if(!this[v].has(D))return!1;const H=this[v].get(D).value;return!E(this,H)}get(D){return b(this,D,!0)}peek(D){return b(this,D,!1)}pop(){const D=this[p].tail;return D?(T(this,D),D.value):null}del(D){T(this,this[v].get(D))}load(D){this.reset();const H=Date.now();for(let L=D.length-1;L>=0;L--){const I=D[L],O=I.e||0;if(O===0)this.set(I.k,I.v);else{const P=O-H;P>0&&this.set(I.k,I.v,P)}}}prune(){this[v].forEach((D,H)=>b(this,H,!1))}}},602:(f,u,d)=>{d.r(u),d.d(u,{BoundingBox:()=>l,Font:()=>bi,Glyph:()=>Rt,Path:()=>i,_parse:()=>fe,load:()=>on,loadSync:()=>an,parse:()=>qt});var C=d(311),_=d.n(C);function o(e,r,n,a,S){return Math.pow(1-S,3)*e+3*Math.pow(1-S,2)*S*r+3*(1-S)*Math.pow(S,2)*n+Math.pow(S,3)*a}function t(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}t.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},t.prototype.addPoint=function(e,r){typeof e=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof r=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=r,this.y2=r),r<this.y1&&(this.y1=r),r>this.y2&&(this.y2=r))},t.prototype.addX=function(e){this.addPoint(e,null)},t.prototype.addY=function(e){this.addPoint(null,e)},t.prototype.addBezier=function(e,r,n,a,S,x,k,M){const R=[e,r],N=[n,a],q=[S,x],Y=[k,M];this.addPoint(e,r),this.addPoint(k,M);for(let Z=0;Z<=1;Z++){const de=6*R[Z]-12*N[Z]+6*q[Z],ae=-3*R[Z]+9*N[Z]-9*q[Z]+3*Y[Z],ye=3*N[Z]-3*R[Z];if(ae===0){if(de===0)continue;const Se=-ye/de;0<Se&&Se<1&&(Z===0&&this.addX(o(R[Z],N[Z],q[Z],Y[Z],Se)),Z===1&&this.addY(o(R[Z],N[Z],q[Z],Y[Z],Se)));continue}const oe=Math.pow(de,2)-4*ye*ae;if(oe<0)continue;const le=(-de+Math.sqrt(oe))/(2*ae);0<le&&le<1&&(Z===0&&this.addX(o(R[Z],N[Z],q[Z],Y[Z],le)),Z===1&&this.addY(o(R[Z],N[Z],q[Z],Y[Z],le)));const me=(-de-Math.sqrt(oe))/(2*ae);0<me&&me<1&&(Z===0&&this.addX(o(R[Z],N[Z],q[Z],Y[Z],me)),Z===1&&this.addY(o(R[Z],N[Z],q[Z],Y[Z],me)))}},t.prototype.addQuad=function(e,r,n,a,S,x){const k=e+.6666666666666666*(n-e),M=r+2/3*(a-r),R=k+1/3*(S-e),N=M+1/3*(x-r);this.addBezier(e,r,k,M,R,N,S,x)};const l=t;function s(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}s.prototype.moveTo=function(e,r){this.commands.push({type:"M",x:e,y:r})},s.prototype.lineTo=function(e,r){this.commands.push({type:"L",x:e,y:r})},s.prototype.curveTo=s.prototype.bezierCurveTo=function(e,r,n,a,S,x){this.commands.push({type:"C",x1:e,y1:r,x2:n,y2:a,x:S,y:x})},s.prototype.quadTo=s.prototype.quadraticCurveTo=function(e,r,n,a){this.commands.push({type:"Q",x1:e,y1:r,x:n,y:a})},s.prototype.close=s.prototype.closePath=function(){this.commands.push({type:"Z"})},s.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof l){const r=e;return this.moveTo(r.x1,r.y1),this.lineTo(r.x2,r.y1),this.lineTo(r.x2,r.y2),this.lineTo(r.x1,r.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},s.prototype.getBoundingBox=function(){const e=new l;let r=0,n=0,a=0,S=0;for(let x=0;x<this.commands.length;x++){const k=this.commands[x];switch(k.type){case"M":e.addPoint(k.x,k.y),r=a=k.x,n=S=k.y;break;case"L":e.addPoint(k.x,k.y),a=k.x,S=k.y;break;case"Q":e.addQuad(a,S,k.x1,k.y1,k.x,k.y),a=k.x,S=k.y;break;case"C":e.addBezier(a,S,k.x1,k.y1,k.x2,k.y2,k.x,k.y),a=k.x,S=k.y;break;case"Z":a=r,S=n;break;default:throw new Error("Unexpected path command "+k.type)}}return e.isEmpty()&&e.addPoint(0,0),e},s.prototype.draw=function(e){e.beginPath();for(let r=0;r<this.commands.length;r+=1){const n=this.commands[r];n.type==="M"?e.moveTo(n.x,n.y):n.type==="L"?e.lineTo(n.x,n.y):n.type==="C"?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):n.type==="Q"?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):n.type==="Z"&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},s.prototype.toPathData=function(e){function r(S){return Math.round(S)===S?""+Math.round(S):S.toFixed(e)}function n(){let S="";for(let x=0;x<arguments.length;x+=1){const k=arguments[x];k>=0&&x>0&&(S+=" "),S+=r(k)}return S}e=e!==void 0?e:2;let a="";for(let S=0;S<this.commands.length;S+=1){const x=this.commands[S];x.type==="M"?a+="M"+n(x.x,x.y):x.type==="L"?a+="L"+n(x.x,x.y):x.type==="C"?a+="C"+n(x.x1,x.y1,x.x2,x.y2,x.x,x.y):x.type==="Q"?a+="Q"+n(x.x1,x.y1,x.x,x.y):x.type==="Z"&&(a+="Z")}return a},s.prototype.toSVG=function(e){let r='<path d="';return r+=this.toPathData(e),r+='"',this.fill&&this.fill!=="black"&&(this.fill===null?r+=' fill="none"':r+=' fill="'+this.fill+'"'),this.stroke&&(r+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),r+="/>",r},s.prototype.toDOMElement=function(e){const r=this.toPathData(e),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",r),n};const i=s;function h(e){throw new Error(e)}function p(e,r){e||h(r)}const v={fail:h,argument:p,assert:p},w=2147483648,m={},b={},E={};function A(e){return function(){return e}}b.BYTE=function(e){return v.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},E.BYTE=A(1),b.CHAR=function(e){return[e.charCodeAt(0)]},E.CHAR=A(1),b.CHARARRAY=function(e){const r=[];for(let n=0;n<e.length;n+=1)r[n]=e.charCodeAt(n);return r},E.CHARARRAY=function(e){return e.length},b.USHORT=function(e){return[e>>8&255,255&e]},E.USHORT=A(2),b.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},E.SHORT=A(2),b.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},E.UINT24=A(3),b.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},E.ULONG=A(4),b.LONG=function(e){return e>=w&&(e=-(2*w-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},E.LONG=A(4),b.FIXED=b.ULONG,E.FIXED=E.ULONG,b.FWORD=b.SHORT,E.FWORD=E.SHORT,b.UFWORD=b.USHORT,E.UFWORD=E.USHORT,b.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},E.LONGDATETIME=A(8),b.TAG=function(e){return v.argument(e.length===4,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},E.TAG=A(4),b.Card8=b.BYTE,E.Card8=E.BYTE,b.Card16=b.USHORT,E.Card16=E.USHORT,b.OffSize=b.BYTE,E.OffSize=E.BYTE,b.SID=b.USHORT,E.SID=E.USHORT,b.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?b.NUMBER16(e):b.NUMBER32(e)},E.NUMBER=function(e){return b.NUMBER(e).length},b.NUMBER16=function(e){return[28,e>>8&255,255&e]},E.NUMBER16=A(3),b.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},E.NUMBER32=A(5),b.REAL=function(e){let r=e.toString();const n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(r);if(n){const x=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));r=(Math.round(e*x)/x).toString()}let a="";for(let x=0,k=r.length;x<k;x+=1){const M=r[x];a+=M==="e"?r[++x]==="-"?"c":"b":M==="."?"a":M==="-"?"e":M}a+=1&a.length?"f":"ff";const S=[30];for(let x=0,k=a.length;x<k;x+=2)S.push(parseInt(a.substr(x,2),16));return S},E.REAL=function(e){return b.REAL(e).length},b.NAME=b.CHARARRAY,E.NAME=E.CHARARRAY,b.STRING=b.CHARARRAY,E.STRING=E.CHARARRAY,m.UTF8=function(e,r,n){const a=[],S=n;for(let x=0;x<S;x++,r+=1)a[x]=e.getUint8(r);return String.fromCharCode.apply(null,a)},m.UTF16=function(e,r,n){const a=[],S=n/2;for(let x=0;x<S;x++,r+=2)a[x]=e.getUint16(r);return String.fromCharCode.apply(null,a)},b.UTF16=function(e){const r=[];for(let n=0;n<e.length;n+=1){const a=e.charCodeAt(n);r[r.length]=a>>8&255,r[r.length]=255&a}return r},E.UTF16=function(e){return 2*e.length};const T={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};m.MACSTRING=function(e,r,n,a){const S=T[a];if(S===void 0)return;let x="";for(let k=0;k<n;k++){const M=e.getUint8(r+k);x+=M<=127?String.fromCharCode(M):S[127&M]}return x};const B=typeof WeakMap=="function"&&new WeakMap;let F;function D(e){return e>=-128&&e<=127}function H(e,r,n){let a=0;const S=e.length;for(;r<S&&a<64&&e[r]===0;)++r,++a;return n.push(128|a-1),r}function L(e,r,n){let a=0;const S=e.length;let x=r;for(;x<S&&a<64;){const k=e[x];if(!D(k)||k===0&&x+1<S&&e[x+1]===0)break;++x,++a}n.push(a-1);for(let k=r;k<x;++k)n.push(e[k]+256&255);return x}function I(e,r,n){let a=0;const S=e.length;let x=r;for(;x<S&&a<64;){const k=e[x];if(k===0||D(k)&&x+1<S&&D(e[x+1]))break;++x,++a}n.push(64|a-1);for(let k=r;k<x;++k){const M=e[k];n.push(M+65536>>8&255,M+256&255)}return x}b.MACSTRING=function(e,r){const n=function(S){if(!F){F={};for(let R in T)F[R]=new String(R)}const x=F[S];if(x===void 0)return;if(B){const R=B.get(x);if(R!==void 0)return R}const k=T[S];if(k===void 0)return;const M={};for(let R=0;R<k.length;R++)M[k.charCodeAt(R)]=R+128;return B&&B.set(x,M),M}(r);if(n===void 0)return;const a=[];for(let S=0;S<e.length;S++){let x=e.charCodeAt(S);if(x>=128&&(x=n[x],x===void 0))return;a[S]=x}return a},E.MACSTRING=function(e,r){const n=b.MACSTRING(e,r);return n!==void 0?n.length:0},b.VARDELTAS=function(e){let r=0;const n=[];for(;r<e.length;){const a=e[r];r=a===0?H(e,r,n):a>=-128&&a<=127?L(e,r,n):I(e,r,n)}return n},b.INDEX=function(e){let r=1;const n=[r],a=[];for(let M=0;M<e.length;M+=1){const R=b.OBJECT(e[M]);Array.prototype.push.apply(a,R),r+=R.length,n.push(r)}if(a.length===0)return[0,0];const S=[],x=1+Math.floor(Math.log(r)/Math.log(2))/8|0,k=[void 0,b.BYTE,b.USHORT,b.UINT24,b.ULONG][x];for(let M=0;M<n.length;M+=1){const R=k(n[M]);Array.prototype.push.apply(S,R)}return Array.prototype.concat(b.Card16(e.length),b.OffSize(x),S,a)},E.INDEX=function(e){return b.INDEX(e).length},b.DICT=function(e){let r=[];const n=Object.keys(e),a=n.length;for(let S=0;S<a;S+=1){const x=parseInt(n[S],0),k=e[x];r=r.concat(b.OPERAND(k.value,k.type)),r=r.concat(b.OPERATOR(x))}return r},E.DICT=function(e){return b.DICT(e).length},b.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},b.OPERAND=function(e,r){let n=[];if(Array.isArray(r))for(let a=0;a<r.length;a+=1)v.argument(e.length===r.length,"Not enough arguments given for type"+r),n=n.concat(b.OPERAND(e[a],r[a]));else if(r==="SID")n=n.concat(b.NUMBER(e));else if(r==="offset")n=n.concat(b.NUMBER32(e));else if(r==="number")n=n.concat(b.NUMBER(e));else{if(r!=="real")throw new Error("Unknown operand type "+r);n=n.concat(b.REAL(e))}return n},b.OP=b.BYTE,E.OP=E.BYTE;const O=typeof WeakMap=="function"&&new WeakMap;function P(e,r,n){for(let a=0;a<r.length;a+=1){const S=r[a];this[S.name]=S.value}if(this.tableName=e,this.fields=r,n){const a=Object.keys(n);for(let S=0;S<a.length;S+=1){const x=a[S],k=n[x];this[x]!==void 0&&(this[x]=k)}}}function Q(e,r,n){n===void 0&&(n=r.length);const a=new Array(r.length+1);a[0]={name:e+"Count",type:"USHORT",value:n};for(let S=0;S<r.length;S++)a[S+1]={name:e+S,type:"USHORT",value:r[S]};return a}function z(e,r,n){const a=r.length,S=new Array(a+1);S[0]={name:e+"Count",type:"USHORT",value:a};for(let x=0;x<a;x++)S[x+1]={name:e+x,type:"TABLE",value:n(r[x],x)};return S}function X(e,r,n){const a=r.length;let S=[];S[0]={name:e+"Count",type:"USHORT",value:a};for(let x=0;x<a;x++)S=S.concat(n(r[x],x));return S}function K(e){e.format===1?P.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Q("glyph",e.glyphs))):v.assert(!1,"Can't create coverage table format 2 yet.")}function ie(e){P.call(this,"scriptListTable",X("scriptRecord",e,function(r,n){const a=r.script;let S=a.defaultLangSys;return v.assert(!!S,"Unable to write GSUB: script "+r.tag+" has no default language system."),[{name:"scriptTag"+n,type:"TAG",value:r.tag},{name:"script"+n,type:"TABLE",value:new P("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new P("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:S.reqFeatureIndex}].concat(Q("featureIndex",S.featureIndexes)))}].concat(X("langSys",a.langSysRecords,function(x,k){const M=x.langSys;return[{name:"langSysTag"+k,type:"TAG",value:x.tag},{name:"langSys"+k,type:"TABLE",value:new P("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:M.reqFeatureIndex}].concat(Q("featureIndex",M.featureIndexes)))}]})))}]}))}function G(e){P.call(this,"featureListTable",X("featureRecord",e,function(r,n){const a=r.feature;return[{name:"featureTag"+n,type:"TAG",value:r.tag},{name:"feature"+n,type:"TABLE",value:new P("featureTable",[{name:"featureParams",type:"USHORT",value:a.featureParams}].concat(Q("lookupListIndex",a.lookupListIndexes)))}]}))}function j(e,r){P.call(this,"lookupListTable",z("lookup",e,function(n){let a=r[n.lookupType];return v.assert(!!a,"Unable to write GSUB lookup type "+n.lookupType+" tables."),new P("lookupTable",[{name:"lookupType",type:"USHORT",value:n.lookupType},{name:"lookupFlag",type:"USHORT",value:n.lookupFlag}].concat(z("subtable",n.subtables,a)))}))}b.CHARSTRING=function(e){if(O){const a=O.get(e);if(a!==void 0)return a}let r=[];const n=e.length;for(let a=0;a<n;a+=1){const S=e[a];r=r.concat(b[S.type](S.value))}return O&&O.set(e,r),r},E.CHARSTRING=function(e){return b.CHARSTRING(e).length},b.OBJECT=function(e){const r=b[e.type];return v.argument(r!==void 0,"No encoding function for type "+e.type),r(e.value)},E.OBJECT=function(e){const r=E[e.type];return v.argument(r!==void 0,"No sizeOf function for type "+e.type),r(e.value)},b.TABLE=function(e){let r=[];const n=e.fields.length,a=[],S=[];for(let x=0;x<n;x+=1){const k=e.fields[x],M=b[k.type];v.argument(M!==void 0,"No encoding function for field type "+k.type+" ("+k.name+")");let R=e[k.name];R===void 0&&(R=k.value);const N=M(R);k.type==="TABLE"?(S.push(r.length),r=r.concat([0,0]),a.push(N)):r=r.concat(N)}for(let x=0;x<a.length;x+=1){const k=S[x],M=r.length;v.argument(M<65536,"Table "+e.tableName+" too big."),r[k]=M>>8,r[k+1]=255&M,r=r.concat(a[x])}return r},E.TABLE=function(e){let r=0;const n=e.fields.length;for(let a=0;a<n;a+=1){const S=e.fields[a],x=E[S.type];v.argument(x!==void 0,"No sizeOf function for field type "+S.type+" ("+S.name+")");let k=e[S.name];k===void 0&&(k=S.value),r+=x(k),S.type==="TABLE"&&(r+=2)}return r},b.RECORD=b.TABLE,E.RECORD=E.TABLE,b.LITERAL=function(e){return e},E.LITERAL=function(e){return e.length},P.prototype.encode=function(){return b.TABLE(this)},P.prototype.sizeOf=function(){return E.TABLE(this)},K.prototype=Object.create(P.prototype),K.prototype.constructor=K,ie.prototype=Object.create(P.prototype),ie.prototype.constructor=ie,G.prototype=Object.create(P.prototype),G.prototype.constructor=G,j.prototype=Object.create(P.prototype),j.prototype.constructor=j;const W={Table:P,Record:P,Coverage:K,ScriptList:ie,FeatureList:G,LookupList:j,ushortList:Q,tableList:z,recordList:X};function te(e,r){return e.getUint8(r)}function ne(e,r){return e.getUint16(r,!1)}function be(e,r){return e.getUint32(r,!1)}function he(e,r){return e.getInt16(r,!1)+e.getUint16(r+2,!1)/65535}const ke={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function ee(e,r){this.data=e,this.offset=r,this.relativeOffset=0}ee.prototype.parseByte=function(){const e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},ee.prototype.parseChar=function(){const e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},ee.prototype.parseCard8=ee.prototype.parseByte,ee.prototype.parseUShort=function(){const e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},ee.prototype.parseCard16=ee.prototype.parseUShort,ee.prototype.parseSID=ee.prototype.parseUShort,ee.prototype.parseOffset16=ee.prototype.parseUShort,ee.prototype.parseShort=function(){const e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},ee.prototype.parseF2Dot14=function(){const e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},ee.prototype.parseULong=function(){const e=be(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},ee.prototype.parseOffset32=ee.prototype.parseULong,ee.prototype.parseFixed=function(){const e=he(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},ee.prototype.parseString=function(e){const r=this.data,n=this.offset+this.relativeOffset;let a="";this.relativeOffset+=e;for(let S=0;S<e;S++)a+=String.fromCharCode(r.getUint8(n+S));return a},ee.prototype.parseTag=function(){return this.parseString(4)},ee.prototype.parseLongDateTime=function(){let e=be(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},ee.prototype.parseVersion=function(e){const r=ne(this.data,this.offset+this.relativeOffset),n=ne(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e===void 0&&(e=4096),r+n/e/10},ee.prototype.skip=function(e,r){r===void 0&&(r=1),this.relativeOffset+=ke[e]*r},ee.prototype.parseULongList=function(e){e===void 0&&(e=this.parseULong());const r=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=n.getUint32(a),a+=4;return this.relativeOffset+=4*e,r},ee.prototype.parseOffset16List=ee.prototype.parseUShortList=function(e){e===void 0&&(e=this.parseUShort());const r=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=n.getUint16(a),a+=2;return this.relativeOffset+=2*e,r},ee.prototype.parseShortList=function(e){const r=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=n.getInt16(a),a+=2;return this.relativeOffset+=2*e,r},ee.prototype.parseByteList=function(e){const r=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let S=0;S<e;S++)r[S]=n.getUint8(a++);return this.relativeOffset+=e,r},ee.prototype.parseList=function(e,r){r||(r=e,e=this.parseUShort());const n=new Array(e);for(let a=0;a<e;a++)n[a]=r.call(this);return n},ee.prototype.parseList32=function(e,r){r||(r=e,e=this.parseULong());const n=new Array(e);for(let a=0;a<e;a++)n[a]=r.call(this);return n},ee.prototype.parseRecordList=function(e,r){r||(r=e,e=this.parseUShort());const n=new Array(e),a=Object.keys(r);for(let S=0;S<e;S++){const x={};for(let k=0;k<a.length;k++){const M=a[k],R=r[M];x[M]=R.call(this)}n[S]=x}return n},ee.prototype.parseRecordList32=function(e,r){r||(r=e,e=this.parseULong());const n=new Array(e),a=Object.keys(r);for(let S=0;S<e;S++){const x={};for(let k=0;k<a.length;k++){const M=a[k],R=r[M];x[M]=R.call(this)}n[S]=x}return n},ee.prototype.parseStruct=function(e){if(typeof e=="function")return e.call(this);{const r=Object.keys(e),n={};for(let a=0;a<r.length;a++){const S=r[a],x=e[S];n[S]=x.call(this)}return n}},ee.prototype.parseValueRecord=function(e){if(e===void 0&&(e=this.parseUShort()),e===0)return;const r={};return 1&e&&(r.xPlacement=this.parseShort()),2&e&&(r.yPlacement=this.parseShort()),4&e&&(r.xAdvance=this.parseShort()),8&e&&(r.yAdvance=this.parseShort()),16&e&&(r.xPlaDevice=void 0,this.parseShort()),32&e&&(r.yPlaDevice=void 0,this.parseShort()),64&e&&(r.xAdvDevice=void 0,this.parseShort()),128&e&&(r.yAdvDevice=void 0,this.parseShort()),r},ee.prototype.parseValueRecordList=function(){const e=this.parseUShort(),r=this.parseUShort(),n=new Array(r);for(let a=0;a<r;a++)n[a]=this.parseValueRecord(e);return n},ee.prototype.parsePointer=function(e){const r=this.parseOffset16();if(r>0)return new ee(this.data,this.offset+r).parseStruct(e)},ee.prototype.parsePointer32=function(e){const r=this.parseOffset32();if(r>0)return new ee(this.data,this.offset+r).parseStruct(e)},ee.prototype.parseListOfLists=function(e){const r=this.parseOffset16List(),n=r.length,a=this.relativeOffset,S=new Array(n);for(let x=0;x<n;x++){const k=r[x];if(k!==0)if(this.relativeOffset=k,e){const M=this.parseOffset16List(),R=new Array(M.length);for(let N=0;N<M.length;N++)this.relativeOffset=k+M[N],R[N]=e.call(this);S[x]=R}else S[x]=this.parseUShortList();else S[x]=void 0}return this.relativeOffset=a,S},ee.prototype.parseCoverage=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort(),n=this.parseUShort();if(r===1)return{format:1,glyphs:this.parseUShortList(n)};if(r===2){const a=new Array(n);for(let S=0;S<n;S++)a[S]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:a}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},ee.prototype.parseClassDef=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(r===2)return{format:2,ranges:this.parseRecordList({start:ee.uShort,end:ee.uShort,classId:ee.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},ee.list=function(e,r){return function(){return this.parseList(e,r)}},ee.list32=function(e,r){return function(){return this.parseList32(e,r)}},ee.recordList=function(e,r){return function(){return this.parseRecordList(e,r)}},ee.recordList32=function(e,r){return function(){return this.parseRecordList32(e,r)}},ee.pointer=function(e){return function(){return this.parsePointer(e)}},ee.pointer32=function(e){return function(){return this.parsePointer32(e)}},ee.tag=ee.prototype.parseTag,ee.byte=ee.prototype.parseByte,ee.uShort=ee.offset16=ee.prototype.parseUShort,ee.uShortList=ee.prototype.parseUShortList,ee.uLong=ee.offset32=ee.prototype.parseULong,ee.uLongList=ee.prototype.parseULongList,ee.struct=ee.prototype.parseStruct,ee.coverage=ee.prototype.parseCoverage,ee.classDef=ee.prototype.parseClassDef;const Ee={reserved:ee.uShort,reqFeatureIndex:ee.uShort,featureIndexes:ee.uShortList};ee.prototype.parseScriptList=function(){return this.parsePointer(ee.recordList({tag:ee.tag,script:ee.pointer({defaultLangSys:ee.pointer(Ee),langSysRecords:ee.recordList({tag:ee.tag,langSys:ee.pointer(Ee)})})}))||[]},ee.prototype.parseFeatureList=function(){return this.parsePointer(ee.recordList({tag:ee.tag,feature:ee.pointer({featureParams:ee.offset16,lookupListIndexes:ee.uShortList})}))||[]},ee.prototype.parseLookupList=function(e){return this.parsePointer(ee.list(ee.pointer(function(){const r=this.parseUShort();v.argument(1<=r&&r<=9,"GPOS/GSUB lookup type "+r+" unknown.");const n=this.parseUShort(),a=16&n;return{lookupType:r,lookupFlag:n,subtables:this.parseList(ee.pointer(e[r])),markFilteringSet:a?this.parseUShort():void 0}})))||[]},ee.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){const e=this.parseUShort(),r=this.parseUShort();return v.argument(e===1&&r<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:ee.offset32,featureTableSubstitutionOffset:ee.offset32})})||[]};const fe={getByte:te,getCard8:te,getUShort:ne,getCard16:ne,getShort:function(e,r){return e.getInt16(r,!1)},getULong:be,getFixed:he,getTag:function(e,r){let n="";for(let a=r;a<r+4;a+=1)n+=String.fromCharCode(e.getInt8(a));return n},getOffset:function(e,r,n){let a=0;for(let S=0;S<n;S+=1)a<<=8,a+=e.getUint8(r+S);return a},getBytes:function(e,r,n){const a=[];for(let S=r;S<n;S+=1)a.push(e.getUint8(S));return a},bytesToString:function(e){let r="";for(let n=0;n<e.length;n+=1)r+=String.fromCharCode(e[n]);return r},Parser:ee};function st(e,r,n){e.segments.push({end:r,start:r,delta:-(r-n),offset:0,glyphIndex:n})}const Re=function(e,r){const n={};n.version=fe.getUShort(e,r),v.argument(n.version===0,"cmap table version should be 0."),n.numTables=fe.getUShort(e,r+2);let a=-1;for(let x=n.numTables-1;x>=0;x-=1){const k=fe.getUShort(e,r+4+8*x),M=fe.getUShort(e,r+4+8*x+2);if(k===3&&(M===0||M===1||M===10)){a=fe.getULong(e,r+4+8*x+4);break}}if(a===-1)throw new Error("No valid cmap sub-tables found.");const S=new fe.Parser(e,r+a);if(n.format=S.parseUShort(),n.format===12)(function(x,k){let M;k.parseUShort(),x.length=k.parseULong(),x.language=k.parseULong(),x.groupCount=M=k.parseULong(),x.glyphIndexMap={};for(let R=0;R<M;R+=1){const N=k.parseULong(),q=k.parseULong();let Y=k.parseULong();for(let Z=N;Z<=q;Z+=1)x.glyphIndexMap[Z]=Y,Y++}})(n,S);else{if(n.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");(function(x,k,M,R,N){let q;x.length=k.parseUShort(),x.language=k.parseUShort(),x.segCount=q=k.parseUShort()>>1,k.skip("uShort",3),x.glyphIndexMap={};const Y=new fe.Parser(M,R+N+14),Z=new fe.Parser(M,R+N+16+2*q),de=new fe.Parser(M,R+N+16+4*q),ae=new fe.Parser(M,R+N+16+6*q);let ye=R+N+16+8*q;for(let oe=0;oe<q-1;oe+=1){let le;const me=Y.parseUShort(),Se=Z.parseUShort(),Le=de.parseShort(),pe=ae.parseUShort();for(let ue=Se;ue<=me;ue+=1)pe!==0?(ye=ae.offset+ae.relativeOffset-2,ye+=pe,ye+=2*(ue-Se),le=fe.getUShort(M,ye),le!==0&&(le=le+Le&65535)):le=ue+Le&65535,x.glyphIndexMap[ue]=le}})(n,S,e,r,a)}return n},re=function(e){let r,n=!0;for(r=e.length-1;r>0;r-=1)if(e.get(r).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}let a=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(a=a.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),a=a.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);const S=new W.Table("cmap",a);for(S.segments=[],r=0;r<e.length;r+=1){const de=e.get(r);for(let ae=0;ae<de.unicodes.length;ae+=1)st(S,de.unicodes[ae],r);S.segments=S.segments.sort(function(ae,ye){return ae.start-ye.start})}(function(de){de.segments.push({end:65535,start:65535,delta:1,offset:0})})(S);const x=S.segments.length;let k=0,M=[],R=[],N=[],q=[],Y=[],Z=[];for(r=0;r<x;r+=1){const de=S.segments[r];de.end<=65535&&de.start<=65535?(M=M.concat({name:"end_"+r,type:"USHORT",value:de.end}),R=R.concat({name:"start_"+r,type:"USHORT",value:de.start}),N=N.concat({name:"idDelta_"+r,type:"SHORT",value:de.delta}),q=q.concat({name:"idRangeOffset_"+r,type:"USHORT",value:de.offset}),de.glyphId!==void 0&&(Y=Y.concat({name:"glyph_"+r,type:"USHORT",value:de.glyphId}))):k+=1,n||de.glyphIndex===void 0||(Z=Z.concat({name:"cmap12Start_"+r,type:"ULONG",value:de.start}),Z=Z.concat({name:"cmap12End_"+r,type:"ULONG",value:de.end}),Z=Z.concat({name:"cmap12Glyph_"+r,type:"ULONG",value:de.glyphIndex}))}if(S.segCountX2=2*(x-k),S.searchRange=2*Math.pow(2,Math.floor(Math.log(x-k)/Math.log(2))),S.entrySelector=Math.log(S.searchRange/2)/Math.log(2),S.rangeShift=S.segCountX2-S.searchRange,S.fields=S.fields.concat(M),S.fields.push({name:"reservedPad",type:"USHORT",value:0}),S.fields=S.fields.concat(R),S.fields=S.fields.concat(N),S.fields=S.fields.concat(q),S.fields=S.fields.concat(Y),S.cmap4Length=14+2*M.length+2+2*R.length+2*N.length+2*q.length+2*Y.length,!n){const de=16+4*Z.length;S.cmap12Offset=20+S.cmap4Length,S.fields=S.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:de},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:Z.length/3}]),S.fields=S.fields.concat(Z)}return S},xe=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Ce=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],Ae=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Pe=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Ne(e){this.font=e}function nt(e){this.cmap=e}function Qe(e,r){this.encoding=e,this.charset=r}function ze(e){switch(e.version){case 1:this.names=Pe.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(let r=0;r<e.numberOfGlyphs;r++)e.glyphNameIndex[r]<Pe.length?this.names[r]=Pe[e.glyphNameIndex[r]]:this.names[r]=e.names[e.glyphNameIndex[r]-Pe.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(let r=0;r<e.numberOfGlyphs;r++)this.names[r]=Pe[r+e.glyphNameIndex[r]];break;default:this.names=[]}}Ne.prototype.charToGlyphIndex=function(e){const r=e.charCodeAt(0),n=this.font.glyphs;if(n)for(let a=0;a<n.length;a+=1){const S=n.get(a);for(let x=0;x<S.unicodes.length;x+=1)if(S.unicodes[x]===r)return a}return null},nt.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},Qe.prototype.charToGlyphIndex=function(e){const r=e.charCodeAt(0),n=this.encoding[r];return this.charset.indexOf(n)},ze.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},ze.prototype.glyphIndexToName=function(e){return this.names[e]};const Me=function(e,r,n,a,S){e.beginPath(),e.moveTo(r,n),e.lineTo(a,S),e.stroke()};function Ve(e,r,n,a,S){let x;return(r&a)>0?(x=e.parseByte(),!(r&S)&&(x=-x),x=n+x):x=(r&S)>0?n:n+e.parseShort(),x}function Ct(e,r,n){const a=new fe.Parser(r,n);let S,x;if(e.numberOfContours=a.parseShort(),e._xMin=a.parseShort(),e._yMin=a.parseShort(),e._xMax=a.parseShort(),e._yMax=a.parseShort(),e.numberOfContours>0){const k=e.endPointIndices=[];for(let R=0;R<e.numberOfContours;R+=1)k.push(a.parseUShort());e.instructionLength=a.parseUShort(),e.instructions=[];for(let R=0;R<e.instructionLength;R+=1)e.instructions.push(a.parseByte());const M=k[k.length-1]+1;S=[];for(let R=0;R<M;R+=1)if(x=a.parseByte(),S.push(x),(8&x)>0){const N=a.parseByte();for(let q=0;q<N;q+=1)S.push(x),R+=1}if(v.argument(S.length===M,"Bad flags."),k.length>0){const R=[];let N;if(M>0){for(let Z=0;Z<M;Z+=1)x=S[Z],N={},N.onCurve=!!(1&x),N.lastPointOfContour=k.indexOf(Z)>=0,R.push(N);let q=0;for(let Z=0;Z<M;Z+=1)x=S[Z],N=R[Z],N.x=Ve(a,x,q,2,16),q=N.x;let Y=0;for(let Z=0;Z<M;Z+=1)x=S[Z],N=R[Z],N.y=Ve(a,x,Y,4,32),Y=N.y}e.points=R}else e.points=[]}else if(e.numberOfContours===0)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];let k=!0;for(;k;){S=a.parseUShort();const M={glyphIndex:a.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&S)>0?(2&S)>0?(M.dx=a.parseShort(),M.dy=a.parseShort()):M.matchedPoints=[a.parseUShort(),a.parseUShort()]:(2&S)>0?(M.dx=a.parseChar(),M.dy=a.parseChar()):M.matchedPoints=[a.parseByte(),a.parseByte()],(8&S)>0?M.xScale=M.yScale=a.parseF2Dot14():(64&S)>0?(M.xScale=a.parseF2Dot14(),M.yScale=a.parseF2Dot14()):(128&S)>0&&(M.xScale=a.parseF2Dot14(),M.scale01=a.parseF2Dot14(),M.scale10=a.parseF2Dot14(),M.yScale=a.parseF2Dot14()),e.components.push(M),k=!!(32&S)}if(256&S){e.instructionLength=a.parseUShort(),e.instructions=[];for(let M=0;M<e.instructionLength;M+=1)e.instructions.push(a.parseByte())}}}function ot(e,r){const n=[];for(let a=0;a<e.length;a+=1){const S=e[a],x={x:r.xScale*S.x+r.scale01*S.y+r.dx,y:r.scale10*S.x+r.yScale*S.y+r.dy,onCurve:S.onCurve,lastPointOfContour:S.lastPointOfContour};n.push(x)}return n}function ft(e){const r=new i;if(!e)return r;const n=function(a){const S=[];let x=[];for(let k=0;k<a.length;k+=1){const M=a[k];x.push(M),M.lastPointOfContour&&(S.push(x),x=[])}return v.argument(x.length===0,"There are still points left in the current contour."),S}(e);for(let a=0;a<n.length;++a){const S=n[a];let x=null,k=S[S.length-1],M=S[0];if(k.onCurve)r.moveTo(k.x,k.y);else if(M.onCurve)r.moveTo(M.x,M.y);else{const R={x:.5*(k.x+M.x),y:.5*(k.y+M.y)};r.moveTo(R.x,R.y)}for(let R=0;R<S.length;++R)if(x=k,k=M,M=S[(R+1)%S.length],k.onCurve)r.lineTo(k.x,k.y);else{let N=x,q=M;x.onCurve||(N={x:.5*(k.x+x.x),y:.5*(k.y+x.y)},r.lineTo(N.x,N.y)),M.onCurve||(q={x:.5*(k.x+M.x),y:.5*(k.y+M.y)}),r.lineTo(N.x,N.y),r.quadraticCurveTo(k.x,k.y,q.x,q.y)}r.closePath()}return r}function kt(e,r){if(r.isComposite)for(let n=0;n<r.components.length;n+=1){const a=r.components[n],S=e.get(a.glyphIndex);if(S.getPath(),S.points){let x;if(a.matchedPoints===void 0)x=ot(S.points,a);else{if(a.matchedPoints[0]>r.points.length-1||a.matchedPoints[1]>S.points.length-1)throw Error("Matched points out of range in "+r.name);const k=r.points[a.matchedPoints[0]];let M=S.points[a.matchedPoints[1]];const R={xScale:a.xScale,scale01:a.scale01,scale10:a.scale10,yScale:a.yScale,dx:0,dy:0};M=ot([M],R)[0],R.dx=k.x-M.x,R.dy=k.y-M.y,x=ot(S.points,R)}r.points=r.points.concat(x)}}return ft(r.points)}const Er={getPath:ft,parse:function(e,r,n,a){const S=new _t.GlyphSet(a);for(let x=0;x<n.length-1;x+=1){const k=n[x];k!==n[x+1]?S.push(x,_t.ttfGlyphLoader(a,x,Ct,e,r+k,kt)):S.push(x,_t.glyphLoader(a,x))}return S}};function et(e){this.bindConstructorValues(e)}et.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||e.unicode!==void 0?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",function(r,n){let a=n||new i;return{configurable:!0,get:function(){return typeof a=="function"&&(a=a()),a},set:function(S){a=S}}}(0,e.path))},et.prototype.addUnicode=function(e){this.unicodes.length===0&&(this.unicode=e),this.unicodes.push(e)},et.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},et.prototype.getPath=function(e,r,n,a,S){let x,k;e=e!==void 0?e:0,r=r!==void 0?r:0,n=n!==void 0?n:72,a||(a={});let M=a.xScale,R=a.yScale;if(a.hinting&&S&&S.hinting&&(k=this.path&&S.hinting.exec(this,n)),k)x=Er.getPath(k).commands,e=Math.round(e),r=Math.round(r),M=R=1;else{x=this.path.commands;const q=1/this.path.unitsPerEm*n;M===void 0&&(M=q),R===void 0&&(R=q)}const N=new i;for(let q=0;q<x.length;q+=1){const Y=x[q];Y.type==="M"?N.moveTo(e+Y.x*M,r+-Y.y*R):Y.type==="L"?N.lineTo(e+Y.x*M,r+-Y.y*R):Y.type==="Q"?N.quadraticCurveTo(e+Y.x1*M,r+-Y.y1*R,e+Y.x*M,r+-Y.y*R):Y.type==="C"?N.curveTo(e+Y.x1*M,r+-Y.y1*R,e+Y.x2*M,r+-Y.y2*R,e+Y.x*M,r+-Y.y*R):Y.type==="Z"&&N.closePath()}return N},et.prototype.getContours=function(){if(this.points===void 0)return[];const e=[];let r=[];for(let n=0;n<this.points.length;n+=1){const a=this.points[n];r.push(a),a.lastPointOfContour&&(e.push(r),r=[])}return v.argument(r.length===0,"There are still points left in the current contour."),e},et.prototype.getMetrics=function(){const e=this.path.commands,r=[],n=[];for(let S=0;S<e.length;S+=1){const x=e[S];x.type!=="Z"&&(r.push(x.x),n.push(x.y)),x.type!=="Q"&&x.type!=="C"||(r.push(x.x1),n.push(x.y1)),x.type==="C"&&(r.push(x.x2),n.push(x.y2))}const a={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(a.xMin)||(a.xMin=0),isFinite(a.xMax)||(a.xMax=this.advanceWidth),isFinite(a.yMin)||(a.yMin=0),isFinite(a.yMax)||(a.yMax=0),a.rightSideBearing=this.advanceWidth-a.leftSideBearing-(a.xMax-a.xMin),a},et.prototype.draw=function(e,r,n,a,S){this.getPath(r,n,a,S).draw(e)},et.prototype.drawPoints=function(e,r,n,a){function S(N,q,Y,Z){const de=2*Math.PI;e.beginPath();for(let ae=0;ae<N.length;ae+=1)e.moveTo(q+N[ae].x*Z,Y+N[ae].y*Z),e.arc(q+N[ae].x*Z,Y+N[ae].y*Z,2,0,de,!1);e.closePath(),e.fill()}r=r!==void 0?r:0,n=n!==void 0?n:0,a=a!==void 0?a:24;const x=1/this.path.unitsPerEm*a,k=[],M=[],R=this.path;for(let N=0;N<R.commands.length;N+=1){const q=R.commands[N];q.x!==void 0&&k.push({x:q.x,y:-q.y}),q.x1!==void 0&&M.push({x:q.x1,y:-q.y1}),q.x2!==void 0&&M.push({x:q.x2,y:-q.y2})}e.fillStyle="blue",S(k,r,n,x),e.fillStyle="red",S(M,r,n,x)},et.prototype.drawMetrics=function(e,r,n,a){let S;r=r!==void 0?r:0,n=n!==void 0?n:0,a=a!==void 0?a:24,S=1/this.path.unitsPerEm*a,e.lineWidth=1,e.strokeStyle="black",Me(e,r,-1e4,r,1e4),Me(e,-1e4,n,1e4,n);const x=this.xMin||0;let k=this.yMin||0;const M=this.xMax||0;let R=this.yMax||0;const N=this.advanceWidth||0;e.strokeStyle="blue",Me(e,r+x*S,-1e4,r+x*S,1e4),Me(e,r+M*S,-1e4,r+M*S,1e4),Me(e,-1e4,n+-k*S,1e4,n+-k*S),Me(e,-1e4,n+-R*S,1e4,n+-R*S),e.strokeStyle="green",Me(e,r+N*S,-1e4,r+N*S,1e4)};const Rt=et;function At(e,r,n){Object.defineProperty(e,r,{get:function(){return e.path,e[n]},set:function(a){e[n]=a},enumerable:!0,configurable:!0})}function Ut(e,r){if(this.font=e,this.glyphs={},Array.isArray(r))for(let n=0;n<r.length;n++)this.glyphs[n]=r[n];this.length=r&&r.length||0}Ut.prototype.get=function(e){return typeof this.glyphs[e]=="function"&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},Ut.prototype.push=function(e,r){this.glyphs[e]=r,this.length++};const _t={GlyphSet:Ut,glyphLoader:function(e,r){return new Rt({index:r,font:e})},ttfGlyphLoader:function(e,r,n,a,S,x){return function(){const k=new Rt({index:r,font:e});return k.path=function(){n(k,a,S);const M=x(e.glyphs,k);return M.unitsPerEm=e.unitsPerEm,M},At(k,"xMin","_xMin"),At(k,"xMax","_xMax"),At(k,"yMin","_yMin"),At(k,"yMax","_yMax"),k}},cffGlyphLoader:function(e,r,n,a){return function(){const S=new Rt({index:r,font:e});return S.path=function(){const x=n(e,S,a);return x.unitsPerEm=e.unitsPerEm,x},S}}};function Lr(e,r){if(e===r)return!0;if(Array.isArray(e)&&Array.isArray(r)){if(e.length!==r.length)return!1;for(let n=0;n<e.length;n+=1)if(!Lr(e[n],r[n]))return!1;return!0}return!1}function Ft(e){let r;return r=e.length<1240?107:e.length<33900?1131:32768,r}function at(e,r,n){const a=[],S=[],x=fe.getCard16(e,r);let k,M;if(x!==0){const R=fe.getByte(e,r+2);k=r+(x+1)*R+2;let N=r+3;for(let q=0;q<x+1;q+=1)a.push(fe.getOffset(e,N,R)),N+=R;M=k+a[x]}else M=r+2;for(let R=0;R<a.length-1;R+=1){let N=fe.getBytes(e,k+a[R],k+a[R+1]);n&&(N=n(N)),S.push(N)}return{objects:S,startOffset:r,endOffset:M}}function as(e,r){let n,a,S,x;if(r===28)return n=e.parseByte(),a=e.parseByte(),n<<8|a;if(r===29)return n=e.parseByte(),a=e.parseByte(),S=e.parseByte(),x=e.parseByte(),n<<24|a<<16|S<<8|x;if(r===30)return function(k){let M="";const R=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(;;){const N=k.parseByte(),q=N>>4,Y=15&N;if(q===15||(M+=R[q],Y===15))break;M+=R[Y]}return parseFloat(M)}(e);if(r>=32&&r<=246)return r-139;if(r>=247&&r<=250)return n=e.parseByte(),256*(r-247)+n+108;if(r>=251&&r<=254)return n=e.parseByte(),256*-(r-251)-n-108;throw new Error("Invalid b0 "+r)}function kr(e,r,n){r=r!==void 0?r:0;const a=new fe.Parser(e,r),S=[];let x=[];for(n=n!==void 0?n:e.length;a.relativeOffset<n;){let k=a.parseByte();k<=21?(k===12&&(k=1200+a.parseByte()),S.push([k,x]),x=[]):x.push(as(a,k))}return function(k){const M={};for(let R=0;R<k.length;R+=1){const N=k[R][0],q=k[R][1];let Y;if(Y=q.length===1?q[0]:q,M.hasOwnProperty(N)&&!isNaN(M[N]))throw new Error("Object "+M+" already has key "+N);M[N]=Y}return M}(S)}function wt(e,r){return r<=390?xe[r]:e[r-391]}function Rr(e,r,n){const a={};let S;for(let x=0;x<r.length;x+=1){const k=r[x];if(Array.isArray(k.type)){const M=[];M.length=k.type.length;for(let R=0;R<k.type.length;R++)S=e[k.op]!==void 0?e[k.op][R]:void 0,S===void 0&&(S=k.value!==void 0&&k.value[R]!==void 0?k.value[R]:null),k.type[R]==="SID"&&(S=wt(n,S)),M[R]=S;a[k.name]=M}else S=e[k.op],S===void 0&&(S=k.value!==void 0?k.value:null),k.type==="SID"&&(S=wt(n,S)),a[k.name]=S}return a}const Ar=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Tr=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function ls(e,r){return Rr(kr(e,0,e.byteLength),Ar,r)}function Dr(e,r,n,a){return Rr(kr(e,r,n),Tr,a)}function Mr(e,r,n,a){const S=[];for(let x=0;x<n.length;x+=1){const k=ls(new DataView(new Uint8Array(n[x]).buffer),a);k._subrs=[],k._subrsBias=0;const M=k.private[0],R=k.private[1];if(M!==0&&R!==0){const N=Dr(e,R+r,M,a);if(k._defaultWidthX=N.defaultWidthX,k._nominalWidthX=N.nominalWidthX,N.subrs!==0){const q=at(e,R+N.subrs+r);k._subrs=q.objects,k._subrsBias=Ft(k._subrs)}k._privateDict=N}S.push(k)}return S}function cs(e,r,n){let a,S,x,k;const M=new i,R=[];let N,q,Y,Z,de=0,ae=!1,ye=!1,oe=0,le=0;if(e.isCIDFont){const pe=e.tables.cff.topDict._fdSelect[r.index],ue=e.tables.cff.topDict._fdArray[pe];N=ue._subrs,q=ue._subrsBias,Y=ue._defaultWidthX,Z=ue._nominalWidthX}else N=e.tables.cff.topDict._subrs,q=e.tables.cff.topDict._subrsBias,Y=e.tables.cff.topDict._defaultWidthX,Z=e.tables.cff.topDict._nominalWidthX;let me=Y;function Se(pe,ue){ye&&M.closePath(),M.moveTo(pe,ue),ye=!0}function Le(){let pe;pe=R.length%2!=0,pe&&!ae&&(me=R.shift()+Z),de+=R.length>>1,R.length=0,ae=!0}return function pe(ue){let ge,Te,we,Ie,We,qe,Fe,je,Ue,Ge,He,Ke,Be=0;for(;Be<ue.length;){let $e=ue[Be];switch(Be+=1,$e){case 1:case 3:case 18:case 23:Le();break;case 4:R.length>1&&!ae&&(me=R.shift()+Z,ae=!0),le+=R.pop(),Se(oe,le);break;case 5:for(;R.length>0;)oe+=R.shift(),le+=R.shift(),M.lineTo(oe,le);break;case 6:for(;R.length>0&&(oe+=R.shift(),M.lineTo(oe,le),R.length!==0);)le+=R.shift(),M.lineTo(oe,le);break;case 7:for(;R.length>0&&(le+=R.shift(),M.lineTo(oe,le),R.length!==0);)oe+=R.shift(),M.lineTo(oe,le);break;case 8:for(;R.length>0;)a=oe+R.shift(),S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+R.shift(),M.curveTo(a,S,x,k,oe,le);break;case 10:We=R.pop()+q,qe=N[We],qe&&pe(qe);break;case 11:return;case 12:switch($e=ue[Be],Be+=1,$e){case 35:a=oe+R.shift(),S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),Fe=x+R.shift(),je=k+R.shift(),Ue=Fe+R.shift(),Ge=je+R.shift(),He=Ue+R.shift(),Ke=Ge+R.shift(),oe=He+R.shift(),le=Ke+R.shift(),R.shift(),M.curveTo(a,S,x,k,Fe,je),M.curveTo(Ue,Ge,He,Ke,oe,le);break;case 34:a=oe+R.shift(),S=le,x=a+R.shift(),k=S+R.shift(),Fe=x+R.shift(),je=k,Ue=Fe+R.shift(),Ge=k,He=Ue+R.shift(),Ke=le,oe=He+R.shift(),M.curveTo(a,S,x,k,Fe,je),M.curveTo(Ue,Ge,He,Ke,oe,le);break;case 36:a=oe+R.shift(),S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),Fe=x+R.shift(),je=k,Ue=Fe+R.shift(),Ge=k,He=Ue+R.shift(),Ke=Ge+R.shift(),oe=He+R.shift(),M.curveTo(a,S,x,k,Fe,je),M.curveTo(Ue,Ge,He,Ke,oe,le);break;case 37:a=oe+R.shift(),S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),Fe=x+R.shift(),je=k+R.shift(),Ue=Fe+R.shift(),Ge=je+R.shift(),He=Ue+R.shift(),Ke=Ge+R.shift(),Math.abs(He-oe)>Math.abs(Ke-le)?oe=He+R.shift():le=Ke+R.shift(),M.curveTo(a,S,x,k,Fe,je),M.curveTo(Ue,Ge,He,Ke,oe,le);break;default:console.log("Glyph "+r.index+": unknown operator 1200"+$e),R.length=0}break;case 14:R.length>0&&!ae&&(me=R.shift()+Z,ae=!0),ye&&(M.closePath(),ye=!1);break;case 19:case 20:Le(),Be+=de+7>>3;break;case 21:R.length>2&&!ae&&(me=R.shift()+Z,ae=!0),le+=R.pop(),oe+=R.pop(),Se(oe,le);break;case 22:R.length>1&&!ae&&(me=R.shift()+Z,ae=!0),oe+=R.pop(),Se(oe,le);break;case 24:for(;R.length>2;)a=oe+R.shift(),S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+R.shift(),M.curveTo(a,S,x,k,oe,le);oe+=R.shift(),le+=R.shift(),M.lineTo(oe,le);break;case 25:for(;R.length>6;)oe+=R.shift(),le+=R.shift(),M.lineTo(oe,le);a=oe+R.shift(),S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+R.shift(),M.curveTo(a,S,x,k,oe,le);break;case 26:for(R.length%2&&(oe+=R.shift());R.length>0;)a=oe,S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),oe=x,le=k+R.shift(),M.curveTo(a,S,x,k,oe,le);break;case 27:for(R.length%2&&(le+=R.shift());R.length>0;)a=oe+R.shift(),S=le,x=a+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k,M.curveTo(a,S,x,k,oe,le);break;case 28:ge=ue[Be],Te=ue[Be+1],R.push((ge<<24|Te<<16)>>16),Be+=2;break;case 29:We=R.pop()+e.gsubrsBias,qe=e.gsubrs[We],qe&&pe(qe);break;case 30:for(;R.length>0&&(a=oe,S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+(R.length===1?R.shift():0),M.curveTo(a,S,x,k,oe,le),R.length!==0);)a=oe+R.shift(),S=le,x=a+R.shift(),k=S+R.shift(),le=k+R.shift(),oe=x+(R.length===1?R.shift():0),M.curveTo(a,S,x,k,oe,le);break;case 31:for(;R.length>0&&(a=oe+R.shift(),S=le,x=a+R.shift(),k=S+R.shift(),le=k+R.shift(),oe=x+(R.length===1?R.shift():0),M.curveTo(a,S,x,k,oe,le),R.length!==0);)a=oe,S=le+R.shift(),x=a+R.shift(),k=S+R.shift(),oe=x+R.shift(),le=k+(R.length===1?R.shift():0),M.curveTo(a,S,x,k,oe,le);break;default:$e<32?console.log("Glyph "+r.index+": unknown operator "+$e):$e<247?R.push($e-139):$e<251?(ge=ue[Be],Be+=1,R.push(256*($e-247)+ge+108)):$e<255?(ge=ue[Be],Be+=1,R.push(256*-($e-251)-ge-108)):(ge=ue[Be],Te=ue[Be+1],we=ue[Be+2],Ie=ue[Be+3],Be+=4,R.push((ge<<24|Te<<16|we<<8|Ie)/65536))}}}(n),r.advanceWidth=me,M}function Br(e,r){let n,a=xe.indexOf(e);return a>=0&&(n=a),a=r.indexOf(e),a>=0?n=a+xe.length:(n=xe.length+r.length,r.push(e)),n}function Or(e,r,n){const a={};for(let S=0;S<e.length;S+=1){const x=e[S];let k=r[x.name];k===void 0||Lr(k,x.value)||(x.type==="SID"&&(k=Br(k,n)),a[x.op]={name:x.name,type:x.type,value:k})}return a}function Ir(e,r){const n=new W.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Or(Ar,e,r),n}function Pr(e){const r=new W.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return r.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],r}function hs(e){const r=[],n=e.path;r.push({name:"width",type:"NUMBER",value:e.advanceWidth});let a=0,S=0;for(let x=0;x<n.commands.length;x+=1){let k,M,R=n.commands[x];if(R.type==="Q"){const N=.3333333333333333,q=2/3;R={type:"C",x:R.x,y:R.y,x1:N*a+q*R.x1,y1:N*S+q*R.y1,x2:N*R.x+q*R.x1,y2:N*R.y+q*R.y1}}if(R.type==="M")k=Math.round(R.x-a),M=Math.round(R.y-S),r.push({name:"dx",type:"NUMBER",value:k}),r.push({name:"dy",type:"NUMBER",value:M}),r.push({name:"rmoveto",type:"OP",value:21}),a=Math.round(R.x),S=Math.round(R.y);else if(R.type==="L")k=Math.round(R.x-a),M=Math.round(R.y-S),r.push({name:"dx",type:"NUMBER",value:k}),r.push({name:"dy",type:"NUMBER",value:M}),r.push({name:"rlineto",type:"OP",value:5}),a=Math.round(R.x),S=Math.round(R.y);else if(R.type==="C"){const N=Math.round(R.x1-a),q=Math.round(R.y1-S),Y=Math.round(R.x2-R.x1),Z=Math.round(R.y2-R.y1);k=Math.round(R.x-R.x2),M=Math.round(R.y-R.y2),r.push({name:"dx1",type:"NUMBER",value:N}),r.push({name:"dy1",type:"NUMBER",value:q}),r.push({name:"dx2",type:"NUMBER",value:Y}),r.push({name:"dy2",type:"NUMBER",value:Z}),r.push({name:"dx",type:"NUMBER",value:k}),r.push({name:"dy",type:"NUMBER",value:M}),r.push({name:"rrcurveto",type:"OP",value:8}),a=Math.round(R.x),S=Math.round(R.y)}}return r.push({name:"endchar",type:"OP",value:14}),r}const us=function(e,r,n){n.tables.cff={};const a=function(ae,ye){const oe={};return oe.formatMajor=fe.getCard8(ae,ye),oe.formatMinor=fe.getCard8(ae,ye+1),oe.size=fe.getCard8(ae,ye+2),oe.offsetSize=fe.getCard8(ae,ye+3),oe.startOffset=ye,oe.endOffset=ye+4,oe}(e,r),S=at(e,a.endOffset,fe.bytesToString),x=at(e,S.endOffset),k=at(e,x.endOffset,fe.bytesToString),M=at(e,k.endOffset);n.gsubrs=M.objects,n.gsubrsBias=Ft(n.gsubrs);const R=Mr(e,r,x.objects,k.objects);if(R.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+R.length);const N=R[0];if(n.tables.cff.topDict=N,N._privateDict&&(n.defaultWidthX=N._privateDict.defaultWidthX,n.nominalWidthX=N._privateDict.nominalWidthX),N.ros[0]!==void 0&&N.ros[1]!==void 0&&(n.isCIDFont=!0),n.isCIDFont){let ae=N.fdArray,ye=N.fdSelect;if(ae===0||ye===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");ae+=r;const oe=Mr(e,r,at(e,ae).objects,k.objects);N._fdArray=oe,ye+=r,N._fdSelect=function(le,me,Se,Le){const pe=[];let ue;const ge=new fe.Parser(le,me),Te=ge.parseCard8();if(Te===0)for(let we=0;we<Se;we++){if(ue=ge.parseCard8(),ue>=Le)throw new Error("CFF table CID Font FDSelect has bad FD index value "+ue+" (FD count "+Le+")");pe.push(ue)}else{if(Te!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+Te);{const we=ge.parseCard16();let Ie,We=ge.parseCard16();if(We!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+We);for(let qe=0;qe<we;qe++){if(ue=ge.parseCard8(),Ie=ge.parseCard16(),ue>=Le)throw new Error("CFF table CID Font FDSelect has bad FD index value "+ue+" (FD count "+Le+")");if(Ie>Se)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+Ie);for(;We<Ie;We++)pe.push(ue);We=Ie}if(Ie!==Se)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+Ie)}}return pe}(e,ye,n.numGlyphs,oe.length)}const q=r+N.private[1],Y=Dr(e,q,N.private[0],k.objects);if(n.defaultWidthX=Y.defaultWidthX,n.nominalWidthX=Y.nominalWidthX,Y.subrs!==0){const ae=at(e,q+Y.subrs);n.subrs=ae.objects,n.subrsBias=Ft(n.subrs)}else n.subrs=[],n.subrsBias=0;const Z=at(e,r+N.charStrings);n.nGlyphs=Z.objects.length;const de=function(ae,ye,oe,le){let me,Se;const Le=new fe.Parser(ae,ye);oe-=1;const pe=[".notdef"],ue=Le.parseCard8();if(ue===0)for(let ge=0;ge<oe;ge+=1)me=Le.parseSID(),pe.push(wt(le,me));else if(ue===1)for(;pe.length<=oe;){me=Le.parseSID(),Se=Le.parseCard8();for(let ge=0;ge<=Se;ge+=1)pe.push(wt(le,me)),me+=1}else{if(ue!==2)throw new Error("Unknown charset format "+ue);for(;pe.length<=oe;){me=Le.parseSID(),Se=Le.parseCard16();for(let ge=0;ge<=Se;ge+=1)pe.push(wt(le,me)),me+=1}}return pe}(e,r+N.charset,n.nGlyphs,k.objects);N.encoding===0?n.cffEncoding=new Qe(Ce,de):N.encoding===1?n.cffEncoding=new Qe(Ae,de):n.cffEncoding=function(ae,ye,oe){let le;const me={},Se=new fe.Parser(ae,ye),Le=Se.parseCard8();if(Le===0){const pe=Se.parseCard8();for(let ue=0;ue<pe;ue+=1)le=Se.parseCard8(),me[le]=ue}else{if(Le!==1)throw new Error("Unknown encoding format "+Le);{const pe=Se.parseCard8();le=1;for(let ue=0;ue<pe;ue+=1){const ge=Se.parseCard8(),Te=Se.parseCard8();for(let we=ge;we<=ge+Te;we+=1)me[we]=le,le+=1}}}return new Qe(me,oe)}(e,r+N.encoding,de),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new _t.GlyphSet(n);for(let ae=0;ae<n.nGlyphs;ae+=1){const ye=Z.objects[ae];n.glyphs.push(ae,_t.cffGlyphLoader(n,ae,cs,ye))}},ds=function(e,r){const n=new W.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),a=1/r.unitsPerEm,S={version:r.version,fullName:r.fullName,familyName:r.familyName,weight:r.weightName,fontBBox:r.fontBBox||[0,0,0,0],fontMatrix:[a,0,0,a,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},x=[];let k;for(let q=1;q<e.length;q+=1)k=e.get(q),x.push(k.name);const M=[];n.header=new W.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function(q){const Y=new W.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Y.names=[];for(let Z=0;Z<q.length;Z+=1)Y.names.push({name:"name_"+Z,type:"NAME",value:q[Z]});return Y}([r.postScriptName]);let R=Ir(S,M);n.topDictIndex=Pr(R),n.globalSubrIndex=new W.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function(q,Y){const Z=new W.Record("Charsets",[{name:"format",type:"Card8",value:0}]);for(let de=0;de<q.length;de+=1){const ae=Br(q[de],Y);Z.fields.push({name:"glyph_"+de,type:"SID",value:ae})}return Z}(x,M),n.charStringsIndex=function(q){const Y=new W.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]);for(let Z=0;Z<q.length;Z+=1){const de=q.get(Z),ae=hs(de);Y.charStrings.push({name:de.name,type:"CHARSTRING",value:ae})}return Y}(e),n.privateDict=function(q,Y){const Z=new W.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return Z.dict=Or(Tr,{},Y),Z}(0,M),n.stringIndex=function(q){const Y=new W.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Y.strings=[];for(let Z=0;Z<q.length;Z+=1)Y.strings.push({name:"string_"+Z,type:"STRING",value:q[Z]});return Y}(M);const N=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return S.charset=N,S.encoding=0,S.charStrings=S.charset+n.charsets.sizeOf(),S.private[1]=S.charStrings+n.charStringsIndex.sizeOf(),R=Ir(S,M),n.topDictIndex=Pr(R),n},fs=function(e,r){const n={},a=new fe.Parser(e,r);return n.version=a.parseVersion(),n.fontRevision=Math.round(1e3*a.parseFixed())/1e3,n.checkSumAdjustment=a.parseULong(),n.magicNumber=a.parseULong(),v.argument(n.magicNumber===1594834165,"Font header has wrong magic number."),n.flags=a.parseUShort(),n.unitsPerEm=a.parseUShort(),n.created=a.parseLongDateTime(),n.modified=a.parseLongDateTime(),n.xMin=a.parseShort(),n.yMin=a.parseShort(),n.xMax=a.parseShort(),n.yMax=a.parseShort(),n.macStyle=a.parseUShort(),n.lowestRecPPEM=a.parseUShort(),n.fontDirectionHint=a.parseShort(),n.indexToLocFormat=a.parseShort(),n.glyphDataFormat=a.parseShort(),n},ps=function(e){const r=Math.round(new Date().getTime()/1e3)+2082844800;let n=r;return e.createdTimestamp&&(n=e.createdTimestamp+2082844800),new W.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:r},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)},_s=function(e,r){const n={},a=new fe.Parser(e,r);return n.version=a.parseVersion(),n.ascender=a.parseShort(),n.descender=a.parseShort(),n.lineGap=a.parseShort(),n.advanceWidthMax=a.parseUShort(),n.minLeftSideBearing=a.parseShort(),n.minRightSideBearing=a.parseShort(),n.xMaxExtent=a.parseShort(),n.caretSlopeRise=a.parseShort(),n.caretSlopeRun=a.parseShort(),n.caretOffset=a.parseShort(),a.relativeOffset+=8,n.metricDataFormat=a.parseShort(),n.numberOfHMetrics=a.parseUShort(),n},gs=function(e){return new W.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)},vs=function(e,r,n,a,S){let x,k;const M=new fe.Parser(e,r);for(let R=0;R<a;R+=1){R<n&&(x=M.parseUShort(),k=M.parseShort());const N=S.get(R);N.advanceWidth=x,N.leftSideBearing=k}},ms=function(e){const r=new W.Table("hmtx",[]);for(let n=0;n<e.length;n+=1){const a=e.get(n),S=a.advanceWidth||0,x=a.leftSideBearing||0;r.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:S}),r.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:x})}return r},ys=function(e){const r=new W.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]);let n="";const a=12+4*e.length;for(let S=0;S<e.length;++S){let x=n.indexOf(e[S]);x<0&&(x=n.length,n+=e[S]),r.fields.push({name:"offset "+S,type:"USHORT",value:a+x}),r.fields.push({name:"length "+S,type:"USHORT",value:e[S].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),r},bs=function(e,r){const n=new fe.Parser(e,r),a=n.parseULong();v.argument(a===1,"Unsupported ltag table version."),n.skip("uLong",1);const S=n.parseULong(),x=[];for(let k=0;k<S;k++){let M="";const R=r+n.parseUShort(),N=n.parseUShort();for(let q=R;q<R+N;++q)M+=String.fromCharCode(e.getInt8(q));x.push(M)}return x},Ss=function(e,r){const n={},a=new fe.Parser(e,r);return n.version=a.parseVersion(),n.numGlyphs=a.parseUShort(),n.version===1&&(n.maxPoints=a.parseUShort(),n.maxContours=a.parseUShort(),n.maxCompositePoints=a.parseUShort(),n.maxCompositeContours=a.parseUShort(),n.maxZones=a.parseUShort(),n.maxTwilightPoints=a.parseUShort(),n.maxStorage=a.parseUShort(),n.maxFunctionDefs=a.parseUShort(),n.maxInstructionDefs=a.parseUShort(),n.maxStackElements=a.parseUShort(),n.maxSizeOfInstructions=a.parseUShort(),n.maxComponentElements=a.parseUShort(),n.maxComponentDepth=a.parseUShort()),n},Cs=function(e){return new W.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])},Ur=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Fr={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},ws={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Hr={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function xs(e,r,n){switch(e){case 0:if(r===65535)return"und";if(n)return n[r];break;case 1:return Fr[r];case 3:return Hr[r]}}const Ht="utf-16",Es={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Ls={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Nr(e,r,n){switch(e){case 0:return Ht;case 1:return Ls[n]||Es[r];case 3:if(r===1||r===10)return Ht}}function Nt(e){const r={};for(let n in e)r[e[n]]=parseInt(n);return r}function Wr(e,r,n,a,S,x){return new W.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:r},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:a},{name:"length",type:"USHORT",value:S},{name:"offset",type:"USHORT",value:x}])}function Gr(e,r){let n=function(a,S){const x=a.length,k=S.length-x+1;e:for(let M=0;M<k;M++)for(;M<k;M++){for(let R=0;R<x;R++)if(S[M+R]!==a[R])continue e;return M}return-1}(e,r);if(n<0){n=r.length;let a=0;const S=e.length;for(;a<S;++a)r.push(e[a])}return n}const ks=function(e,r,n){const a={},S=new fe.Parser(e,r),x=S.parseUShort(),k=S.parseUShort(),M=S.offset+S.parseUShort();for(let R=0;R<k;R++){const N=S.parseUShort(),q=S.parseUShort(),Y=S.parseUShort(),Z=S.parseUShort(),de=Ur[Z]||Z,ae=S.parseUShort(),ye=S.parseUShort(),oe=xs(N,Y,n),le=Nr(N,q,Y);if(le!==void 0&&oe!==void 0){let me;if(me=le===Ht?m.UTF16(e,M+ye,ae):m.MACSTRING(e,M+ye,ae,le),me){let Se=a[de];Se===void 0&&(Se=a[de]={}),Se[oe]=me}}}return x===1&&S.parseUShort(),a},Rs=function(e,r){let n;const a=[],S={},x=Nt(Ur);for(let Y in e){let Z=x[Y];if(Z===void 0&&(Z=Y),n=parseInt(Z),isNaN(n))throw new Error('Name table entry "'+Y+'" does not exist, see nameTableNames for complete list.');S[n]=e[Y],a.push(n)}const k=Nt(Fr),M=Nt(Hr),R=[],N=[];for(let Y=0;Y<a.length;Y++){n=a[Y];const Z=S[n];for(let de in Z){const ae=Z[de];let ye=1,oe=k[de],le=ws[oe];const me=Nr(ye,le,oe);let Se=b.MACSTRING(ae,me);Se===void 0&&(ye=0,oe=r.indexOf(de),oe<0&&(oe=r.length,r.push(de)),le=4,Se=b.UTF16(ae));const Le=Gr(Se,N);R.push(Wr(ye,le,oe,n,Se.length,Le));const pe=M[de];if(pe!==void 0){const ue=b.UTF16(ae),ge=Gr(ue,N);R.push(Wr(3,1,pe,n,ue.length,ge))}}}R.sort(function(Y,Z){return Y.platformID-Z.platformID||Y.encodingID-Z.encodingID||Y.languageID-Z.languageID||Y.nameID-Z.nameID});const q=new W.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:R.length},{name:"stringOffset",type:"USHORT",value:6+12*R.length}]);for(let Y=0;Y<R.length;Y++)q.fields.push({name:"record_"+Y,type:"RECORD",value:R[Y]});return q.fields.push({name:"strings",type:"LITERAL",value:N}),q},zr=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],As=function(e,r){const n={},a=new fe.Parser(e,r);n.version=a.parseUShort(),n.xAvgCharWidth=a.parseShort(),n.usWeightClass=a.parseUShort(),n.usWidthClass=a.parseUShort(),n.fsType=a.parseUShort(),n.ySubscriptXSize=a.parseShort(),n.ySubscriptYSize=a.parseShort(),n.ySubscriptXOffset=a.parseShort(),n.ySubscriptYOffset=a.parseShort(),n.ySuperscriptXSize=a.parseShort(),n.ySuperscriptYSize=a.parseShort(),n.ySuperscriptXOffset=a.parseShort(),n.ySuperscriptYOffset=a.parseShort(),n.yStrikeoutSize=a.parseShort(),n.yStrikeoutPosition=a.parseShort(),n.sFamilyClass=a.parseShort(),n.panose=[];for(let S=0;S<10;S++)n.panose[S]=a.parseByte();return n.ulUnicodeRange1=a.parseULong(),n.ulUnicodeRange2=a.parseULong(),n.ulUnicodeRange3=a.parseULong(),n.ulUnicodeRange4=a.parseULong(),n.achVendID=String.fromCharCode(a.parseByte(),a.parseByte(),a.parseByte(),a.parseByte()),n.fsSelection=a.parseUShort(),n.usFirstCharIndex=a.parseUShort(),n.usLastCharIndex=a.parseUShort(),n.sTypoAscender=a.parseShort(),n.sTypoDescender=a.parseShort(),n.sTypoLineGap=a.parseShort(),n.usWinAscent=a.parseUShort(),n.usWinDescent=a.parseUShort(),n.version>=1&&(n.ulCodePageRange1=a.parseULong(),n.ulCodePageRange2=a.parseULong()),n.version>=2&&(n.sxHeight=a.parseShort(),n.sCapHeight=a.parseShort(),n.usDefaultChar=a.parseUShort(),n.usBreakChar=a.parseUShort(),n.usMaxContent=a.parseUShort()),n},Ts=function(e){return new W.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},Ds=function(e){for(let r=0;r<zr.length;r+=1){const n=zr[r];if(e>=n.begin&&e<n.end)return r}return-1},Ms=function(e,r){const n={},a=new fe.Parser(e,r);switch(n.version=a.parseVersion(),n.italicAngle=a.parseFixed(),n.underlinePosition=a.parseShort(),n.underlineThickness=a.parseShort(),n.isFixedPitch=a.parseULong(),n.minMemType42=a.parseULong(),n.maxMemType42=a.parseULong(),n.minMemType1=a.parseULong(),n.maxMemType1=a.parseULong(),n.version){case 1:n.names=Pe.slice();break;case 2:n.numberOfGlyphs=a.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(let S=0;S<n.numberOfGlyphs;S++)n.glyphNameIndex[S]=a.parseUShort();n.names=[];for(let S=0;S<n.numberOfGlyphs;S++)if(n.glyphNameIndex[S]>=Pe.length){const x=a.parseChar();n.names.push(a.parseString(x))}break;case 2.5:n.numberOfGlyphs=a.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(let S=0;S<n.numberOfGlyphs;S++)n.offset[S]=a.parseChar()}return n},Bs=function(){return new W.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])},Ye=new Array(9);Ye[1]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();return r===1?{substFormat:1,coverage:this.parsePointer(ee.coverage),deltaGlyphId:this.parseUShort()}:r===2?{substFormat:2,coverage:this.parsePointer(ee.coverage),substitute:this.parseOffset16List()}:void v.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},Ye[2]=function(){const e=this.parseUShort();return v.argument(e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),sequences:this.parseListOfLists()}},Ye[3]=function(){const e=this.parseUShort();return v.argument(e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),alternateSets:this.parseListOfLists()}},Ye[4]=function(){const e=this.parseUShort();return v.argument(e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};const gt={sequenceIndex:ee.uShort,lookupListIndex:ee.uShort};Ye[5]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:r,coverage:this.parsePointer(ee.coverage),ruleSets:this.parseListOfLists(function(){const n=this.parseUShort(),a=this.parseUShort();return{input:this.parseUShortList(n-1),lookupRecords:this.parseRecordList(a,gt)}})};if(r===2)return{substFormat:r,coverage:this.parsePointer(ee.coverage),classDef:this.parsePointer(ee.classDef),classSets:this.parseListOfLists(function(){const n=this.parseUShort(),a=this.parseUShort();return{classes:this.parseUShortList(n-1),lookupRecords:this.parseRecordList(a,gt)}})};if(r===3){const n=this.parseUShort(),a=this.parseUShort();return{substFormat:r,coverages:this.parseList(n,ee.pointer(ee.coverage)),lookupRecords:this.parseRecordList(a,gt)}}v.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Ye[6]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();return r===1?{substFormat:1,coverage:this.parsePointer(ee.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:r===2?{substFormat:2,coverage:this.parsePointer(ee.coverage),backtrackClassDef:this.parsePointer(ee.classDef),inputClassDef:this.parsePointer(ee.classDef),lookaheadClassDef:this.parsePointer(ee.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:r===3?{substFormat:3,backtrackCoverage:this.parseList(ee.pointer(ee.coverage)),inputCoverage:this.parseList(ee.pointer(ee.coverage)),lookaheadCoverage:this.parseList(ee.pointer(ee.coverage)),lookupRecords:this.parseRecordList(gt)}:void v.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Ye[7]=function(){const e=this.parseUShort();v.argument(e===1,"GSUB Extension Substitution subtable identifier-format must be 1");const r=this.parseUShort(),n=new ee(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:r,extension:Ye[r].call(n)}},Ye[8]=function(){const e=this.parseUShort();return v.argument(e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(ee.coverage),backtrackCoverage:this.parseList(ee.pointer(ee.coverage)),lookaheadCoverage:this.parseList(ee.pointer(ee.coverage)),substitutes:this.parseUShortList()}};const Tt=new Array(9);Tt[1]=function(e){return e.substFormat===1?new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.ushortList("substitute",e.substitute)))},Tt[3]=function(e){return v.assert(e.substFormat===1,"Lookup type 3 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("altSet",e.alternateSets,function(r){return new W.Table("alternateSetTable",W.ushortList("alternate",r))})))},Tt[4]=function(e){return v.assert(e.substFormat===1,"Lookup type 4 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("ligSet",e.ligatureSets,function(r){return new W.Table("ligatureSetTable",W.tableList("ligature",r,function(n){return new W.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:n.ligGlyph}].concat(W.ushortList("component",n.components,n.components.length+1)))}))})))};const Os=function(e,r){const n=new ee(e,r=r||0),a=n.parseVersion(1);return v.argument(a===1||a===1.1,"Unsupported GSUB table version."),a===1?{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ye)}:{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ye),variations:n.parseFeatureVariationsList()}},Is=function(e){return new W.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new W.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new W.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new W.LookupList(e.lookups,Tt)}])},Ps=function(e,r){const n=new fe.Parser(e,r),a=n.parseULong();v.argument(a===1,"Unsupported META table version."),n.parseULong(),n.parseULong();const S=n.parseULong(),x={};for(let k=0;k<S;k++){const M=n.parseTag(),R=n.parseULong(),N=n.parseULong(),q=m.UTF8(e,r+R,N);x[M]=q}return x},Us=function(e){const r=Object.keys(e).length;let n="";const a=16+12*r,S=new W.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:a},{name:"numTags",type:"ULONG",value:r}]);for(let x in e){const k=n.length;n+=e[x],S.fields.push({name:"tag "+x,type:"TAG",value:x}),S.fields.push({name:"offset "+x,type:"ULONG",value:a+k}),S.fields.push({name:"length "+x,type:"ULONG",value:e[x].length})}return S.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),S};function jr(e){return Math.log(e)/Math.log(2)|0}function $r(e){for(;e.length%4!=0;)e.push(0);let r=0;for(let n=0;n<e.length;n+=4)r+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return r%=Math.pow(2,32),r}function qr(e,r,n,a){return new W.Record("Table Record",[{name:"tag",type:"TAG",value:e!==void 0?e:""},{name:"checkSum",type:"ULONG",value:r!==void 0?r:0},{name:"offset",type:"ULONG",value:n!==void 0?n:0},{name:"length",type:"ULONG",value:a!==void 0?a:0}])}function Fs(e){const r=new W.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);r.tables=e,r.numTables=e.length;const n=Math.pow(2,jr(r.numTables));r.searchRange=16*n,r.entrySelector=jr(n),r.rangeShift=16*r.numTables-r.searchRange;const a=[],S=[];let x=r.sizeOf()+qr().sizeOf()*r.numTables;for(;x%4!=0;)x+=1,S.push({name:"padding",type:"BYTE",value:0});for(let k=0;k<e.length;k+=1){const M=e[k];v.argument(M.tableName.length===4,"Table name"+M.tableName+" is invalid.");const R=M.sizeOf(),N=qr(M.tableName,$r(M.encode()),x,R);for(a.push({name:N.tag+" Table Record",type:"RECORD",value:N}),S.push({name:M.tableName+" table",type:"RECORD",value:M}),x+=R,v.argument(!isNaN(x),"Something went wrong calculating the offset.");x%4!=0;)x+=1,S.push({name:"padding",type:"BYTE",value:0})}return a.sort(function(k,M){return k.value.tag>M.value.tag?1:-1}),r.fields=r.fields.concat(a),r.fields=r.fields.concat(S),r}function Vr(e,r,n){for(let a=0;a<r.length;a+=1){const S=e.charToGlyphIndex(r[a]);if(S>0)return e.glyphs.get(S).getMetrics()}return n}function Hs(e){let r=0;for(let n=0;n<e.length;n+=1)r+=e[n];return r/e.length}const Ns=function(e){const r=[],n=[],a=[],S=[],x=[],k=[],M=[];let R,N=0,q=0,Y=0,Z=0,de=0;for(let Xe=0;Xe<e.glyphs.length;Xe+=1){const mt=e.glyphs.get(Xe),yt=0|mt.unicode;if(isNaN(mt.advanceWidth))throw new Error("Glyph "+mt.name+" ("+Xe+"): advanceWidth is not a number.");(R>yt||R===void 0)&&yt>0&&(R=yt),N<yt&&(N=yt);const ut=Ds(yt);if(ut<32)q|=1<<ut;else if(ut<64)Y|=1<<ut-32;else if(ut<96)Z|=1<<ut-64;else{if(!(ut<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");de|=1<<ut-96}if(mt.name===".notdef")continue;const bt=mt.getMetrics();r.push(bt.xMin),n.push(bt.yMin),a.push(bt.xMax),S.push(bt.yMax),k.push(bt.leftSideBearing),M.push(bt.rightSideBearing),x.push(mt.advanceWidth)}const ae={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,a),yMax:Math.max.apply(null,S),advanceWidthMax:Math.max.apply(null,x),advanceWidthAvg:Hs(x),minLeftSideBearing:Math.min.apply(null,k),maxLeftSideBearing:Math.max.apply(null,k),minRightSideBearing:Math.min.apply(null,M)};ae.ascender=e.ascender,ae.descender=e.descender;const ye=ps({flags:3,unitsPerEm:e.unitsPerEm,xMin:ae.xMin,yMin:ae.yMin,xMax:ae.xMax,yMax:ae.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),oe=gs({ascender:ae.ascender,descender:ae.descender,advanceWidthMax:ae.advanceWidthMax,minLeftSideBearing:ae.minLeftSideBearing,minRightSideBearing:ae.minRightSideBearing,xMaxExtent:ae.maxLeftSideBearing+(ae.xMax-ae.xMin),numberOfHMetrics:e.glyphs.length}),le=Cs(e.glyphs.length),me=Ts({xAvgCharWidth:Math.round(ae.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:R,usLastCharIndex:N,ulUnicodeRange1:q,ulUnicodeRange2:Y,ulUnicodeRange3:Z,ulUnicodeRange4:de,fsSelection:e.tables.os2.fsSelection,sTypoAscender:ae.ascender,sTypoDescender:ae.descender,sTypoLineGap:0,usWinAscent:ae.yMax,usWinDescent:Math.abs(ae.yMin),ulCodePageRange1:1,sxHeight:Vr(e,"xyvw",{yMax:Math.round(ae.ascender/2)}).yMax,sCapHeight:Vr(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",ae).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),Se=ms(e.glyphs),Le=re(e.glyphs),pe=e.getEnglishName("fontFamily"),ue=e.getEnglishName("fontSubfamily"),ge=pe+" "+ue;let Te=e.getEnglishName("postScriptName");Te||(Te=pe.replace(/\s/g,"")+"-"+ue);const we={};for(let Xe in e.names)we[Xe]=e.names[Xe];we.uniqueID||(we.uniqueID={en:e.getEnglishName("manufacturer")+":"+ge}),we.postScriptName||(we.postScriptName={en:Te}),we.preferredFamily||(we.preferredFamily=e.names.fontFamily),we.preferredSubfamily||(we.preferredSubfamily=e.names.fontSubfamily);const Ie=[],We=Rs(we,Ie),qe=Ie.length>0?ys(Ie):void 0,Fe=Bs(),je=ds(e.glyphs,{version:e.getEnglishName("version"),fullName:ge,familyName:pe,weightName:ue,postScriptName:Te,unitsPerEm:e.unitsPerEm,fontBBox:[0,ae.yMin,ae.ascender,ae.advanceWidthMax]}),Ue=e.metas&&Object.keys(e.metas).length>0?Us(e.metas):void 0,Ge=[ye,oe,le,me,We,Le,Fe,je,Se];qe&&Ge.push(qe),e.tables.gsub&&Ge.push(Is(e.tables.gsub)),Ue&&Ge.push(Ue);const He=Fs(Ge),Ke=$r(He.encode()),Be=He.fields;let $e=!1;for(let Xe=0;Xe<Be.length;Xe+=1)if(Be[Xe].name==="head table"){Be[Xe].value.checkSumAdjustment=2981146554-Ke,$e=!0;break}if(!$e)throw new Error("Could not find head table with checkSum to adjust.");return He};function Wt(e,r){let n=0,a=e.length-1;for(;n<=a;){const S=n+a>>>1,x=e[S].tag;if(x===r)return S;x<r?n=S+1:a=S-1}return-n-1}function Kr(e,r){let n=0,a=e.length-1;for(;n<=a;){const S=n+a>>>1,x=e[S];if(x===r)return S;x<r?n=S+1:a=S-1}return-n-1}function Xr(e,r){let n,a=0,S=e.length-1;for(;a<=S;){const x=a+S>>>1;n=e[x];const k=n.start;if(k===r)return n;k<r?a=x+1:S=x-1}if(a>0)return n=e[a-1],r>n.end?0:n}function Yr(e,r){this.font=e,this.tableName=r}Yr.prototype={searchTag:Wt,binSearch:Kr,getTable:function(e){let r=this.font.tables[this.tableName];return!r&&e&&(r=this.font.tables[this.tableName]=this.createDefaultTable()),r},getScriptNames:function(){let e=this.getTable();return e?e.scripts.map(function(r){return r.tag}):[]},getDefaultScriptName:function(){let e=this.getTable();if(!e)return;let r=!1;for(let n=0;n<e.scripts.length;n++){const a=e.scripts[n].tag;if(a==="DFLT")return a;a==="latn"&&(r=!0)}return r?"latn":void 0},getScriptTable:function(e,r){const n=this.getTable(r);if(n){e=e||"DFLT";const a=n.scripts,S=Wt(n.scripts,e);if(S>=0)return a[S].script;if(r){const x={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return a.splice(-1-S,0,x),x.script}}},getLangSysTable:function(e,r,n){const a=this.getScriptTable(e,n);if(a){if(!r||r==="dflt"||r==="DFLT")return a.defaultLangSys;const S=Wt(a.langSysRecords,r);if(S>=0)return a.langSysRecords[S].langSys;if(n){const x={tag:r,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return a.langSysRecords.splice(-1-S,0,x),x.langSys}}},getFeatureTable:function(e,r,n,a){const S=this.getLangSysTable(e,r,a);if(S){let x;const k=S.featureIndexes,M=this.font.tables[this.tableName].features;for(let R=0;R<k.length;R++)if(x=M[k[R]],x.tag===n)return x.feature;if(a){const R=M.length;return v.assert(R===0||n>=M[R-1].tag,"Features must be added in alphabetical order."),x={tag:n,feature:{params:0,lookupListIndexes:[]}},M.push(x),k.push(R),x.feature}}},getLookupTables:function(e,r,n,a,S){const x=this.getFeatureTable(e,r,n,S),k=[];if(x){let M;const R=x.lookupListIndexes,N=this.font.tables[this.tableName].lookups;for(let q=0;q<R.length;q++)M=N[R[q]],M.lookupType===a&&k.push(M);if(k.length===0&&S){M={lookupType:a,lookupFlag:0,subtables:[],markFilteringSet:void 0};const q=N.length;return N.push(M),R.push(q),[M]}}return k},getGlyphClass:function(e,r){switch(e.format){case 1:return e.startGlyph<=r&&r<e.startGlyph+e.classes.length?e.classes[r-e.startGlyph]:0;case 2:const n=Xr(e.ranges,r);return n?n.classId:0}},getCoverageIndex:function(e,r){switch(e.format){case 1:const n=Kr(e.glyphs,r);return n>=0?n:-1;case 2:const a=Xr(e.ranges,r);return a?a.index+r-a.start:-1}},expandCoverage:function(e){if(e.format===1)return e.glyphs;{const r=[],n=e.ranges;for(let a=0;a<n.length;a++){const S=n[a],x=S.start,k=S.end;for(let M=x;M<=k;M++)r.push(M)}return r}}};const Dt=Yr;function Mt(e){Dt.call(this,e,"gpos")}Mt.prototype=Dt.prototype,Mt.prototype.getKerningValue=function(e,r,n){for(let a=0;a<e.length;a++){const S=e[a].subtables;for(let x=0;x<S.length;x++){const k=S[x],M=this.getCoverageIndex(k.coverage,r);if(!(M<0))switch(k.posFormat){case 1:let R=k.pairSets[M];for(let Z=0;Z<R.length;Z++){let de=R[Z];if(de.secondGlyph===n)return de.value1&&de.value1.xAdvance||0}break;case 2:const N=this.getGlyphClass(k.classDef1,r),q=this.getGlyphClass(k.classDef2,n),Y=k.classRecords[N][q];return Y.value1&&Y.value1.xAdvance||0}}}return 0},Mt.prototype.getKerningTables=function(e,r){if(this.font.tables.gpos)return this.getLookupTables(e,r,"kern",2)};const Ws=Mt;function Ze(e){Dt.call(this,e,"gsub")}function Gs(e,r){const n=e.length;if(n!==r.length)return!1;for(let a=0;a<n;a++)if(e[a]!==r[a])return!1;return!0}function Zr(e,r,n){const a=e.subtables;for(let S=0;S<a.length;S++){const x=a[S];if(x.substFormat===r)return x}if(n)return a.push(n),n}Ze.prototype=Dt.prototype,Ze.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Ze.prototype.getSingle=function(e,r,n){const a=[],S=this.getLookupTables(r,n,e,1);for(let x=0;x<S.length;x++){const k=S[x].subtables;for(let M=0;M<k.length;M++){const R=k[M],N=this.expandCoverage(R.coverage);let q;if(R.substFormat===1){const Y=R.deltaGlyphId;for(q=0;q<N.length;q++){const Z=N[q];a.push({sub:Z,by:Z+Y})}}else{const Y=R.substitute;for(q=0;q<N.length;q++)a.push({sub:N[q],by:Y[q]})}}}return a},Ze.prototype.getAlternates=function(e,r,n){const a=[],S=this.getLookupTables(r,n,e,3);for(let x=0;x<S.length;x++){const k=S[x].subtables;for(let M=0;M<k.length;M++){const R=k[M],N=this.expandCoverage(R.coverage),q=R.alternateSets;for(let Y=0;Y<N.length;Y++)a.push({sub:N[Y],by:q[Y]})}}return a},Ze.prototype.getLigatures=function(e,r,n){const a=[],S=this.getLookupTables(r,n,e,4);for(let x=0;x<S.length;x++){const k=S[x].subtables;for(let M=0;M<k.length;M++){const R=k[M],N=this.expandCoverage(R.coverage),q=R.ligatureSets;for(let Y=0;Y<N.length;Y++){const Z=N[Y],de=q[Y];for(let ae=0;ae<de.length;ae++){const ye=de[ae];a.push({sub:[Z].concat(ye.components),by:ye.ligGlyph})}}}}return a},Ze.prototype.addSingle=function(e,r,n,a){const S=Zr(this.getLookupTables(n,a,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});v.assert(S.coverage.format===1,"Ligature: unable to modify coverage table format "+S.coverage.format);const x=r.sub;let k=this.binSearch(S.coverage.glyphs,x);k<0&&(k=-1-k,S.coverage.glyphs.splice(k,0,x),S.substitute.splice(k,0,0)),S.substitute[k]=r.by},Ze.prototype.addAlternate=function(e,r,n,a){const S=Zr(this.getLookupTables(n,a,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});v.assert(S.coverage.format===1,"Ligature: unable to modify coverage table format "+S.coverage.format);const x=r.sub;let k=this.binSearch(S.coverage.glyphs,x);k<0&&(k=-1-k,S.coverage.glyphs.splice(k,0,x),S.alternateSets.splice(k,0,0)),S.alternateSets[k]=r.by},Ze.prototype.addLigature=function(e,r,n,a){const S=this.getLookupTables(n,a,e,4,!0)[0];let x=S.subtables[0];x||(x={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},S.subtables[0]=x),v.assert(x.coverage.format===1,"Ligature: unable to modify coverage table format "+x.coverage.format);const k=r.sub[0],M=r.sub.slice(1),R={ligGlyph:r.by,components:M};let N=this.binSearch(x.coverage.glyphs,k);if(N>=0){const q=x.ligatureSets[N];for(let Y=0;Y<q.length;Y++)if(Gs(q[Y].components,M))return;q.push(R)}else N=-1-N,x.coverage.glyphs.splice(N,0,k),x.ligatureSets.splice(N,0,[R])},Ze.prototype.getFeature=function(e,r,n){if(/ss\d\d/.test(e))return this.getSingle(e,r,n);switch(e){case"aalt":case"salt":return this.getSingle(e,r,n).concat(this.getAlternates(e,r,n));case"dlig":case"liga":case"rlig":return this.getLigatures(e,r,n)}},Ze.prototype.add=function(e,r,n,a){if(/ss\d\d/.test(e))return this.addSingle(e,r,n,a);switch(e){case"aalt":case"salt":return typeof r.by=="number"?this.addSingle(e,r,n,a):this.addAlternate(e,r,n,a);case"dlig":case"liga":case"rlig":return this.addLigature(e,r,n,a)}};const zs=Ze;function Jr(e){const r=new ArrayBuffer(e.length),n=new Uint8Array(r);for(let a=0;a<e.length;++a)n[a]=e[a];return r}function vt(e,r){if(!e)throw r}let Qr,pt,ei,Gt;function ti(e){this.font=e,this._fpgmState=this._prepState=void 0,this._errorState=0}function js(e){return e}function ri(e){return Math.sign(e)*Math.round(Math.abs(e))}function $s(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function qs(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function Vs(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function Ks(e){return Math.sign(e)*Math.floor(Math.abs(e))}const ii=function(e){const r=this.srPeriod;let n=this.srPhase,a=1;return e<0&&(e=-e,a=-1),e+=this.srThreshold-n,e=Math.trunc(e/r)*r,(e+=n)<0?n*a:e*a},tt={x:1,y:0,axis:"x",distance:function(e,r,n,a){return(n?e.xo:e.x)-(a?r.xo:r.x)},interpolate:function(e,r,n,a){let S,x,k,M,R,N,q;if(!a||a===this)return S=e.xo-r.xo,x=e.xo-n.xo,R=r.x-r.xo,N=n.x-n.xo,k=Math.abs(S),M=Math.abs(x),q=k+M,q===0?void(e.x=e.xo+(R+N)/2):void(e.x=e.xo+(R*M+N*k)/q);S=a.distance(e,r,!0,!0),x=a.distance(e,n,!0,!0),R=a.distance(r,r,!1,!0),N=a.distance(n,n,!1,!0),k=Math.abs(S),M=Math.abs(x),q=k+M,q!==0?tt.setRelative(e,e,(R*M+N*k)/q,a,!0):tt.setRelative(e,e,(R+N)/2,a,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,r,n,a,S){if(!a||a===this)return void(e.x=(S?r.xo:r.x)+n);const x=S?r.xo:r.x,k=S?r.yo:r.y,M=x+n*a.x,R=k+n*a.y;e.x=M+(e.y-R)/a.normalSlope},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},rt={x:0,y:1,axis:"y",distance:function(e,r,n,a){return(n?e.yo:e.y)-(a?r.yo:r.y)},interpolate:function(e,r,n,a){let S,x,k,M,R,N,q;if(!a||a===this)return S=e.yo-r.yo,x=e.yo-n.yo,R=r.y-r.yo,N=n.y-n.yo,k=Math.abs(S),M=Math.abs(x),q=k+M,q===0?void(e.y=e.yo+(R+N)/2):void(e.y=e.yo+(R*M+N*k)/q);S=a.distance(e,r,!0,!0),x=a.distance(e,n,!0,!0),R=a.distance(r,r,!1,!0),N=a.distance(n,n,!1,!0),k=Math.abs(S),M=Math.abs(x),q=k+M,q!==0?rt.setRelative(e,e,(R*M+N*k)/q,a,!0):rt.setRelative(e,e,(R+N)/2,a,!0)},normalSlope:0,setRelative:function(e,r,n,a,S){if(!a||a===this)return void(e.y=(S?r.yo:r.y)+n);const x=S?r.xo:r.x,k=S?r.yo:r.y,M=x+n*a.x,R=k+n*a.y;e.y=R+a.normalSlope*(e.x-M)},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function xt(e,r){this.x=e,this.y=r,this.axis=void 0,this.slope=r/e,this.normalSlope=-e/r,Object.freeze(this)}function Et(e,r){const n=Math.sqrt(e*e+r*r);return r/=n,(e/=n)==1&&r===0?tt:e===0&&r===1?rt:new xt(e,r)}function it(e,r,n,a){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*r)/64,this.lastPointOfContour=n,this.onCurve=a,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(tt),Object.freeze(rt),xt.prototype.distance=function(e,r,n,a){return this.x*tt.distance(e,r,n,a)+this.y*rt.distance(e,r,n,a)},xt.prototype.interpolate=function(e,r,n,a){let S,x,k,M,R,N,q;k=a.distance(e,r,!0,!0),M=a.distance(e,n,!0,!0),S=a.distance(r,r,!1,!0),x=a.distance(n,n,!1,!0),R=Math.abs(k),N=Math.abs(M),q=R+N,q!==0?this.setRelative(e,e,(S*N+x*R)/q,a,!0):this.setRelative(e,e,(S+x)/2,a,!0)},xt.prototype.setRelative=function(e,r,n,a,S){a=a||this;const x=S?r.xo:r.x,k=S?r.yo:r.y,M=x+n*a.x,R=k+n*a.y,N=a.normalSlope,q=this.slope,Y=e.x,Z=e.y;e.x=(q*Y-N*M+R-Z)/(q-N),e.y=q*(e.x-Y)+Z},xt.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},it.prototype.nextTouched=function(e){let r=this.nextPointOnContour;for(;!e.touched(r)&&r!==this;)r=r.nextPointOnContour;return r},it.prototype.prevTouched=function(e){let r=this.prevPointOnContour;for(;!e.touched(r)&&r!==this;)r=r.prevPointOnContour;return r};const Lt=Object.freeze(new it(0,0)),Xs={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function lt(e,r){switch(this.env=e,this.stack=[],this.prog=r,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=tt,this.round=ri}}function Bt(e){const r=e.tZone=new Array(e.gZone.length);for(let n=0;n<r.length;n++)r[n]=new it(0,0)}function si(e,r){const n=e.prog;let a,S=e.ip,x=1;do if(a=n[++S],a===88)x++;else if(a===89)x--;else if(a===64)S+=n[S+1]+1;else if(a===65)S+=2*n[S+1]+1;else if(a>=176&&a<=183)S+=a-176+1;else if(a>=184&&a<=191)S+=2*(a-184+1);else if(r&&x===1&&a===27)break;while(x>0);e.ip=S}function ni(e,r){U.DEBUG&&console.log(r.step,"SVTCA["+e.axis+"]"),r.fv=r.pv=r.dpv=e}function oi(e,r){U.DEBUG&&console.log(r.step,"SPVTCA["+e.axis+"]"),r.pv=r.dpv=e}function ai(e,r){U.DEBUG&&console.log(r.step,"SFVTCA["+e.axis+"]"),r.fv=e}function li(e,r){const n=r.stack,a=n.pop(),S=n.pop(),x=r.z2[a],k=r.z1[S];let M,R;U.DEBUG&&console.log("SPVTL["+e+"]",a,S),e?(M=x.y-k.y,R=k.x-x.x):(M=k.x-x.x,R=k.y-x.y),r.pv=r.dpv=Et(M,R)}function ci(e,r){const n=r.stack,a=n.pop(),S=n.pop(),x=r.z2[a],k=r.z1[S];let M,R;U.DEBUG&&console.log("SFVTL["+e+"]",a,S),e?(M=x.y-k.y,R=k.x-x.x):(M=k.x-x.x,R=k.y-x.y),r.fv=Et(M,R)}function zt(e){U.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function hi(e,r){const n=r.stack.pop(),a=r.z0[n],S=r.fv,x=r.pv;U.DEBUG&&console.log(r.step,"MDAP["+e+"]",n);let k=x.distance(a,Lt);e&&(k=r.round(k)),S.setRelative(a,Lt,k,x),S.touch(a),r.rp0=r.rp1=n}function ui(e,r){const n=r.z2,a=n.length-2;let S,x,k;U.DEBUG&&console.log(r.step,"IUP["+e.axis+"]");for(let M=0;M<a;M++)S=n[M],e.touched(S)||(x=S.prevTouched(e),x!==S&&(k=S.nextTouched(e),x===k&&e.setRelative(S,S,e.distance(x,x,!1,!0),e,!0),e.interpolate(S,x,k,e)))}function di(e,r){const n=r.stack,a=e?r.rp1:r.rp2,S=(e?r.z0:r.z1)[a],x=r.fv,k=r.pv;let M=r.loop;const R=r.z2;for(;M--;){const N=n.pop(),q=R[N],Y=k.distance(S,S,!1,!0);x.setRelative(q,q,Y,k),x.touch(q),U.DEBUG&&console.log(r.step,(r.loop>1?"loop "+(r.loop-M)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",N)}r.loop=1}function fi(e,r){const n=r.stack,a=e?r.rp1:r.rp2,S=(e?r.z0:r.z1)[a],x=r.fv,k=r.pv,M=n.pop(),R=r.z2[r.contours[M]];let N=R;U.DEBUG&&console.log(r.step,"SHC["+e+"]",M);const q=k.distance(S,S,!1,!0);do N!==S&&x.setRelative(N,N,q,k),N=N.nextPointOnContour;while(N!==R)}function pi(e,r){const n=r.stack,a=e?r.rp1:r.rp2,S=(e?r.z0:r.z1)[a],x=r.fv,k=r.pv,M=n.pop();let R,N;switch(U.DEBUG&&console.log(r.step,"SHZ["+e+"]",M),M){case 0:R=r.tZone;break;case 1:R=r.gZone;break;default:throw new Error("Invalid zone")}const q=k.distance(S,S,!1,!0),Y=R.length-2;for(let Z=0;Z<Y;Z++)N=R[Z],x.setRelative(N,N,q,k)}function _i(e,r){const n=r.stack,a=n.pop()/64,S=n.pop(),x=r.z1[S],k=r.z0[r.rp0],M=r.fv,R=r.pv;M.setRelative(x,k,a,R),M.touch(x),U.DEBUG&&console.log(r.step,"MSIRP["+e+"]",a,S),r.rp1=r.rp0,r.rp2=S,e&&(r.rp0=S)}function gi(e,r){const n=r.stack,a=n.pop(),S=n.pop(),x=r.z0[S],k=r.fv,M=r.pv;let R=r.cvt[a];U.DEBUG&&console.log(r.step,"MIAP["+e+"]",a,"(",R,")",S);let N=M.distance(x,Lt);e&&(Math.abs(N-R)<r.cvCutIn&&(N=R),N=r.round(N)),k.setRelative(x,Lt,N,M),r.zp0===0&&(x.xo=x.x,x.yo=x.y),k.touch(x),r.rp0=r.rp1=S}function vi(e,r){const n=r.stack,a=n.pop(),S=r.z2[a];U.DEBUG&&console.log(r.step,"GC["+e+"]",a),n.push(64*r.dpv.distance(S,Lt,e,!1))}function mi(e,r){const n=r.stack,a=n.pop(),S=n.pop(),x=r.z1[a],k=r.z0[S],M=r.dpv.distance(k,x,e,e);U.DEBUG&&console.log(r.step,"MD["+e+"]",a,S,"->",M),r.stack.push(Math.round(64*M))}function jt(e,r){const n=r.stack,a=n.pop(),S=r.fv,x=r.pv,k=r.ppem,M=r.deltaBase+16*(e-1),R=r.deltaShift,N=r.z0;U.DEBUG&&console.log(r.step,"DELTAP["+e+"]",a,n);for(let q=0;q<a;q++){const Y=n.pop(),Z=n.pop();if(M+((240&Z)>>4)!==k)continue;let de=(15&Z)-8;de>=0&&de++,U.DEBUG&&console.log(r.step,"DELTAPFIX",Y,"by",de*R);const ae=N[Y];S.setRelative(ae,ae,de*R,x)}}function Ot(e,r){const n=r.stack,a=n.pop();U.DEBUG&&console.log(r.step,"ROUND[]"),n.push(64*r.round(a/64))}function $t(e,r){const n=r.stack,a=n.pop(),S=r.ppem,x=r.deltaBase+16*(e-1),k=r.deltaShift;U.DEBUG&&console.log(r.step,"DELTAC["+e+"]",a,n);for(let M=0;M<a;M++){const R=n.pop(),N=n.pop();if(x+((240&N)>>4)!==S)continue;let q=(15&N)-8;q>=0&&q++;const Y=q*k;U.DEBUG&&console.log(r.step,"DELTACFIX",R,"by",Y),r.cvt[R]+=Y}}function yi(e,r){const n=r.stack,a=n.pop(),S=n.pop(),x=r.z2[a],k=r.z1[S];let M,R;U.DEBUG&&console.log(r.step,"SDPVTL["+e+"]",a,S),e?(M=x.y-k.y,R=k.x-x.x):(M=k.x-x.x,R=k.y-x.y),r.dpv=Et(M,R)}function ct(e,r){const n=r.stack,a=r.prog;let S=r.ip;U.DEBUG&&console.log(r.step,"PUSHB["+e+"]");for(let x=0;x<e;x++)n.push(a[++S]);r.ip=S}function ht(e,r){let n=r.ip;const a=r.prog,S=r.stack;U.DEBUG&&console.log(r.ip,"PUSHW["+e+"]");for(let x=0;x<e;x++){let k=a[++n]<<8|a[++n];32768&k&&(k=-(1+(65535^k))),S.push(k)}r.ip=n}function ve(e,r,n,a,S,x){const k=x.stack,M=e&&k.pop(),R=k.pop(),N=x.rp0,q=x.z0[N],Y=x.z1[R],Z=x.minDis,de=x.fv,ae=x.dpv;let ye,oe,le,me;oe=ye=ae.distance(Y,q,!0,!0),le=oe>=0?1:-1,oe=Math.abs(oe),e&&(me=x.cvt[M],a&&Math.abs(oe-me)<x.cvCutIn&&(oe=me)),n&&oe<Z&&(oe=Z),a&&(oe=x.round(oe)),de.setRelative(Y,q,le*oe,ae),de.touch(Y),U.DEBUG&&console.log(x.step,(e?"MIRP[":"MDRP[")+(r?"M":"m")+(n?">":"_")+(a?"R":"_")+(S===0?"Gr":S===1?"Bl":S===2?"Wh":"")+"]",e?M+"("+x.cvt[M]+","+me+")":"",R,"(d =",ye,"->",le*oe,")"),x.rp1=x.rp0,x.rp2=R,r&&(x.rp0=R)}ti.prototype.exec=function(e,r){if(typeof r!="number")throw new Error("Point size is not a number!");if(this._errorState>2)return;const n=this.font;let a=this._prepState;if(!a||a.ppem!==r){let S=this._fpgmState;if(!S){lt.prototype=Xs,S=this._fpgmState=new lt("fpgm",n.tables.fpgm),S.funcs=[],S.font=n,U.DEBUG&&(console.log("---EXEC FPGM---"),S.step=-1);try{pt(S)}catch(k){return console.log("Hinting error in FPGM:"+k),void(this._errorState=3)}}lt.prototype=S,a=this._prepState=new lt("prep",n.tables.prep),a.ppem=r;const x=n.tables.cvt;if(x){const k=a.cvt=new Array(x.length),M=r/n.unitsPerEm;for(let R=0;R<x.length;R++)k[R]=x[R]*M}else a.cvt=[];U.DEBUG&&(console.log("---EXEC PREP---"),a.step=-1);try{pt(a)}catch(k){this._errorState<2&&console.log("Hinting error in PREP:"+k),this._errorState=2}}if(!(this._errorState>1))try{return ei(e,a)}catch(S){return this._errorState<1&&(console.log("Hinting error:"+S),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}},ei=function(e,r){const n=r.ppem/r.font.unitsPerEm,a=n;let S,x,k,M=e.components;if(lt.prototype=r,M){const R=r.font;x=[],S=[];for(let N=0;N<M.length;N++){const q=M[N],Y=R.glyphs.get(q.glyphIndex);k=new lt("glyf",Y.instructions),U.DEBUG&&(console.log("---EXEC COMP "+N+"---"),k.step=-1),Gt(Y,k,n,a);const Z=Math.round(q.dx*n),de=Math.round(q.dy*a),ae=k.gZone,ye=k.contours;for(let le=0;le<ae.length;le++){const me=ae[le];me.xTouched=me.yTouched=!1,me.xo=me.x=me.x+Z,me.yo=me.y=me.y+de}const oe=x.length;x.push.apply(x,ae);for(let le=0;le<ye.length;le++)S.push(ye[le]+oe)}e.instructions&&!k.inhibitGridFit&&(k=new lt("glyf",e.instructions),k.gZone=k.z0=k.z1=k.z2=x,k.contours=S,x.push(new it(0,0),new it(Math.round(e.advanceWidth*n),0)),U.DEBUG&&(console.log("---EXEC COMPOSITE---"),k.step=-1),pt(k),x.length-=2)}else k=new lt("glyf",e.instructions),U.DEBUG&&(console.log("---EXEC GLYPH---"),k.step=-1),Gt(e,k,n,a),x=k.gZone;return x},Gt=function(e,r,n,a){const S=e.points||[],x=S.length,k=r.gZone=r.z0=r.z1=r.z2=[],M=r.contours=[];let R,N,q;for(let Y=0;Y<x;Y++)R=S[Y],k[Y]=new it(R.x*n,R.y*a,R.lastPointOfContour,R.onCurve);for(let Y=0;Y<x;Y++)R=k[Y],N||(N=R,M.push(Y)),R.lastPointOfContour?(R.nextPointOnContour=N,N.prevPointOnContour=R,N=void 0):(q=k[Y+1],R.nextPointOnContour=q,q.prevPointOnContour=R);if(!r.inhibitGridFit){if(U.DEBUG){console.log("PROCESSING GLYPH",r.stack);for(let Y=0;Y<x;Y++)console.log(Y,k[Y].x,k[Y].y)}if(k.push(new it(0,0),new it(Math.round(e.advanceWidth*n),0)),pt(r),k.length-=2,U.DEBUG){console.log("FINISHED GLYPH",r.stack);for(let Y=0;Y<x;Y++)console.log(Y,k[Y].x,k[Y].y)}}},pt=function(e){let r=e.prog;if(!r)return;const n=r.length;let a;for(e.ip=0;e.ip<n;e.ip++){if(U.DEBUG&&e.step++,a=Qr[r[e.ip]],!a)throw new Error("unknown instruction: 0x"+Number(r[e.ip]).toString(16));a(e)}},Qr=[ni.bind(void 0,rt),ni.bind(void 0,tt),oi.bind(void 0,rt),oi.bind(void 0,tt),ai.bind(void 0,rt),ai.bind(void 0,tt),li.bind(void 0,0),li.bind(void 0,1),ci.bind(void 0,0),ci.bind(void 0,1),function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"SPVFS[]",n,a),e.pv=e.dpv=Et(a,n)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"SPVFS[]",n,a),e.fv=Et(a,n)},function(e){const r=e.stack,n=e.pv;U.DEBUG&&console.log(e.step,"GPV[]"),r.push(16384*n.x),r.push(16384*n.y)},function(e){const r=e.stack,n=e.fv;U.DEBUG&&console.log(e.step,"GFV[]"),r.push(16384*n.x),r.push(16384*n.y)},function(e){e.fv=e.pv,U.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){const r=e.stack,n=r.pop(),a=r.pop(),S=r.pop(),x=r.pop(),k=r.pop(),M=e.z0,R=e.z1,N=M[n],q=M[a],Y=R[S],Z=R[x],de=e.z2[k];U.DEBUG&&console.log("ISECT[], ",n,a,S,x,k);const ae=N.x,ye=N.y,oe=q.x,le=q.y,me=Y.x,Se=Y.y,Le=Z.x,pe=Z.y,ue=(ae-oe)*(Se-pe)-(ye-le)*(me-Le),ge=ae*le-ye*oe,Te=me*pe-Se*Le;de.x=(ge*(me-Le)-Te*(ae-oe))/ue,de.y=(ge*(Se-pe)-Te*(ye-le))/ue},function(e){e.rp0=e.stack.pop(),U.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),U.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),U.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZP0[]",r),e.zp0=r,r){case 0:e.tZone||Bt(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZP1[]",r),e.zp1=r,r){case 0:e.tZone||Bt(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZP2[]",r),e.zp2=r,r){case 0:e.tZone||Bt(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const r=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SZPS[]",r),e.zp0=e.zp1=e.zp2=r,r){case 0:e.tZone||Bt(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),U.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){U.DEBUG&&console.log(e.step,"RTG[]"),e.round=ri},function(e){U.DEBUG&&console.log(e.step,"RTHG[]"),e.round=qs},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SMD[]",r),e.minDis=r/64},function(e){U.DEBUG&&console.log(e.step,"ELSE[]"),si(e,!1)},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"JMPR[]",r),e.ip+=r-1},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SCVTCI[]",r),e.cvCutIn=r/64},void 0,void 0,function(e){const r=e.stack;U.DEBUG&&console.log(e.step,"DUP[]"),r.push(r[r.length-1])},zt,function(e){U.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"SWAP[]"),r.push(n),r.push(a)},function(e){const r=e.stack;U.DEBUG&&console.log(e.step,"DEPTH[]"),r.push(r.length)},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"CINDEX[]",n),r.push(r[r.length-n])},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"MINDEX[]",n),r.push(r.splice(r.length-n,1)[0])},void 0,void 0,void 0,function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"LOOPCALL[]",n,a);const S=e.ip,x=e.prog;e.prog=e.funcs[n];for(let k=0;k<a;k++)pt(e),U.DEBUG&&console.log(++e.step,k+1<a?"next loopcall":"done loopcall",k);e.ip=S,e.prog=x},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"CALL[]",r);const n=e.ip,a=e.prog;e.prog=e.funcs[r],pt(e),e.ip=n,e.prog=a,U.DEBUG&&console.log(++e.step,"returning from",r)},function(e){if(e.env!=="fpgm")throw new Error("FDEF not allowed here");const r=e.stack,n=e.prog;let a=e.ip;const S=r.pop(),x=a;for(U.DEBUG&&console.log(e.step,"FDEF[]",S);n[++a]!==45;);e.ip=a,e.funcs[S]=n.slice(x+1,a)},void 0,hi.bind(void 0,0),hi.bind(void 0,1),ui.bind(void 0,rt),ui.bind(void 0,tt),di.bind(void 0,0),di.bind(void 0,1),fi.bind(void 0,0),fi.bind(void 0,1),pi.bind(void 0,0),pi.bind(void 0,1),function(e){const r=e.stack;let n=e.loop;const a=e.fv,S=r.pop()/64,x=e.z2;for(;n--;){const k=r.pop(),M=x[k];U.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"SHPIX[]",k,S),a.setRelative(M,M,S),a.touch(M)}e.loop=1},function(e){const r=e.stack,n=e.rp1,a=e.rp2;let S=e.loop;const x=e.z0[n],k=e.z1[a],M=e.fv,R=e.dpv,N=e.z2;for(;S--;){const q=r.pop(),Y=N[q];U.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-S)+": ":"")+"IP[]",q,n,"<->",a),M.interpolate(Y,x,k,R),M.touch(Y)}e.loop=1},_i.bind(void 0,0),_i.bind(void 0,1),function(e){const r=e.stack,n=e.rp0,a=e.z0[n];let S=e.loop;const x=e.fv,k=e.pv,M=e.z1;for(;S--;){const R=r.pop(),N=M[R];U.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-S)+": ":"")+"ALIGNRP[]",R),x.setRelative(N,a,0,k),x.touch(N)}e.loop=1},function(e){U.DEBUG&&console.log(e.step,"RTDG[]"),e.round=$s},gi.bind(void 0,0),gi.bind(void 0,1),function(e){const r=e.prog;let n=e.ip;const a=e.stack,S=r[++n];U.DEBUG&&console.log(e.step,"NPUSHB[]",S);for(let x=0;x<S;x++)a.push(r[++n]);e.ip=n},function(e){let r=e.ip;const n=e.prog,a=e.stack,S=n[++r];U.DEBUG&&console.log(e.step,"NPUSHW[]",S);for(let x=0;x<S;x++){let k=n[++r]<<8|n[++r];32768&k&&(k=-(1+(65535^k))),a.push(k)}e.ip=r},function(e){const r=e.stack;let n=e.store;n||(n=e.store=[]);const a=r.pop(),S=r.pop();U.DEBUG&&console.log(e.step,"WS",a,S),n[S]=a},function(e){const r=e.stack,n=e.store,a=r.pop();U.DEBUG&&console.log(e.step,"RS",a);const S=n&&n[a]||0;r.push(S)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"WCVTP",n,a),e.cvt[a]=n/64},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"RCVT",n),r.push(64*e.cvt[n])},vi.bind(void 0,0),vi.bind(void 0,1),void 0,mi.bind(void 0,0),mi.bind(void 0,1),function(e){U.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){U.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"LT[]",n,a),r.push(a<n?1:0)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"LTEQ[]",n,a),r.push(a<=n?1:0)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"GT[]",n,a),r.push(a>n?1:0)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"GTEQ[]",n,a),r.push(a>=n?1:0)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"EQ[]",n,a),r.push(n===a?1:0)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"NEQ[]",n,a),r.push(n!==a?1:0)},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"ODD[]",n),r.push(Math.trunc(n)%2?1:0)},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"EVEN[]",n),r.push(Math.trunc(n)%2?0:1)},function(e){let r=e.stack.pop();U.DEBUG&&console.log(e.step,"IF[]",r),r||(si(e,!0),U.DEBUG&&console.log(e.step,"EIF[]"))},function(e){U.DEBUG&&console.log(e.step,"EIF[]")},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"AND[]",n,a),r.push(n&&a?1:0)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"OR[]",n,a),r.push(n||a?1:0)},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"NOT[]",n),r.push(n?0:1)},jt.bind(void 0,1),function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SDB[]",r),e.deltaBase=r},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SDS[]",r),e.deltaShift=Math.pow(.5,r)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"ADD[]",n,a),r.push(a+n)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"SUB[]",n,a),r.push(a-n)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"DIV[]",n,a),r.push(64*a/n)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"MUL[]",n,a),r.push(a*n/64)},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"ABS[]",n),r.push(Math.abs(n))},function(e){const r=e.stack;let n=r.pop();U.DEBUG&&console.log(e.step,"NEG[]",n),r.push(-n)},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"FLOOR[]",n),r.push(64*Math.floor(n/64))},function(e){const r=e.stack,n=r.pop();U.DEBUG&&console.log(e.step,"CEILING[]",n),r.push(64*Math.ceil(n/64))},Ot.bind(void 0,0),Ot.bind(void 0,1),Ot.bind(void 0,2),Ot.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"WCVTF[]",n,a),e.cvt[a]=n*e.ppem/e.font.unitsPerEm},jt.bind(void 0,2),jt.bind(void 0,3),$t.bind(void 0,1),$t.bind(void 0,2),$t.bind(void 0,3),function(e){let r,n=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=ii,192&n){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=r,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=n===0?0:(n/8-.5)*r},function(e){let r,n=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=ii,192&n){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=r,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=n===0?0:(n/8-.5)*r},void 0,void 0,function(e){U.DEBUG&&console.log(e.step,"ROFF[]"),e.round=js},void 0,function(e){U.DEBUG&&console.log(e.step,"RUTG[]"),e.round=Vs},function(e){U.DEBUG&&console.log(e.step,"RDTG[]"),e.round=Ks},zt,zt,void 0,void 0,void 0,void 0,void 0,function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SCANCTRL[]",r)},yi.bind(void 0,0),yi.bind(void 0,1),function(e){const r=e.stack,n=r.pop();let a=0;U.DEBUG&&console.log(e.step,"GETINFO[]",n),1&n&&(a=35),32&n&&(a|=4096),r.push(a)},void 0,function(e){const r=e.stack,n=r.pop(),a=r.pop(),S=r.pop();U.DEBUG&&console.log(e.step,"ROLL[]"),r.push(a),r.push(n),r.push(S)},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"MAX[]",n,a),r.push(Math.max(a,n))},function(e){const r=e.stack,n=r.pop(),a=r.pop();U.DEBUG&&console.log(e.step,"MIN[]",n,a),r.push(Math.min(a,n))},function(e){const r=e.stack.pop();U.DEBUG&&console.log(e.step,"SCANTYPE[]",r)},function(e){const r=e.stack.pop();let n=e.stack.pop();switch(U.DEBUG&&console.log(e.step,"INSTCTRL[]",r,n),r){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ct.bind(void 0,1),ct.bind(void 0,2),ct.bind(void 0,3),ct.bind(void 0,4),ct.bind(void 0,5),ct.bind(void 0,6),ct.bind(void 0,7),ct.bind(void 0,8),ht.bind(void 0,1),ht.bind(void 0,2),ht.bind(void 0,3),ht.bind(void 0,4),ht.bind(void 0,5),ht.bind(void 0,6),ht.bind(void 0,7),ht.bind(void 0,8),ve.bind(void 0,0,0,0,0,0),ve.bind(void 0,0,0,0,0,1),ve.bind(void 0,0,0,0,0,2),ve.bind(void 0,0,0,0,0,3),ve.bind(void 0,0,0,0,1,0),ve.bind(void 0,0,0,0,1,1),ve.bind(void 0,0,0,0,1,2),ve.bind(void 0,0,0,0,1,3),ve.bind(void 0,0,0,1,0,0),ve.bind(void 0,0,0,1,0,1),ve.bind(void 0,0,0,1,0,2),ve.bind(void 0,0,0,1,0,3),ve.bind(void 0,0,0,1,1,0),ve.bind(void 0,0,0,1,1,1),ve.bind(void 0,0,0,1,1,2),ve.bind(void 0,0,0,1,1,3),ve.bind(void 0,0,1,0,0,0),ve.bind(void 0,0,1,0,0,1),ve.bind(void 0,0,1,0,0,2),ve.bind(void 0,0,1,0,0,3),ve.bind(void 0,0,1,0,1,0),ve.bind(void 0,0,1,0,1,1),ve.bind(void 0,0,1,0,1,2),ve.bind(void 0,0,1,0,1,3),ve.bind(void 0,0,1,1,0,0),ve.bind(void 0,0,1,1,0,1),ve.bind(void 0,0,1,1,0,2),ve.bind(void 0,0,1,1,0,3),ve.bind(void 0,0,1,1,1,0),ve.bind(void 0,0,1,1,1,1),ve.bind(void 0,0,1,1,1,2),ve.bind(void 0,0,1,1,1,3),ve.bind(void 0,1,0,0,0,0),ve.bind(void 0,1,0,0,0,1),ve.bind(void 0,1,0,0,0,2),ve.bind(void 0,1,0,0,0,3),ve.bind(void 0,1,0,0,1,0),ve.bind(void 0,1,0,0,1,1),ve.bind(void 0,1,0,0,1,2),ve.bind(void 0,1,0,0,1,3),ve.bind(void 0,1,0,1,0,0),ve.bind(void 0,1,0,1,0,1),ve.bind(void 0,1,0,1,0,2),ve.bind(void 0,1,0,1,0,3),ve.bind(void 0,1,0,1,1,0),ve.bind(void 0,1,0,1,1,1),ve.bind(void 0,1,0,1,1,2),ve.bind(void 0,1,0,1,1,3),ve.bind(void 0,1,1,0,0,0),ve.bind(void 0,1,1,0,0,1),ve.bind(void 0,1,1,0,0,2),ve.bind(void 0,1,1,0,0,3),ve.bind(void 0,1,1,0,1,0),ve.bind(void 0,1,1,0,1,1),ve.bind(void 0,1,1,0,1,2),ve.bind(void 0,1,1,0,1,3),ve.bind(void 0,1,1,1,0,0),ve.bind(void 0,1,1,1,0,1),ve.bind(void 0,1,1,1,0,2),ve.bind(void 0,1,1,1,0,3),ve.bind(void 0,1,1,1,1,0),ve.bind(void 0,1,1,1,1,1),ve.bind(void 0,1,1,1,1,2),ve.bind(void 0,1,1,1,1,3)];const Ys=ti;function De(e){(e=e||{}).empty||(vt(e.familyName,"When creating a new Font object, familyName is required."),vt(e.styleName,"When creating a new Font object, styleName is required."),vt(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),vt(e.ascender,"When creating a new Font object, ascender is required."),vt(e.descender,"When creating a new Font object, descender is required."),vt(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||e.familyName+e.styleName},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new _t.GlyphSet(this,e.glyphs||[]),this.encoding=new Ne(this),this.position=new Ws(this),this.substitution=new zs(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:this.outlinesFormat==="truetype"?this._hinting=new Ys(this):void 0}})}De.prototype.hasChar=function(e){return this.encoding.charToGlyphIndex(e)!==null},De.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},De.prototype.charToGlyph=function(e){const r=this.charToGlyphIndex(e);let n=this.glyphs.get(r);return n||(n=this.glyphs.get(0)),n},De.prototype.stringToGlyphs=function(e,r){r=r||this.defaultRenderOptions;const n=[];for(let k=0;k<e.length;k+=1){const M=e[k];n.push(this.charToGlyphIndex(M))}let a=n.length;if(r.features){const k=r.script||this.substitution.getDefaultScriptName();let M=[];r.features.liga&&(M=M.concat(this.substitution.getFeature("liga",k,r.language))),r.features.rlig&&(M=M.concat(this.substitution.getFeature("rlig",k,r.language)));for(let R=0;R<a;R+=1)for(let N=0;N<M.length;N++){const q=M[N],Y=q.sub,Z=Y.length;let de=0;for(;de<Z&&Y[de]===n[R+de];)de++;de===Z&&(n.splice(R,Z,q.by),a=a-Z+1)}}const S=new Array(a),x=this.glyphs.get(0);for(let k=0;k<a;k+=1)S[k]=this.glyphs.get(n[k])||x;return S},De.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},De.prototype.nameToGlyph=function(e){const r=this.nameToGlyphIndex(e);let n=this.glyphs.get(r);return n||(n=this.glyphs.get(0)),n},De.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},De.prototype.getKerningValue=function(e,r){return e=e.index||e,r=r.index||r,this.kerningPairs[e+","+r]||0},De.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},De.prototype.forEachGlyph=function(e,r,n,a,S,x){r=r!==void 0?r:0,n=n!==void 0?n:0,a=a!==void 0?a:72,S=S||this.defaultRenderOptions;const k=1/this.unitsPerEm*a,M=this.stringToGlyphs(e,S);let R;if(S.kerning){const N=S.script||this.position.getDefaultScriptName();R=this.position.getKerningTables(N,S.language)}for(let N=0;N<M.length;N+=1){const q=M[N];x.call(this,q,r,n,a,S),q.advanceWidth&&(r+=q.advanceWidth*k),S.kerning&&N<M.length-1&&(r+=(R?this.position.getKerningValue(R,q.index,M[N+1].index):this.getKerningValue(q,M[N+1]))*k),S.letterSpacing?r+=S.letterSpacing*a:S.tracking&&(r+=S.tracking/1e3*a)}return r},De.prototype.getPath=function(e,r,n,a,S){const x=new i;return this.forEachGlyph(e,r,n,a,S,function(k,M,R,N){const q=k.getPath(M,R,N,S,this);x.extend(q)}),x},De.prototype.getPaths=function(e,r,n,a,S){const x=[];return this.forEachGlyph(e,r,n,a,S,function(k,M,R,N){const q=k.getPath(M,R,N,S,this);x.push(q)}),x},De.prototype.getAdvanceWidth=function(e,r,n){return this.forEachGlyph(e,0,0,r,n,function(){})},De.prototype.draw=function(e,r,n,a,S,x){this.getPath(r,n,a,S,x).draw(e)},De.prototype.drawPoints=function(e,r,n,a,S,x){this.forEachGlyph(r,n,a,S,x,function(k,M,R,N){k.drawPoints(e,M,R,N)})},De.prototype.drawMetrics=function(e,r,n,a,S,x){this.forEachGlyph(r,n,a,S,x,function(k,M,R,N){k.drawMetrics(e,M,R,N)})},De.prototype.getEnglishName=function(e){const r=this.names[e];if(r)return r.en},De.prototype.validate=function(){const e=this;function r(a,S){}function n(a){const S=e.getEnglishName(a);S&&S.trim().length>0}n("fontFamily"),n("weightName"),n("manufacturer"),n("copyright"),n("version"),this.unitsPerEm>0},De.prototype.toTables=function(){return Ns(this)},De.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},De.prototype.toArrayBuffer=function(){const e=this.toTables().encode(),r=new ArrayBuffer(e.length),n=new Uint8Array(r);for(let a=0;a<e.length;a++)n[a]=e[a];return r},De.prototype.download=function(e){const r=this.getEnglishName("fontFamily"),n=this.getEnglishName("fontSubfamily");e=e||r.replace(/\s/g,"")+"-"+n+".otf";const a=this.toArrayBuffer();if(typeof window<"u")window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,a.byteLength,function(S){S.root.getFile(e,{create:!0},function(x){x.createWriter(function(k){const M=new DataView(a),R=new Blob([M],{type:"font/opentype"});k.write(R),k.addEventListener("writeend",function(){location.href=x.toURL()},!1)})})},function(S){throw new Error(S.name+": "+S.message)});else{const S=d(89),x=function(k){const M=new Buffer(k.byteLength),R=new Uint8Array(k);for(let N=0;N<M.length;++N)M[N]=R[N];return M}(a);S.writeFileSync(e,x)}},De.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},De.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},De.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};const bi=De;function Zs(e,r,n){const a={},S=new fe.Parser(e,r);return a.tag=S.parseTag(),a.minValue=S.parseFixed(),a.defaultValue=S.parseFixed(),a.maxValue=S.parseFixed(),S.skip("uShort",1),a.name=n[S.parseUShort()]||{},a}function Js(e,r,n,a){const S={},x=new fe.Parser(e,r);S.name=a[x.parseUShort()]||{},x.skip("uShort",1),S.coordinates={};for(let k=0;k<n.length;++k)S.coordinates[n[k].tag]=x.parseFixed();return S}const Qs=function(e,r,n){const a=new fe.Parser(e,r),S=a.parseULong();v.argument(S===65536,"Unsupported fvar table version.");const x=a.parseOffset16();a.skip("uShort",1);const k=a.parseUShort(),M=a.parseUShort(),R=a.parseUShort(),N=a.parseUShort(),q=[];for(let de=0;de<k;de++)q.push(Zs(e,r+x+de*M,n));const Y=[],Z=r+x+k*M;for(let de=0;de<R;de++)Y.push(Js(e,Z+de*N,q,n));return{axes:q,instances:Y}},Je=new Array(10);Je[1]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort();return r===1?{posFormat:1,coverage:this.parsePointer(ee.coverage),value:this.parseValueRecord()}:r===2?{posFormat:2,coverage:this.parsePointer(ee.coverage),values:this.parseValueRecordList()}:void v.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Je[2]=function(){const e=this.offset+this.relativeOffset,r=this.parseUShort(),n=this.parsePointer(ee.coverage),a=this.parseUShort(),S=this.parseUShort();if(r===1)return{posFormat:r,coverage:n,valueFormat1:a,valueFormat2:S,pairSets:this.parseList(ee.pointer(ee.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(a),value2:this.parseValueRecord(S)}})))};if(r===2){const x=this.parsePointer(ee.classDef),k=this.parsePointer(ee.classDef),M=this.parseUShort(),R=this.parseUShort();return{posFormat:r,coverage:n,valueFormat1:a,valueFormat2:S,classDef1:x,classDef2:k,class1Count:M,class2Count:R,classRecords:this.parseList(M,ee.list(R,function(){return{value1:this.parseValueRecord(a),value2:this.parseValueRecord(S)}}))}}v.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.")},Je[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Je[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Je[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Je[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Je[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Je[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Je[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);const en=function(e,r){const n=new ee(e,r=r||0),a=n.parseVersion(1);return v.argument(a===1||a===1.1,"Unsupported GPOS table version "+a),a===1?{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Je)}:{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Je),variations:n.parseFeatureVariationsList()}},tn=function(e,r){const n=new fe.Parser(e,r),a=n.parseUShort();if(a===0)return function(S){const x={};S.skip("uShort");const k=S.parseUShort();v.argument(k===0,"Unsupported kern sub-table version."),S.skip("uShort",2);const M=S.parseUShort();S.skip("uShort",3);for(let R=0;R<M;R+=1){const N=S.parseUShort(),q=S.parseUShort(),Y=S.parseShort();x[N+","+q]=Y}return x}(n);if(a===1)return function(S){const x={};S.skip("uShort"),S.parseULong()>1&&console.warn("Only the first kern subtable is supported."),S.skip("uLong");const k=255&S.parseUShort();if(S.skip("uShort"),k===0){const M=S.parseUShort();S.skip("uShort",3);for(let R=0;R<M;R+=1){const N=S.parseUShort(),q=S.parseUShort(),Y=S.parseShort();x[N+","+q]=Y}}return x}(n);throw new Error("Unsupported kern table version ("+a+").")},rn=function(e,r,n,a){const S=new fe.Parser(e,r),x=a?S.parseUShort:S.parseULong,k=[];for(let M=0;M<n+1;M+=1){let R=x.call(S);a&&(R*=2),k.push(R)}return k};function sn(e,r){d(89).readFile(e,function(n,a){if(n)return r(n.message);r(null,Jr(a))})}function nn(e,r){const n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?r(null,n.response):r("Font could not be loaded: "+n.statusText)},n.onerror=function(){r("Font could not be loaded")},n.send()}function Si(e,r){const n=[];let a=12;for(let S=0;S<r;S+=1){const x=fe.getTag(e,a),k=fe.getULong(e,a+4),M=fe.getULong(e,a+8),R=fe.getULong(e,a+12);n.push({tag:x,checksum:k,offset:M,length:R,compression:!1}),a+=16}return n}function Oe(e,r){if(r.compression==="WOFF"){const n=new Uint8Array(e.buffer,r.offset+2,r.compressedLength-2),a=new Uint8Array(r.length);if(_()(n,a),a.byteLength!==r.length)throw new Error("Decompression error: "+r.tag+" decompressed length doesn't match recorded length");return{data:new DataView(a.buffer,0),offset:0}}return{data:e,offset:r.offset}}function qt(e){let r,n;const a=new bi({empty:!0}),S=new DataView(e,0);let x,k=[];const M=fe.getTag(S,0);if(M===String.fromCharCode(0,1,0,0)||M==="true"||M==="typ1")a.outlinesFormat="truetype",x=fe.getUShort(S,4),k=Si(S,x);else if(M==="OTTO")a.outlinesFormat="cff",x=fe.getUShort(S,4),k=Si(S,x);else{if(M!=="wOFF")throw new Error("Unsupported OpenType signature "+M);{const pe=fe.getTag(S,4);if(pe===String.fromCharCode(0,1,0,0))a.outlinesFormat="truetype";else{if(pe!=="OTTO")throw new Error("Unsupported OpenType flavor "+M);a.outlinesFormat="cff"}x=fe.getUShort(S,12),k=function(ue,ge){const Te=[];let we=44;for(let Ie=0;Ie<ge;Ie+=1){const We=fe.getTag(ue,we),qe=fe.getULong(ue,we+4),Fe=fe.getULong(ue,we+8),je=fe.getULong(ue,we+12);let Ue;Ue=Fe<je&&"WOFF",Te.push({tag:We,offset:qe,compression:Ue,compressedLength:Fe,length:je}),we+=20}return Te}(S,x)}}let R,N,q,Y,Z,de,ae,ye,oe,le,me;for(let pe=0;pe<x;pe+=1){const ue=k[pe];let ge;switch(ue.tag){case"cmap":ge=Oe(S,ue),a.tables.cmap=Re(ge.data,ge.offset),a.encoding=new nt(a.tables.cmap);break;case"cvt ":ge=Oe(S,ue),me=new fe.Parser(ge.data,ge.offset),a.tables.cvt=me.parseShortList(ue.length/2);break;case"fvar":N=ue;break;case"fpgm":ge=Oe(S,ue),me=new fe.Parser(ge.data,ge.offset),a.tables.fpgm=me.parseByteList(ue.length);break;case"head":ge=Oe(S,ue),a.tables.head=fs(ge.data,ge.offset),a.unitsPerEm=a.tables.head.unitsPerEm,r=a.tables.head.indexToLocFormat;break;case"hhea":ge=Oe(S,ue),a.tables.hhea=_s(ge.data,ge.offset),a.ascender=a.tables.hhea.ascender,a.descender=a.tables.hhea.descender,a.numberOfHMetrics=a.tables.hhea.numberOfHMetrics;break;case"hmtx":de=ue;break;case"ltag":ge=Oe(S,ue),n=bs(ge.data,ge.offset);break;case"maxp":ge=Oe(S,ue),a.tables.maxp=Ss(ge.data,ge.offset),a.numGlyphs=a.tables.maxp.numGlyphs;break;case"name":oe=ue;break;case"OS/2":ge=Oe(S,ue),a.tables.os2=As(ge.data,ge.offset);break;case"post":ge=Oe(S,ue),a.tables.post=Ms(ge.data,ge.offset),a.glyphNames=new ze(a.tables.post);break;case"prep":ge=Oe(S,ue),me=new fe.Parser(ge.data,ge.offset),a.tables.prep=me.parseByteList(ue.length);break;case"glyf":q=ue;break;case"loca":ye=ue;break;case"CFF ":R=ue;break;case"kern":ae=ue;break;case"GPOS":Y=ue;break;case"GSUB":Z=ue;break;case"meta":le=ue}}const Se=Oe(S,oe);if(a.tables.name=ks(Se.data,Se.offset,n),a.names=a.tables.name,q&&ye){const pe=r===0,ue=Oe(S,ye),ge=rn(ue.data,ue.offset,a.numGlyphs,pe),Te=Oe(S,q);a.glyphs=Er.parse(Te.data,Te.offset,ge,a)}else{if(!R)throw new Error("Font doesn't contain TrueType or CFF outlines.");{const pe=Oe(S,R);us(pe.data,pe.offset,a)}}const Le=Oe(S,de);if(vs(Le.data,Le.offset,a.numberOfHMetrics,a.numGlyphs,a.glyphs),function(pe){let ue;const ge=pe.tables.cmap.glyphIndexMap,Te=Object.keys(ge);for(let we=0;we<Te.length;we+=1){const Ie=Te[we],We=ge[Ie];ue=pe.glyphs.get(We),ue.addUnicode(parseInt(Ie))}for(let we=0;we<pe.glyphs.length;we+=1)ue=pe.glyphs.get(we),pe.cffEncoding?pe.isCIDFont?ue.name="gid"+we:ue.name=pe.cffEncoding.charset[we]:pe.glyphNames.names&&(ue.name=pe.glyphNames.glyphIndexToName(we))}(a),ae){const pe=Oe(S,ae);a.kerningPairs=tn(pe.data,pe.offset)}else a.kerningPairs={};if(Y){const pe=Oe(S,Y);a.tables.gpos=en(pe.data,pe.offset)}if(Z){const pe=Oe(S,Z);a.tables.gsub=Os(pe.data,pe.offset)}if(N){const pe=Oe(S,N);a.tables.fvar=Qs(pe.data,pe.offset,a.names)}if(le){const pe=Oe(S,le);a.tables.meta=Ps(pe.data,pe.offset),a.metas=a.tables.meta}return a}function on(e,r){(typeof window>"u"?sn:nn)(e,function(n,a){if(n)return r(n);let S;try{S=qt(a)}catch(x){return r(x,null)}return r(null,S)})}function an(e){return qt(Jr(d(89).readFileSync(e)))}},896:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(978);class _ extends C.Writable{constructor(){super(...arguments),this.offset=0,this._waiters=[],this._closed=!1}_write(l,s,i){let h=0;const p=()=>{for(;this._waiters.length>0;){const v=this._waiters[0];if(this._buffer){const w=this._buffer.size-this._buffer.offset;if(!(w+l.length>=v.size)){if(!v.skip){const m=Buffer.alloc(w+l.length);this._buffer.buf.copy(m,0,this._buffer.offset,this._buffer.size),l.copy(m,w,0,l.length),this._buffer.buf=m}this._buffer.offset=0,this._buffer.size=w+l.length,i();break}if(v.skip)this._buffer=void 0,v.resolve();else{const m=Math.min(w,v.size),b=Buffer.alloc(v.size);this._buffer.buf.copy(b,0,this._buffer.offset,this._buffer.offset+m),l.copy(b,m,0,v.size-m),v.resolve(b)}if(this.offset+=v.size,this._waiters.shift(),this._buffer=void 0,w+l.length===v.size){i();break}h+=v.size-w}else{if(!(l.length-h>=v.size)){this._buffer={buf:v.skip?void 0:l.slice(h),offset:0,size:l.length-h},h=l.length,i();break}if(v.skip?v.resolve():v.resolve(l.slice(h,h+v.size)),this.offset+=v.size,this._waiters.shift(),h+=v.size,l.length===h){i();break}}}this._processTrigger=l.length-h>0?p:void 0};p()}_destroy(l,s){this._processTrigger=void 0;for(const i of this._waiters)i.reject(l||new Error("stream destroyed"));this._waiters=[],this._closed=!0}_final(l){this._processTrigger=void 0;for(const s of this._waiters)s.reject(new Error("not enough data in stream"));this._waiters=[],this._closed=!0}read(l){return new Promise((s,i)=>{this._closed&&i(new Error("stream is closed")),this._waiters.push({resolve:s,reject:i,size:l,skip:!1}),this._processTrigger&&this._processTrigger()})}skip(l){return new Promise((s,i)=>{this._closed&&i(new Error("stream is closed")),this._waiters.push({resolve:s,reject:i,size:l,skip:!0}),this._processTrigger&&this._processTrigger()})}}function o(){return new _}f.exports=Object.assign(o,{default:o}),u.default=o},311:f=>{function u(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function d(D,H){this.source=D,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=H,this.destLen=0,this.ltree=new u,this.dtree=new u}var C=new u,_=new u,o=new Uint8Array(30),t=new Uint16Array(30),l=new Uint8Array(30),s=new Uint16Array(30),i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new u,p=new Uint8Array(320);function v(D,H,L,I){var O,P;for(O=0;O<L;++O)D[O]=0;for(O=0;O<30-L;++O)D[O+L]=O/L|0;for(P=I,O=0;O<30;++O)H[O]=P,P+=1<<D[O]}var w=new Uint16Array(16);function m(D,H,L,I){var O,P;for(O=0;O<16;++O)D.table[O]=0;for(O=0;O<I;++O)D.table[H[L+O]]++;for(D.table[0]=0,P=0,O=0;O<16;++O)w[O]=P,P+=D.table[O];for(O=0;O<I;++O)H[L+O]&&(D.trans[w[H[L+O]]++]=O)}function b(D){D.bitcount--||(D.tag=D.source[D.sourceIndex++],D.bitcount=7);var H=1&D.tag;return D.tag>>>=1,H}function E(D,H,L){if(!H)return L;for(;D.bitcount<24;)D.tag|=D.source[D.sourceIndex++]<<D.bitcount,D.bitcount+=8;var I=D.tag&65535>>>16-H;return D.tag>>>=H,D.bitcount-=H,I+L}function A(D,H){for(;D.bitcount<24;)D.tag|=D.source[D.sourceIndex++]<<D.bitcount,D.bitcount+=8;var L=0,I=0,O=0,P=D.tag;do I=2*I+(1&P),P>>>=1,++O,L+=H.table[O],I-=H.table[O];while(I>=0);return D.tag=P,D.bitcount-=O,H.trans[L+I]}function T(D,H,L){var I,O,P,Q,z,X;for(I=E(D,5,257),O=E(D,5,1),P=E(D,4,4),Q=0;Q<19;++Q)p[Q]=0;for(Q=0;Q<P;++Q){var K=E(D,3,0);p[i[Q]]=K}for(m(h,p,0,19),z=0;z<I+O;){var ie=A(D,h);switch(ie){case 16:var G=p[z-1];for(X=E(D,2,3);X;--X)p[z++]=G;break;case 17:for(X=E(D,3,3);X;--X)p[z++]=0;break;case 18:for(X=E(D,7,11);X;--X)p[z++]=0;break;default:p[z++]=ie}}m(H,p,0,I),m(L,p,I,O)}function B(D,H,L){for(;;){var I,O,P,Q,z=A(D,H);if(z===256)return 0;if(z<256)D.dest[D.destLen++]=z;else for(I=E(D,o[z-=257],t[z]),O=A(D,L),Q=P=D.destLen-E(D,l[O],s[O]);Q<P+I;++Q)D.dest[D.destLen++]=D.dest[Q]}}function F(D){for(var H,L;D.bitcount>8;)D.sourceIndex--,D.bitcount-=8;if((H=256*(H=D.source[D.sourceIndex+1])+D.source[D.sourceIndex])!==(65535&~(256*D.source[D.sourceIndex+3]+D.source[D.sourceIndex+2])))return-3;for(D.sourceIndex+=4,L=H;L;--L)D.dest[D.destLen++]=D.source[D.sourceIndex++];return D.bitcount=0,0}(function(D,H){var L;for(L=0;L<7;++L)D.table[L]=0;for(D.table[7]=24,D.table[8]=152,D.table[9]=112,L=0;L<24;++L)D.trans[L]=256+L;for(L=0;L<144;++L)D.trans[24+L]=L;for(L=0;L<8;++L)D.trans[168+L]=280+L;for(L=0;L<112;++L)D.trans[176+L]=144+L;for(L=0;L<5;++L)H.table[L]=0;for(H.table[5]=32,L=0;L<32;++L)H.trans[L]=L})(C,_),v(o,t,4,3),v(l,s,2,1),o[28]=0,t[28]=258,f.exports=function(D,H){var L,I,O=new d(D,H);do{switch(L=b(O),E(O,2,0)){case 0:I=F(O);break;case 1:I=B(O,C,_);break;case 2:T(O,O.ltree,O.dtree),I=B(O,O.ltree,O.dtree);break;default:I=-3}if(I!==0)throw new Error("Data error")}while(!L);return O.destLen<O.dest.length?typeof O.dest.slice=="function"?O.dest.slice(0,O.destLen):O.dest.subarray(0,O.destLen):O.dest}},371:f=>{f.exports=function(u){u.prototype[Symbol.iterator]=function*(){for(let d=this.head;d;d=d.next)yield d.value}}},411:(f,u,d)=>{function C(s){var i=this;if(i instanceof C||(i=new C),i.tail=null,i.head=null,i.length=0,s&&typeof s.forEach=="function")s.forEach(function(v){i.push(v)});else if(arguments.length>0)for(var h=0,p=arguments.length;h<p;h++)i.push(arguments[h]);return i}function _(s,i,h){var p=i===s.head?new l(h,null,i,s):new l(h,i,i.next,s);return p.next===null&&(s.tail=p),p.prev===null&&(s.head=p),s.length++,p}function o(s,i){s.tail=new l(i,s.tail,null,s),s.head||(s.head=s.tail),s.length++}function t(s,i){s.head=new l(i,null,s.head,s),s.tail||(s.tail=s.head),s.length++}function l(s,i,h,p){if(!(this instanceof l))return new l(s,i,h,p);this.list=p,this.value=s,i?(i.next=this,this.prev=i):this.prev=null,h?(h.prev=this,this.next=h):this.next=null}f.exports=C,C.Node=l,C.create=C,C.prototype.removeNode=function(s){if(s.list!==this)throw new Error("removing node which does not belong to this list");var i=s.next,h=s.prev;return i&&(i.prev=h),h&&(h.next=i),s===this.head&&(this.head=i),s===this.tail&&(this.tail=h),s.list.length--,s.next=null,s.prev=null,s.list=null,i},C.prototype.unshiftNode=function(s){if(s!==this.head){s.list&&s.list.removeNode(s);var i=this.head;s.list=this,s.next=i,i&&(i.prev=s),this.head=s,this.tail||(this.tail=s),this.length++}},C.prototype.pushNode=function(s){if(s!==this.tail){s.list&&s.list.removeNode(s);var i=this.tail;s.list=this,s.prev=i,i&&(i.next=s),this.tail=s,this.head||(this.head=s),this.length++}},C.prototype.push=function(){for(var s=0,i=arguments.length;s<i;s++)o(this,arguments[s]);return this.length},C.prototype.unshift=function(){for(var s=0,i=arguments.length;s<i;s++)t(this,arguments[s]);return this.length},C.prototype.pop=function(){if(this.tail){var s=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,s}},C.prototype.shift=function(){if(this.head){var s=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,s}},C.prototype.forEach=function(s,i){i=i||this;for(var h=this.head,p=0;h!==null;p++)s.call(i,h.value,p,this),h=h.next},C.prototype.forEachReverse=function(s,i){i=i||this;for(var h=this.tail,p=this.length-1;h!==null;p--)s.call(i,h.value,p,this),h=h.prev},C.prototype.get=function(s){for(var i=0,h=this.head;h!==null&&i<s;i++)h=h.next;if(i===s&&h!==null)return h.value},C.prototype.getReverse=function(s){for(var i=0,h=this.tail;h!==null&&i<s;i++)h=h.prev;if(i===s&&h!==null)return h.value},C.prototype.map=function(s,i){i=i||this;for(var h=new C,p=this.head;p!==null;)h.push(s.call(i,p.value,this)),p=p.next;return h},C.prototype.mapReverse=function(s,i){i=i||this;for(var h=new C,p=this.tail;p!==null;)h.push(s.call(i,p.value,this)),p=p.prev;return h},C.prototype.reduce=function(s,i){var h,p=this.head;if(arguments.length>1)h=i;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");p=this.head.next,h=this.head.value}for(var v=0;p!==null;v++)h=s(h,p.value,v),p=p.next;return h},C.prototype.reduceReverse=function(s,i){var h,p=this.tail;if(arguments.length>1)h=i;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");p=this.tail.prev,h=this.tail.value}for(var v=this.length-1;p!==null;v--)h=s(h,p.value,v),p=p.prev;return h},C.prototype.toArray=function(){for(var s=new Array(this.length),i=0,h=this.head;h!==null;i++)s[i]=h.value,h=h.next;return s},C.prototype.toArrayReverse=function(){for(var s=new Array(this.length),i=0,h=this.tail;h!==null;i++)s[i]=h.value,h=h.prev;return s},C.prototype.slice=function(s,i){(i=i||this.length)<0&&(i+=this.length),(s=s||0)<0&&(s+=this.length);var h=new C;if(i<s||i<0)return h;s<0&&(s=0),i>this.length&&(i=this.length);for(var p=0,v=this.head;v!==null&&p<s;p++)v=v.next;for(;v!==null&&p<i;p++,v=v.next)h.push(v.value);return h},C.prototype.sliceReverse=function(s,i){(i=i||this.length)<0&&(i+=this.length),(s=s||0)<0&&(s+=this.length);var h=new C;if(i<s||i<0)return h;s<0&&(s=0),i>this.length&&(i=this.length);for(var p=this.length,v=this.tail;v!==null&&p>i;p--)v=v.prev;for(;v!==null&&p>s;p--,v=v.prev)h.push(v.value);return h},C.prototype.splice=function(s,i,...h){s>this.length&&(s=this.length-1),s<0&&(s=this.length+s);for(var p=0,v=this.head;v!==null&&p<s;p++)v=v.next;var w=[];for(p=0;v&&p<i;p++)w.push(v.value),v=this.removeNode(v);for(v===null&&(v=this.tail),v!==this.head&&v!==this.tail&&(v=v.prev),p=0;p<h.length;p++)v=_(this,v,h[p]);return w},C.prototype.reverse=function(){for(var s=this.head,i=this.tail,h=s;h!==null;h=h.prev){var p=h.prev;h.prev=h.next,h.next=p}return this.head=i,this.tail=s,this};try{d(371)(C)}catch{}},109:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const C=d(98),_=d(104);let o;u.default=async function(l,s){var i,h;if(!o){if(typeof navigator<"u"&&"fonts"in navigator){try{const w=await((h=(i=navigator.permissions).request)===null||h===void 0?void 0:h.call(i,{name:"local-fonts"}));if(w&&w.state!=="granted")throw new Error("Permission to access local fonts not granted.")}catch(w){if(w.name!=="TypeError")throw w}const v={};try{const w=await navigator.fonts.query();for(const m of w)v.hasOwnProperty(m.family)||(v[m.family]=[]),v[m.family].push(m);o=Promise.resolve(v)}catch(w){console.error(w.name,w.message)}}else if(typeof process!="object"&&"queryLocalFonts"in window){const v={};try{const w=await window.queryLocalFonts();for(const m of w)v.hasOwnProperty(m.family)||(v[m.family]=[]),v[m.family].push(m);o=Promise.resolve(v)}catch(w){console.error(w.name,w.message)}}o||(o=Promise.resolve({}))}const p=await o;for(const v of(0,_.default)(l)){if(t.includes(v))return;if(p.hasOwnProperty(v)&&p[v].length>0){const w=p[v][0];if("blob"in w){const m=await w.blob(),b=await m.arrayBuffer();return(0,C.loadBuffer)(b,{cacheSize:s})}return}}};const t=["serif","sans-serif","cursive","fantasy","monospace","system-ui","emoji","math","fangsong"]},833:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.enableLigatures=void 0;const C=d(109);u.enableLigatures=function(_,o=[]){let t,l,s,i=0;return _.registerCharacterJoiner(h=>{const p=_.options.fontFamily;if(p&&(i===0||t!==p)){l=void 0,i=1,t=p;const v=t;(0,C.default)(v,1e5).then(w=>{v===_.options.fontFamily&&(i=2,l=w,w&&_.refresh(0,_.rows-1))}).catch(w=>{v===_.options.fontFamily&&(i=3,_.options.logLevel==="debug"&&console.debug(s,new Error("Failure while loading font")),l=void 0,s=w)})}return l&&i===2?l.findLigatureRanges(h).map(v=>[v[0],v[1]]):function(v,w){const m=[];for(let b=0;b<v.length;b++)for(let E=0;E<w.length;E++)if(v.startsWith(w[E],b)){m.push([b,b+w[E].length]),b+=w[E].length-1;break}return m}(h,o)})}},104:(f,u)=>{function d(t,l){let s="",i=!1;for(;t.offset<t.input.length;){const h=t.input[t.offset++];if(i)/[\dA-Fa-f]/.test(h)?(t.offset--,s+=_(t)):h!==`
`&&(s+=h),i=!1;else switch(h){case l:return s;case"\\":i=!0;break;default:s+=h}}throw new Error("Unterminated string")}function C(t){let l="",s=!1;for(;t.offset<t.input.length;){const i=t.input[t.offset++];if(s)/[\dA-Fa-f]/.test(i)?(t.offset--,l+=_(t)):l+=i,s=!1;else switch(i){case"\\":s=!0;break;case",":return l;default:/\s/.test(i)?l.endsWith(" ")||(l+=" "):l+=i}}return l}function _(t){let l="";for(;t.offset<t.input.length;){const s=t.input[t.offset++];if(/\s/.test(s))return o(l);if(l.length>=6||!/[\dA-Fa-f]/.test(s))return t.offset--,o(l);l+=s}return o(l)}function o(t){return String.fromCodePoint(parseInt(t,16))}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(t){if(typeof t!="string")throw new Error("Font family must be a string");const l={input:t,offset:0},s=[];let i="";for(;l.offset<l.input.length;){const h=l.input[l.offset++];switch(h){case"'":case'"':i+=d(l,h);break;case",":s.push(i),i="";break;default:/\s/.test(h)||(l.offset--,i+=C(l),s.push(i),i="")}}return s}},89:f=>{f.exports=J},56:f=>{f.exports=se},978:f=>{f.exports=_e},269:f=>{f.exports=ce},82:()=>{},456:()=>{}},c={};function y(f){var u=c[f];if(u!==void 0)return u.exports;var d=c[f]={exports:{}};return $[f].call(d.exports,d,d.exports,y),d.exports}y.n=f=>{var u=f&&f.__esModule?()=>f.default:()=>f;return y.d(u,{a:u}),u},y.d=(f,u)=>{for(var d in u)y.o(u,d)&&!y.o(f,d)&&Object.defineProperty(f,d,{enumerable:!0,get:u[d]})},y.o=(f,u)=>Object.prototype.hasOwnProperty.call(f,u),y.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})};var g={};return(()=>{var f=g;Object.defineProperty(f,"__esModule",{value:!0}),f.LigaturesAddon=void 0;const u=y(833);f.LigaturesAddon=class{constructor(d){this._fallbackLigatures=((d==null?void 0:d.fallbackLigatures)||["<--","<---","<<-","<-","->","->>","-->","--->","<==","<===","<<=","<=","=>","=>>","==>","===>",">=",">>=","<->","<-->","<--->","<---->","<=>","<==>","<===>","<====>","-------->","<~~","<~","~>","~~>","::",":::","==","!=","===","!==",":=",":-",":+","<*","<*>","*>","<|","<|>","|>","+:","-:","=:",":>","++","+++","<!--","<!---","<***>"]).sort((C,_)=>_.length-C.length)}activate(d){this._terminal=d,this._characterJoinerId=(0,u.enableLigatures)(d,this._fallbackLigatures)}dispose(){var d;this._characterJoinerId!==void 0&&((d=this._terminal)===null||d===void 0||d.deregisterCharacterJoiner(this._characterJoinerId),this._characterJoinerId=void 0)}}})(),g})()})})(br,br.exports);var Bn=br.exports,ns={exports:{}};(function(V,U){(function(J,se){V.exports=se()})(self,function(){return(()=>{var J={345:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=y=>(this._listeners.push(y),{dispose:()=>{if(!this._disposed){for(let g=0;g<this._listeners.length;g++)if(this._listeners[g]===y)return void this._listeners.splice(g,1)}}})),this._event}fire(y,g){const f=[];for(let u=0;u<this._listeners.length;u++)f.push(this._listeners[u]);for(let u=0;u<f.length;u++)f[u].call(void 0,y,g)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(y,g){return y(f=>g.fire(f))}}},se={};function ce($){var c=se[$];if(c!==void 0)return c.exports;var y=se[$]={exports:{}};return J[$](y,y.exports,ce),y.exports}var _e={};return(()=>{var $=_e;Object.defineProperty($,"__esModule",{value:!0}),$.SearchAddon=void 0;const c=ce(345),y=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";$.SearchAddon=class{constructor(){this._linesCacheTimeoutId=0,this._onDidChangeResults=new c.EventEmitter,this.onDidChangeResults=this._onDidChangeResults.event}activate(g){this._terminal=g,this._onDataDisposable=this._terminal.onWriteParsed(()=>this._updateMatches()),this._onResizeDisposable=this._terminal.onResize(()=>this._updateMatches())}_updateMatches(){var g;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((g=this._lastSearchOptions)===null||g===void 0)&&g.decorations)&&(this._highlightTimeout=setTimeout(()=>{var f,u;this.findPrevious(this._cachedSearchTerm,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0})),this._resultIndex=this._searchResults?this._searchResults.size-1:-1,this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:(u=(f=this._searchResults)===null||f===void 0?void 0:f.size)!==null&&u!==void 0?u:-1})},200))}dispose(){var g,f;this.clearDecorations(),(g=this._onDataDisposable)===null||g===void 0||g.dispose(),(f=this._onResizeDisposable)===null||f===void 0||f.dispose()}clearDecorations(g){var f,u,d,C;(f=this._selectedDecoration)===null||f===void 0||f.dispose(),(u=this._searchResults)===null||u===void 0||u.clear(),(d=this._resultDecorations)===null||d===void 0||d.forEach(_=>{for(const o of _)o.dispose()}),(C=this._resultDecorations)===null||C===void 0||C.clear(),this._searchResults=void 0,this._resultDecorations=void 0,g||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var g;(g=this._selectedDecoration)===null||g===void 0||g.dispose(),this._selectedDecoration=void 0}findNext(g,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&g===this._cachedSearchTerm||this._highlightAllMatches(g,f)),this._fireResults(g,this._findNextAndSelect(g,f),f)}_highlightAllMatches(g,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!g||g.length===0)return void this.clearDecorations();f=f||{},this.clearDecorations(!0),this._searchResults=new Map,this._resultDecorations=new Map;const u=this._resultDecorations;let d=this._find(g,0,0,f);for(;d&&!this._searchResults.get(`${d.row}-${d.col}`);)if(this._searchResults.set(`${d.row}-${d.col}`,d),d=this._find(g,d.col+d.term.length>=this._terminal.cols?d.row+1:d.row,d.col+d.term.length>=this._terminal.cols?0:d.col+1,f),this._searchResults.size>1e3)return this.clearDecorations(),void(this._resultIndex=void 0);this._searchResults.forEach(C=>{const _=this._createResultDecoration(C,f.decorations);if(_){const o=u.get(_.marker.line)||[];o.push(_),u.set(_.marker.line,o)}})}_find(g,f,u,d){var C;if(!this._terminal||!g||g.length===0)return(C=this._terminal)===null||C===void 0||C.clearSelection(),void this.clearDecorations();if(u>this._terminal.cols)throw new Error(`Invalid col: ${u} to search in terminal of ${this._terminal.cols} cols`);let _;this._initLinesCache();const o={startRow:f,startCol:u};if(_=this._findInLine(g,o,d),!_)for(let t=f+1;t<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=t,o.startCol=0,_=this._findInLine(g,o,d),!_);t++);return _}_findNextAndSelect(g,f){var u;if(!this._terminal||!g||g.length===0)return(u=this._terminal)===null||u===void 0||u.clearSelection(),this.clearDecorations(),this._cachedSearchTerm=void 0,this._resultIndex=-1,!1;this._cachedSearchTerm!==g&&(this._resultIndex=void 0,this._terminal.clearSelection());let d,C=0,_=0;if(this._terminal.hasSelection()){const l=!!f&&f.incremental;d=this._terminal.getSelectionPosition(),_=l?d.start.y:d.end.y,C=l?d.start.x:d.end.x}this._initLinesCache();const o={startRow:_,startCol:C};let t=this._findInLine(g,o,f);if(!t)for(let l=_+1;l<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=l,o.startCol=0,t=this._findInLine(g,o,f),!t);l++);if(!t&&_!==0)for(let l=0;l<_&&(o.startRow=l,o.startCol=0,t=this._findInLine(g,o,f),!t);l++);return!t&&d&&(o.startRow=d.start.y,o.startCol=0,t=this._findInLine(g,o,f)),this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0?this._resultIndex=0:(this._resultIndex++,this._resultIndex>=this._searchResults.size&&(this._resultIndex=0))),this._selectResult(t,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}findPrevious(g,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&g===this._cachedSearchTerm||this._highlightAllMatches(g,f)),this._fireResults(g,this._findPreviousAndSelect(g,f),f)}_fireResults(g,f,u){var d;return u!=null&&u.decorations&&(this._resultIndex!==void 0&&((d=this._searchResults)===null||d===void 0?void 0:d.size)!==void 0?this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:this._searchResults.size}):this._onDidChangeResults.fire(void 0)),this._cachedSearchTerm=g,f}_findPreviousAndSelect(g,f){var u;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let d;if(!this._terminal||!g||g.length===0)return d=void 0,(u=this._terminal)===null||u===void 0||u.clearSelection(),this.clearDecorations(),this._resultIndex=-1,!1;this._cachedSearchTerm!==g&&(this._resultIndex=void 0,this._terminal.clearSelection());let C=this._terminal.buffer.active.baseY+this._terminal.rows,_=this._terminal.cols;const o=!0,t=!!f&&f.incremental;let l;this._terminal.hasSelection()&&(l=this._terminal.getSelectionPosition(),C=l.start.y,_=l.start.x),this._initLinesCache();const s={startRow:C,startCol:_};if(t?(d=this._findInLine(g,s,f,!1),d&&d.row===C&&d.col===_||(l&&(s.startRow=l.end.y,s.startCol=l.end.x),d=this._findInLine(g,s,f,!0))):d=this._findInLine(g,s,f,o),!d){s.startCol=Math.max(s.startCol,this._terminal.cols);for(let i=C-1;i>=0&&(s.startRow=i,d=this._findInLine(g,s,f,o),!d);i--);}if(!d&&C!==this._terminal.buffer.active.baseY+this._terminal.rows)for(let i=this._terminal.buffer.active.baseY+this._terminal.rows;i>=C&&(s.startRow=i,d=this._findInLine(g,s,f,o),!d);i--);return this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0||this._resultIndex<0?this._resultIndex=this._searchResults.size-1:(this._resultIndex--,this._resultIndex===-1&&(this._resultIndex=this._searchResults.size-1))),!(d||!l)||this._selectResult(d,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}_initLinesCache(){const g=this._terminal;this._linesCache||(this._linesCache=new Array(g.buffer.active.length),this._cursorMoveListener=g.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=g.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(g,f,u){return(g===0||y.includes(f[g-1]))&&(g+u.length===f.length||y.includes(f[g+u.length]))}_findInLine(g,f,u={},d=!1){var C;const _=this._terminal,o=f.startRow,t=f.startCol,l=_.buffer.active.getLine(o);if(l!=null&&l.isWrapped)return d?void(f.startCol+=_.cols):(f.startRow--,f.startCol+=_.cols,this._findInLine(g,f,u));let s=(C=this._linesCache)===null||C===void 0?void 0:C[o];s||(s=this._translateBufferLineToStringWithWrap(o,!0),this._linesCache&&(this._linesCache[o]=s));const[i,h]=s,p=this._bufferColsToStringOffset(o,t),v=u.caseSensitive?g:g.toLowerCase(),w=u.caseSensitive?i:i.toLowerCase();let m=-1;if(u.regex){const b=RegExp(v,"g");let E;if(d)for(;E=b.exec(w.slice(0,p));)m=b.lastIndex-E[0].length,g=E[0],b.lastIndex-=g.length-1;else E=b.exec(w.slice(p)),E&&E[0].length>0&&(m=p+(b.lastIndex-E[0].length),g=E[0])}else d?p-v.length>=0&&(m=w.lastIndexOf(v,p-v.length)):m=w.indexOf(v,p);if(m>=0){if(u.wholeWord&&!this._isWholeWord(m,w,g))return;let b=0;for(;b<h.length-1&&m>=h[b+1];)b++;let E=b;for(;E<h.length-1&&m+g.length>=h[E+1];)E++;const A=m-h[b],T=m+g.length-h[E],B=this._stringLengthToBufferSize(o+b,A);return{term:g,col:B,row:o+b,size:this._stringLengthToBufferSize(o+E,T)-B+_.cols*(E-b)}}}_stringLengthToBufferSize(g,f){const u=this._terminal.buffer.active.getLine(g);if(!u)return 0;for(let d=0;d<f;d++){const C=u.getCell(d);if(!C)break;const _=C.getChars();_.length>1&&(f-=_.length-1);const o=u.getCell(d+1);o&&o.getWidth()===0&&f++}return f}_bufferColsToStringOffset(g,f){const u=this._terminal;let d=g,C=0,_=u.buffer.active.getLine(d);for(;f>0&&_;){for(let o=0;o<f&&o<u.cols;o++){const t=_.getCell(o);if(!t)break;t.getWidth()&&(C+=t.getCode()===0?1:t.getChars().length)}if(d++,_=u.buffer.active.getLine(d),_&&!_.isWrapped)break;f-=u.cols}return C}_translateBufferLineToStringWithWrap(g,f){var u;const d=this._terminal,C=[],_=[0];let o=d.buffer.active.getLine(g);for(;o;){const t=d.buffer.active.getLine(g+1),l=!!t&&t.isWrapped;let s=o.translateToString(!l&&f);if(l&&t){const i=o.getCell(o.length-1);i&&i.getCode()===0&&i.getWidth()===1&&((u=t.getCell(0))===null||u===void 0?void 0:u.getWidth())===2&&(s=s.slice(0,-1))}if(C.push(s),!l)break;_.push(_[_.length-1]+s.length),g++,o=t}return[C.join(""),_]}_selectResult(g,f,u){var d,C;const _=this._terminal;if(this.clearActiveDecoration(),!g)return _.clearSelection(),!1;if(_.select(g.col,g.row,g.size),f){const o=_.registerMarker(-_.buffer.active.baseY-_.buffer.active.cursorY+g.row);o&&(this._selectedDecoration=_.registerDecoration({marker:o,x:g.col,width:g.size,backgroundColor:f.activeMatchBackground,layer:"top",overviewRulerOptions:{color:f.activeMatchColorOverviewRuler}}),(d=this._selectedDecoration)===null||d===void 0||d.onRender(t=>this._applyStyles(t,f.activeMatchBorder,!0)),(C=this._selectedDecoration)===null||C===void 0||C.onDispose(()=>o.dispose()))}if(!u&&(g.row>=_.buffer.active.viewportY+_.rows||g.row<_.buffer.active.viewportY)){let o=g.row-_.buffer.active.viewportY;o-=Math.floor(_.rows/2),_.scrollLines(o)}return!0}_applyStyles(g,f,u){g.clientWidth<=0||(g.classList.contains("xterm-find-result-decoration")||(g.classList.add("xterm-find-result-decoration"),f&&(g.style.outline=`1px solid ${f}`)),u&&g.classList.add("xterm-find-active-result-decoration"))}_createResultDecoration(g,f){var u;const d=this._terminal,C=d.registerMarker(-d.buffer.active.baseY-d.buffer.active.cursorY+g.row);if(!C)return;const _=d.registerDecoration({marker:C,x:g.col,width:g.size,backgroundColor:f.matchBackground,overviewRulerOptions:!((u=this._resultDecorations)===null||u===void 0)&&u.get(C.line)?void 0:{color:f.matchOverviewRuler,position:"center"}});return _==null||_.onRender(o=>this._applyStyles(o,f.matchBorder,!1)),_==null||_.onDispose(()=>C.dispose()),_}}})(),_e})()})})(ns);var On=ns.exports,os={exports:{}};(function(V,U){(function(J,se){V.exports=se()})(self,function(){return(()=>{var J={6:($,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkComputer=c.WebLinkProvider=void 0,c.WebLinkProvider=class{constructor(g,f,u,d={}){this._terminal=g,this._regex=f,this._handler=u,this._options=d}provideLinks(g,f){const u=y.computeLink(g,this._regex,this._terminal,this._handler);f(this._addCallbacks(u))}_addCallbacks(g){return g.map(f=>(f.leave=this._options.leave,f.hover=(u,d)=>{if(this._options.hover){const{range:C}=f;this._options.hover(u,d,C)}},f))}};class y{static computeLink(f,u,d,C){const _=new RegExp(u.source,(u.flags||"")+"g"),[o,t]=y._translateBufferLineToStringWithWrap(f-1,!1,d);let l,s=-1;const i=[];for(;(l=_.exec(o))!==null;){const h=l[1];if(!h){console.log("match found without corresponding matchIndex");break}if(s=o.indexOf(h,s+1),_.lastIndex=s+h.length,s<0)break;let p=s+h.length,v=t+1;for(;p>d.cols;)p-=d.cols,v++;let w=s+1,m=t+1;for(;w>d.cols;)w-=d.cols,m++;const b={start:{x:w,y:m},end:{x:p,y:v}};i.push({range:b,text:h,activate:C})}return i}static _translateBufferLineToStringWithWrap(f,u,d){let C,_,o="";do{const l=d.buffer.active.getLine(f);if(!l)break;l.isWrapped&&f--,_=l.isWrapped}while(_);const t=f;do{const l=d.buffer.active.getLine(f+1);C=!!l&&l.isWrapped;const s=d.buffer.active.getLine(f);if(!s)break;o+=s.translateToString(!C&&u).substring(0,d.cols),f++}while(C);return[o,t]}}c.LinkComputer=y}},se={};function ce($){var c=se[$];if(c!==void 0)return c.exports;var y=se[$]={exports:{}};return J[$](y,y.exports,ce),y.exports}var _e={};return(()=>{var $=_e;Object.defineProperty($,"__esModule",{value:!0}),$.WebLinksAddon=void 0;const c=ce(6),y=new RegExp(`(?:^|[^\\da-z\\.-]+)((https?:\\/\\/)((([\\da-z\\.-]+)\\.([a-z\\.]{2,18}))|((\\d{1,3}\\.){3}\\d{1,3})|(localhost))(:\\d{1,5})?((\\/[\\/\\w\\.\\-%~:+@]*)*([^:"'\\s]))?(\\?[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?(#[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?)($|[^\\/\\w\\.\\-%]+)`);function g(f,u){const d=window.open();if(d){try{d.opener=null}catch{}d.location.href=u}else console.warn("Opening link blocked as opener could not be cleared")}$.WebLinksAddon=class{constructor(f=g,u={}){this._handler=f,this._options=u}activate(f){this._terminal=f;const u=this._options,d=u.urlRegex||y;this._linkProvider=this._terminal.registerLinkProvider(new c.WebLinkProvider(this._terminal,d,this._handler,u))}dispose(){var f;(f=this._linkProvider)===null||f===void 0||f.dispose()}}})(),_e})()})})(os);var In=os.exports;const Pn={foreground:"#eeeeec",background:"#300a24",cursor:"#bbbbbb",black:"#2e3436",brightBlack:"#555753",red:"#cc0000",brightRed:"#ef2929",green:"#4e9a06",brightGreen:"#8ae234",yellow:"#c4a000",brightYellow:"#fce94f",blue:"#3465a4",brightBlue:"#729fcf",magenta:"#75507b",brightMagenta:"#ad7fa8",cyan:"#06989a",brightCyan:"#34e2e2",white:"#d3d7cf",brightWhite:"#eeeeec"},Un={foreground:"#F8F8F2",background:"#282A36",cursor:"#bbbbbb",selectionBackground:"#44475A",black:"#21222C",brightBlack:"#6272A4",red:"#FF5555",brightRed:"#FF6E6E",green:"#50FA7B",brightGreen:"#69FF94",yellow:"#F1FA8C",brightYellow:"#FFFFA5",blue:"#BD93F9",brightBlue:"#D6ACFF",magenta:"#FF79C6",brightMagenta:"#FF92DF",cyan:"#8BE9FD",brightCyan:"#A4FFFF",white:"#F8F8F2",brightWhite:"#FFFFFF"},Fn={foreground:"#abb2bf",background:"#282c34",cursor:"#bbbbbb",selectionBackground:"#abb2bf30",black:"#3f4451",brightBlack:"#4f5666",red:"#e05561",brightRed:"#ff616e",green:"#8cc265",brightGreen:"#a5e075",yellow:"#d18f52",brightYellow:"#f0a45d",blue:"#4aa5f0",brightBlue:"#4dc4ff",magenta:"#c162de",brightMagenta:"#de73ff",cyan:"#42b3c2",brightCyan:"#4cd1e0",white:"#d7dae0",brightWhite:"#e6e6e6"},Hn={foreground:"#C5C8C6",background:"#161719",cursor:"#D0D0D0",black:"#000000",brightBlack:"#000000",red:"#FD5FF1",brightRed:"#FD5FF1",green:"#87C38A",brightGreen:"#94FA36",yellow:"#FFD7B1",brightYellow:"#F5FFA8",blue:"#85BEFD",brightBlue:"#96CBFE",magenta:"#B9B6FC",brightMagenta:"#B9B6FC",cyan:"#85BEFD",brightCyan:"#85BEFD",white:"#E0E0E0",brightWhite:"#E0E0E0"},mr=V=>{switch(V){case"Ubuntu":return Pn;case"Dracula":return Un;case"Arthur":return Hn;case"OneDark":return Fn;case"Default":return}const U=document.documentElement.style;function J(se){return U.getPropertyValue(se)}return{cursor:J("--vscode-editorCursor-foreground"),foreground:J("--vscode-terminal-foreground"),background:J("--vscode-editor-background"),black:J("--vscode-terminal-ansiBlack"),brightBlack:J("--vscode-terminal-ansiBrightBlack"),blue:J("--vscode-terminal-ansiBlue"),brightBlue:J("--vscode-terminal-ansBrightiBlue"),green:J("--vscode-terminal-ansiGreen"),brightGreen:J("--vscode-terminal-ansiBrightGreen"),red:J("--vscode-terminal-ansiRed"),brightRed:J("--vscode-terminal-ansiBrightRed"),cyan:J("--vscode-terminal-ansiCyan"),brightCyan:J("--vscode-terminal-ansiBrightCyan"),magenta:J("--vscode-terminal-ansiMagenta"),brightMagenta:J("--vscode-terminal-ansiBrightMagenta"),yellow:J("--vscode-terminal-ansiYellow"),brightYellow:J("--vscode-terminal-ansiBrightYellow"),white:J("--vscode-terminal-ansiWhite"),brightWhite:J("--vscode-terminal-ansiBrightWhite"),selectionBackground:J("--vscode-editor-selectionBackground")}};/*!
 * xterm-addon-search-bar.js v0.2.0
 * (c) 2018-2020 yinshuxun
 * Released under the MIT License.
 */function Nn(V,U){U===void 0&&(U={});var J=U.insertAt;if(!(!V||typeof document>"u")){var se=document.head||document.getElementsByTagName("head")[0],ce=document.createElement("style");ce.type="text/css",J==="top"&&se.firstChild?se.insertBefore(ce,se.firstChild):se.appendChild(ce),ce.styleSheet?ce.styleSheet.cssText=V:ce.appendChild(document.createTextNode(V))}}var Wn='.xterm-search-bar__addon{position:absolute;max-width:1467px;top:0;right:28px;color:#000;background:#fff;padding:5px 10px;box-shadow:0 2px 8px #000;background-color:#252526;z-index:999;display:flex}.xterm-search-bar__addon .search-bar__input{background-color:#3c3c3c;color:#ccc;border:0;padding:2px;height:20px;width:227px}.xterm-search-bar__addon .search-bar__btn{min-width:20px;width:20px;height:20px;display:flex;display:-webkit-flex;flex:initial;background-position:50%;margin-left:3px;background-repeat:no-repeat;background-color:#252526;border:0;cursor:pointer}.xterm-search-bar__addon .search-bar__btn:hover{background-color:#666}.xterm-search-bar__addon .search-bar__btn.prev{margin-left:20px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTUuNCA4YS42LjYgMCAwMS4xNzYtLjQyNGw0LTRhLjU5OC41OTggMCAwMS44NDggMCAuNTk4LjU5OCAwIDAxMCAuODQ4TDYuODQ5IDhsMy41NzUgMy41NzZhLjU5OC41OTggMCAwMTAgLjg0OC41OTguNTk4IDAgMDEtLjg0OCAwbC00LTRBLjYuNiAwIDAxNS40IDgiLz48L3N2Zz4=")}.xterm-search-bar__addon .search-bar__btn.next{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTEwLjYgOGEuNi42IDAgMDEtLjE3Ni40MjRsLTQgNGEuNTk4LjU5OCAwIDAxLS44NDggMCAuNTk4LjU5OCAwIDAxMC0uODQ4TDkuMTUxIDggNS41NzYgNC40MjRhLjU5OC41OTggMCAwMTAtLjg0OC41OTguNTk4IDAgMDEuODQ4IDBsNCA0QS42LjYgMCAwMTEwLjYgOCIvPjwvc3ZnPg==")}.xterm-search-bar__addon .search-bar__btn.close{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTcgNmwyLTJhLjcxMS43MTEgMCAwMDAtMSAuNzExLjcxMSAwIDAwLTEgMEw2IDUgNCAzYS43MTEuNzExIDAgMDAtMSAwIC43MTEuNzExIDAgMDAwIDFsMiAyLTIgMmEuNzExLjcxMSAwIDAwMCAxIC43MTEuNzExIDAgMDAxIDBsMi0yIDIgMmEuNzExLjcxMSAwIDAwMSAwIC43MTEuNzExIDAgMDAwLTFMNyA2eiIvPjwvc3ZnPg==")}';Nn(Wn);const yr="xterm-search-bar__addon";class Gn{constructor(U){this.options=U||{},this.options&&this.options.searchAddon&&(this.searchAddon=this.options.searchAddon)}activate(U){this.terminal=U,this.searchAddon||console.error("Cannot use search bar addon until search addon has been loaded!")}dispose(){this.hidden()}show(){if(!this.terminal||!this.terminal.element)return;if(this.searchBarElement){this.searchBarElement.style.visibility="visible",this.searchBarElement.querySelector("input").select();return}this.terminal.element.style.position="relative";const U=document.createElement("div");U.innerHTML=`
       <input type="text" class="search-bar__input" name="search-bar__input"/>
       <button class="search-bar__btn prev"></button>
       <button class="search-bar__btn next"></button>
       <button class="search-bar__btn close"></button>
    `,U.className=yr;const J=this.terminal.element.parentElement;this.searchBarElement=U,["relative","absoulte","fixed"].includes(J.style.position)||(J.style.position="relative"),J.appendChild(this.searchBarElement),this.on(".search-bar__btn.close","click",()=>{this.hidden()}),this.on(".search-bar__btn.next","click",()=>{this.searchAddon.findNext(this.searchKey,{incremental:!1})}),this.on(".search-bar__btn.prev","click",()=>{this.searchAddon.findPrevious(this.searchKey,{incremental:!1})}),this.on(".search-bar__input","keyup",se=>{this.searchKey=se.target.value,this.searchAddon.findNext(this.searchKey,{incremental:se.key!=="Enter"})}),this.searchBarElement.querySelector("input").select()}hidden(){this.searchBarElement&&this.terminal.element.parentElement&&(this.searchBarElement.style.visibility="hidden")}on(U,J,se){const ce=this.terminal.element.parentElement;ce.addEventListener(J,_e=>{let $=_e.target;for(;$!==document.querySelector(U);){if($===ce){$=null;break}$=$.parentElement}$===document.querySelector(U)&&(se.call(this,_e),_e.stopPropagation())})}addNewStyle(U){let J=document.getElementById(yr);J||(J=document.createElement("style"),J.type="text/css",J.id=yr,document.getElementsByTagName("head")[0].appendChild(J)),J.appendChild(document.createTextNode(U))}}const zn={props:["theme"],data(){return{themeList:["Auto","Arthur","Dracula","OneDark","Ubuntu","Default"]}},methods:{send(V){this.$emit("send",V)},showProgres(){let V="echo Top Memory Progress: && ps -eo pid,user,rss,pmem,pcpu,cputime,comm,cmd | ";V+=`awk 'NR<2{print $0;next}{print $0| "sort -k 3 -nr"}' | head -16 | `,V+="numfmt --header --to=iec --from-unit=1024 --field 3 | cut -c 1-130",this.send(V)},changeTheme(V){this.$emit("update:theme",V)}}};var jn=function(){var U=this,J=U._self._c;return J("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-[25px] flex items-center"},[J("div",{staticClass:"terminal-toolbar-selection"},[U._v(" Vim: "),J("i",{staticClass:"el-icon-edit",attrs:{title:"Edit Profile"},on:{click:function(se){return U.send("vi /etc/profile")}}}),J("i",{staticClass:"el-icon-wind-power",attrs:{title:"Show Line Number"},on:{click:function(se){return U.send(":set nu")}}}),J("i",{staticClass:"el-icon-set-up",attrs:{title:"Format"},on:{click:function(se){return U.send("gg=G")}}}),J("i",{staticClass:"el-icon-check",attrs:{title:"Save"},on:{click:function(se){return U.send(":wq")}}}),J("i",{staticClass:"el-icon-close",attrs:{title:"Close"},on:{click:function(se){return U.send(":q!")}}})]),J("div",{staticClass:"terminal-toolbar-selection"},[U._v(" "+U._s(U.$t("ssh.util"))+": "),J("i",{staticClass:"el-icon-coin",attrs:{title:"Disk Usage"},on:{click:function(se){return U.send("du -h -d 1| sort -h")}}}),J("i",{staticClass:"el-icon-stopwatch",attrs:{title:"Listening Port"},on:{click:function(se){return U.send("netstat -anp|grep 'LISTEN\\b'|less")}}}),J("i",{staticClass:"el-icon-data-line",attrs:{title:"List Progress"},on:{click:U.showProgres}}),J("i",{staticClass:"el-icon-document-delete",attrs:{title:"Clear Screen"},on:{click:function(se){return U.send("clear")}}})]),J("div",{staticClass:"terminal-toolbar-selection"},[U._v(" "+U._s(U.$t("ssh.theme"))+": "),J("vsc-radio-group",{staticClass:"inline-block",attrs:{value:U.theme,size:"mini"},on:{input:U.changeTheme}},U._l(U.themeList,function(se,ce){return J("vsc-radio-button",{key:ce,attrs:{label:se}})}),1)],1)])},$n=[],qn=Sr(zn,jn,$n,!1,null,"e66ea9de",null,null);const Vn=qn.exports;const Kn={mixins:[Ki],data(){return{live:!0,lastTime:null,receivedData:!1,option:{query:null,previousMinute:30}}},mounted(){this.on("query",V=>{this.option.query||(this.option.query=V)}).on("lastTime",({lastTime:V,hasLog:U})=>{this.lastTime||setInterval(()=>{!this.live||!this.receivedData||(this.receivedData=!1,this.emit("getLogs",{live:!0,start:this.lastTime,hasLog:U,query:this.option.query}))},3e3),(!this.lastTime||U)&&(this.lastTime=V),this.receivedData=!0})},methods:{loadLogs(){this.emit("getLogs",this.option)},openDocument(){this.emit("openDocument")}}};var Xn=function(){var U=this,J=U._self._c;return J("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-10 flex items-center"},[J("vsc-input",{staticClass:"ml-1",staticStyle:{width:"300px"},attrs:{theme:"base","prefix-icon":"el-icon-search",size:"mini",placeholder:"Loki queries",clearable:!1},nativeOn:{keyup:function(se){return!se.type.indexOf("key")&&U._k(se.keyCode,"enter",13,se.key,"Enter")?null:U.loadLogs.apply(null,arguments)}},model:{value:U.option.query,callback:function(se){U.$set(U.option,"query",se)},expression:"option.query"}}),J("i",{staticClass:"el-icon-document",attrs:{title:"Document"},on:{click:U.openDocument}}),J(hn,{staticStyle:{width:"130px"},attrs:{placeholder:"Forever",size:"small"},on:{change:U.loadLogs},model:{value:U.option.previousMinute,callback:function(se){U.$set(U.option,"previousMinute",se)},expression:"option.previousMinute"}},[J(dt,{attrs:{value:15,label:"Last 15 minutes"}}),J(dt,{attrs:{value:30,label:"Last 30 minutes"}}),J(dt,{attrs:{value:60,label:"Last 1 hours"}}),J(dt,{attrs:{value:120,label:"Last 2 hours"}}),J(dt,{attrs:{value:180,label:"Last 3 hours"}}),J(dt,{attrs:{value:1440,label:"Last 24 hours"}}),J(dt,{attrs:{value:2880,label:"Last 2 days"}}),J(dt,{attrs:{value:10080,label:"Last 7 days"}})],1),J("div",{staticClass:"inline-block ml-[-8px] mr-2"},[J("label",{staticClass:"mr-2"},[U._v("Live")]),J(cn,{model:{value:U.live,callback:function(se){U.live=se},expression:"live"}})],1),J("i",{staticClass:"el-icon-refresh-left icon",staticStyle:{"margin-left":"-10px"},attrs:{title:"Refresh"},on:{click:U.loadLogs}})],1)},Yn=[],Zn=Sr(Kn,Xn,Yn,!1,null,"7afb1dba",null,null);const Jn=Zn.exports;const Qn={components:{SSHToolbar:Vn,LokiToolbar:Jn},mixins:[Ki],data(){return{theme:"vscode",dbType:null,terminal:null,isSSH:!1,remainHeight:756,listenThemeChange:!0}},watch:{theme(V){this.terminal.options.theme=mr(V),this.emit("updateOption",{key:"terminalTheme",value:V})}},mounted(){this.calcHeight(),this.on("terminalConfig",({cursorStyle:V,fontSize:U,fontFamily:J,theme:se,dbType:ce})=>{this.dbType=ce;let _e=!1;se&&(this.theme=se),(!V||V=="line")&&(V="bar");const $=new dn.Terminal({theme:mr(this.theme),cursorStyle:V,cursorBlink:!0,allowProposedApi:!0,fontSize:U,fontFamily:J,disableStdin:!1,lineHeight:1.1,cursorBlink:!0,scrollback:1e6,tabStopWidth:8,bellStyle:"sound"});this.terminal=$;const c=new pn.FitAddon;new ResizeObserver(()=>this.calcHeight(c)).observe(this.$refs.box);const y=new On.SearchAddon,g=new Gn({searchAddon:y});$.attachCustomKeyEventHandler(_=>{if(_.code=="Escape"&&g.hidden(),_.shiftKey&&_.code=="Insert")return!1;if(It(_)&&!_.altKey&&!_.shiftKey){const l=_.code;if(l=="KeyC"&&$.hasSelection())return document.execCommand("copy"),!1;if(l=="KeyV")return!1;if(l=="KeyF")return g.show(),!1;if(["PageDown","PageUp"].includes(l))return!1}else if(It(_)&&_.shiftKey&&_.code=="KeyV")return!1;const t=new _.constructor(_.type,_);return document.body.dispatchEvent(t),!0}),ce=="SSH"&&(this.isSSH=!0,window.addEventListener("keyup",_=>{It(_)&&_.shiftKey&&_.code=="KeyV"&&this.emit("data",[22])}));const f=document.getElementById("terminal-container");$.open(f),$.loadAddon(c),$.loadAddon(y),$.loadAddon(g),$.loadAddon(new fn.CanvasAddon),$.loadAddon(new Bn.LigaturesAddon);let u;$.loadAddon(new In.WebLinksAddon((_,o)=>{if(!It(_)){const t=u;if(u=new Date().getTime(),!t||u-t>200)return}this.emit("openLink",o)})),c.fit(),$.focus(),$.onData(_=>{this.emit("data",_)});const d=()=>{this.calcHeight(),this.$nextTick(()=>{c.fit(),this.emit("resize",{cols:$.cols,rows:$.rows})})};window.addEventListener("resize",d,!1),window.onfocus=()=>{$.focus()},document.querySelector("#terminal-container").oncontextmenu=async _=>{if(_.stopPropagation(),$.hasSelection())document.execCommand("copy"),$.clearSelection();else{const o=await navigator.clipboard.readText();this.emit("data",o.replace(/\r\n/g,"\r"))}};let C=!1;this.on("connecting",_=>{$.write(_),$.write("\x1B[2K\r")}).on("data",_=>{C||($.clear(),C=!0),$.write(_)}).on("init-terminal",_=>{d()}).on("error",_=>{_e||(_e=!0,$.write(_))}).on("theme",()=>{this.theme=="Auto"&&($.options.theme=mr(this.theme))}),this.emit("initTerminal",{cols:$.cols,rows:$.rows})}).init()},methods:{calcHeight(V){let U=8;this.isSSH&&(U+=20),this.dbType==un.LOKI&&(U+=35),this.remainHeight=window.innerHeight-U,V&&this.$nextTick(()=>{V.fit()})},send(V){this.emit("data",""),setTimeout(()=>{var U;this.emit("data",`${V}
\r`),(U=this.terminal)==null||U.focus()},200)}}};var eo=function(){var U=this,J=U._self._c;return J("div",{ref:"box",staticClass:"box"},[U.isSSH?J("SSHToolbar",{attrs:{theme:U.theme},on:{"update:theme":function(se){U.theme=se},send:U.send}}):U._e(),U.dbType=="Loki"?J("LokiToolbar",{on:{send:U.send}}):U._e(),J("div",{style:{height:U.remainHeight+"px"},attrs:{id:"terminal-container"}})],1)},to=[],ro=Sr(Qn,eo,to,!1,null,"4025024d",null,null);const co=ro.exports;export{co as default};
